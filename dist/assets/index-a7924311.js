import{r as S,a as sl,R as Gn}from"./vendor-27d6d7f2.js";import{A as le,m as k,X as nt,C as me,a as Ce,I as Os,b as rl,P as al,L as nl,B as il,c as rr,S as Wn,T as oe,d as jt,e as de,f as at,g as Ee,D as Jn,M as ol,h as ll,i as cl,H as dl,U as As,j as Vt,k as be,l as Pe,n as fs,o as kr,p as ul,q as _r,r as Lt,G as ml,s as hl,t as gl,u as Oe,v as Kn,w as Yn,x as pl,y as Xn,z as fl,E as xs,Z as De,F as xl,J as yl,K as ze,N as bl,O as qt,Q as Qn,R as Kr,V as Yr,W as wl,Y as vt,_ as ar,$ as Zn,a0 as vl,a1 as ei,a2 as za,a3 as Nl,a4 as jl,a5 as kl,a6 as ti,a7 as _l,a8 as Sl,a9 as Cl,aa as Al,ab as El,ac as Rl,ad as Tl,ae as Ml,af as Va,ag as Il}from"./ui-3997809a.js";import{c as Pl,R as Ut,P as Ol,a as Dl,C as Fl,T as Ve,L as It,B as si,b as Ze,X as et,Y as tt,d as Sr,A as Xr,e as ft,f as Cr,g as ns}from"./charts-22416d0f.js";import{o as Bl,r as $l,a as Ll,b as ri,s as ht,n as nr,e as Ar,c as qa,u as ai,d as Ul}from"./forms-d3f0bc44.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(n){if(n.ep)return;n.ep=!0;const i=t(n);fetch(n.href,i)}})();var ni={exports:{}},Ds={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hl=S,zl=Symbol.for("react.element"),Vl=Symbol.for("react.fragment"),ql=Object.prototype.hasOwnProperty,Gl=Hl.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Wl={key:!0,ref:!0,__self:!0,__source:!0};function ii(a,e,t){var r,n={},i=null,o=null;t!==void 0&&(i=""+t),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)ql.call(e,r)&&!Wl.hasOwnProperty(r)&&(n[r]=e[r]);if(a&&a.defaultProps)for(r in e=a.defaultProps,e)n[r]===void 0&&(n[r]=e[r]);return{$$typeof:zl,type:a,key:i,ref:o,props:n,_owner:Gl.current}}Ds.Fragment=Vl;Ds.jsx=ii;Ds.jsxs=ii;ni.exports=Ds;var s=ni.exports,Er={},Ga=sl;Er.createRoot=Ga.createRoot,Er.hydrateRoot=Ga.hydrateRoot;const oi=S.createContext(void 0);function Jl({children:a}){const[e,t]=S.useState(()=>{const n=localStorage.getItem("molecular-nutrition-theme");return n||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")});S.useEffect(()=>{const n=window.document.documentElement;n.classList.remove("light","dark"),n.classList.add(e),localStorage.setItem("molecular-nutrition-theme",e)},[e]);const r=()=>{t(n=>n==="light"?"dark":"light")};return s.jsx(oi.Provider,{value:{theme:e,toggleTheme:r},children:a})}function Kl(){const a=S.useContext(oi);if(a===void 0)throw new Error("useTheme must be used within a ThemeProvider");return a}const Yl={success:me,error:Ce,info:Os,warning:Ce},Xl={success:"bg-green-50 border-green-200 text-green-800 dark:bg-green-900 dark:border-green-700 dark:text-green-200",error:"bg-red-50 border-red-200 text-red-800 dark:bg-red-900 dark:border-red-700 dark:text-red-200",info:"bg-blue-50 border-blue-200 text-blue-800 dark:bg-blue-900 dark:border-blue-700 dark:text-blue-200",warning:"bg-yellow-50 border-yellow-200 text-yellow-800 dark:bg-yellow-900 dark:border-yellow-700 dark:text-yellow-200"};function Ql({id:a,type:e,title:t,message:r,onClose:n}){const i=Yl[e];return s.jsx(k.div,{initial:{opacity:0,y:-50,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-50,scale:.95},transition:{duration:.3,ease:[.4,0,.2,1]},className:`max-w-sm w-full border rounded-lg p-4 shadow-lg ${Xl[e]}`,children:s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx(i,{className:"h-5 w-5 mt-0.5 flex-shrink-0"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-sm font-medium",children:t}),r&&s.jsx("p",{className:"text-sm mt-1 opacity-90",children:r})]}),s.jsx("button",{onClick:()=>n(a),className:"flex-shrink-0 ml-2 text-current opacity-70 hover:opacity-100 transition-opacity",children:s.jsx(nt,{className:"h-4 w-4"})})]})})}function Zl({toasts:a,onClose:e}){return s.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:s.jsx(le,{children:a.map(t=>s.jsx(Ql,{...t,onClose:e},t.id))})})}const li=S.createContext(void 0);function ec({children:a}){const[e,t]=S.useState([]),r=S.useCallback(c=>{const m=Math.random().toString(36).substr(2,9),h={...c,id:m,onClose:()=>{}};t(N=>[...N,h]),setTimeout(()=>{t(N=>N.filter(b=>b.id!==m))},c.duration||5e3)},[]),n=S.useCallback((c,m)=>{r({type:"success",title:c,message:m})},[r]),i=S.useCallback((c,m)=>{r({type:"error",title:c,message:m})},[r]),o=S.useCallback((c,m)=>{r({type:"info",title:c,message:m})},[r]),l=S.useCallback((c,m)=>{r({type:"warning",title:c,message:m})},[r]),u=S.useCallback(c=>{t(m=>m.filter(h=>h.id!==c))},[]);return s.jsxs(li.Provider,{value:{showToast:r,showSuccess:n,showError:i,showInfo:o,showWarning:l},children:[a,s.jsx(Zl,{toasts:e,onClose:u})]})}function tc(){const a=S.useContext(li);if(a===void 0)throw new Error("useToast must be used within a ToastProvider");return a}const Rr="RFC3986",Tr={RFC1738:a=>String(a).replace(/%20/g,"+"),RFC3986:a=>String(a)},sc="RFC1738",rc=Array.isArray,je=(()=>{const a=[];for(let e=0;e<256;++e)a.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return a})(),ir=1024,ac=(a,e,t,r,n)=>{if(a.length===0)return a;let i=a;if(typeof a=="symbol"?i=Symbol.prototype.toString.call(a):typeof a!="string"&&(i=String(a)),t==="iso-8859-1")return escape(i).replace(/%u[0-9a-f]{4}/gi,function(l){return"%26%23"+parseInt(l.slice(2),16)+"%3B"});let o="";for(let l=0;l<i.length;l+=ir){const u=i.length>=ir?i.slice(l,l+ir):i,c=[];for(let m=0;m<u.length;++m){let h=u.charCodeAt(m);if(h===45||h===46||h===95||h===126||h>=48&&h<=57||h>=65&&h<=90||h>=97&&h<=122||n===sc&&(h===40||h===41)){c[c.length]=u.charAt(m);continue}if(h<128){c[c.length]=je[h];continue}if(h<2048){c[c.length]=je[192|h>>6]+je[128|h&63];continue}if(h<55296||h>=57344){c[c.length]=je[224|h>>12]+je[128|h>>6&63]+je[128|h&63];continue}m+=1,h=65536+((h&1023)<<10|u.charCodeAt(m)&1023),c[c.length]=je[240|h>>18]+je[128|h>>12&63]+je[128|h>>6&63]+je[128|h&63]}o+=c.join("")}return o};function nc(a){return!a||typeof a!="object"?!1:!!(a.constructor&&a.constructor.isBuffer&&a.constructor.isBuffer(a))}function Wa(a,e){if(rc(a)){const t=[];for(let r=0;r<a.length;r+=1)t.push(e(a[r]));return t}return e(a)}const ic=Object.prototype.hasOwnProperty,ci={brackets(a){return String(a)+"[]"},comma:"comma",indices(a,e){return String(a)+"["+e+"]"},repeat(a){return String(a)}},_e=Array.isArray,oc=Array.prototype.push,di=function(a,e){oc.apply(a,_e(e)?e:[e])},lc=Date.prototype.toISOString,Z={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:ac,encodeValuesOnly:!1,format:Rr,formatter:Tr[Rr],indices:!1,serializeDate(a){return lc.call(a)},skipNulls:!1,strictNullHandling:!1};function cc(a){return typeof a=="string"||typeof a=="number"||typeof a=="boolean"||typeof a=="symbol"||typeof a=="bigint"}const or={};function ui(a,e,t,r,n,i,o,l,u,c,m,h,N,b,f,g,v,x){let y=a,d=x,w=0,_=!1;for(;(d=d.get(or))!==void 0&&!_;){const A=d.get(a);if(w+=1,typeof A<"u"){if(A===w)throw new RangeError("Cyclic object value");_=!0}typeof d.get(or)>"u"&&(w=0)}if(typeof c=="function"?y=c(e,y):y instanceof Date?y=N?.(y):t==="comma"&&_e(y)&&(y=Wa(y,function(A){return A instanceof Date?N?.(A):A})),y===null){if(i)return u&&!g?u(e,Z.encoder,v,"key",b):e;y=""}if(cc(y)||nc(y)){if(u){const A=g?e:u(e,Z.encoder,v,"key",b);return[f?.(A)+"="+f?.(u(y,Z.encoder,v,"value",b))]}return[f?.(e)+"="+f?.(String(y))]}const M=[];if(typeof y>"u")return M;let p;if(t==="comma"&&_e(y))g&&u&&(y=Wa(y,u)),p=[{value:y.length>0?y.join(",")||null:void 0}];else if(_e(c))p=c;else{const A=Object.keys(y);p=m?A.sort(m):A}const C=l?String(e).replace(/\./g,"%2E"):String(e),E=r&&_e(y)&&y.length===1?C+"[]":C;if(n&&_e(y)&&y.length===0)return E+"[]";for(let A=0;A<p.length;++A){const R=p[A],P=typeof R=="object"&&typeof R.value<"u"?R.value:y[R];if(o&&P===null)continue;const H=h&&l?R.replace(/\./g,"%2E"):R,U=_e(y)?typeof t=="function"?t(E,H):E:E+(h?"."+H:"["+H+"]");x.set(a,w);const K=new WeakMap;K.set(or,x),di(M,ui(P,U,t,r,n,i,o,l,t==="comma"&&g&&_e(y)?null:u,c,m,h,N,b,f,g,v,K))}return M}function dc(a=Z){if(typeof a.allowEmptyArrays<"u"&&typeof a.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof a.encodeDotInKeys<"u"&&typeof a.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(a.encoder!==null&&typeof a.encoder<"u"&&typeof a.encoder!="function")throw new TypeError("Encoder has to be a function.");const e=a.charset||Z.charset;if(typeof a.charset<"u"&&a.charset!=="utf-8"&&a.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let t=Rr;if(typeof a.format<"u"){if(!ic.call(Tr,a.format))throw new TypeError("Unknown format option provided.");t=a.format}const r=Tr[t];let n=Z.filter;(typeof a.filter=="function"||_e(a.filter))&&(n=a.filter);let i;if(a.arrayFormat&&a.arrayFormat in ci?i=a.arrayFormat:"indices"in a?i=a.indices?"indices":"repeat":i=Z.arrayFormat,"commaRoundTrip"in a&&typeof a.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const o=typeof a.allowDots>"u"?a.encodeDotInKeys?!0:Z.allowDots:!!a.allowDots;return{addQueryPrefix:typeof a.addQueryPrefix=="boolean"?a.addQueryPrefix:Z.addQueryPrefix,allowDots:o,allowEmptyArrays:typeof a.allowEmptyArrays=="boolean"?!!a.allowEmptyArrays:Z.allowEmptyArrays,arrayFormat:i,charset:e,charsetSentinel:typeof a.charsetSentinel=="boolean"?a.charsetSentinel:Z.charsetSentinel,commaRoundTrip:!!a.commaRoundTrip,delimiter:typeof a.delimiter>"u"?Z.delimiter:a.delimiter,encode:typeof a.encode=="boolean"?a.encode:Z.encode,encodeDotInKeys:typeof a.encodeDotInKeys=="boolean"?a.encodeDotInKeys:Z.encodeDotInKeys,encoder:typeof a.encoder=="function"?a.encoder:Z.encoder,encodeValuesOnly:typeof a.encodeValuesOnly=="boolean"?a.encodeValuesOnly:Z.encodeValuesOnly,filter:n,format:t,formatter:r,serializeDate:typeof a.serializeDate=="function"?a.serializeDate:Z.serializeDate,skipNulls:typeof a.skipNulls=="boolean"?a.skipNulls:Z.skipNulls,sort:typeof a.sort=="function"?a.sort:null,strictNullHandling:typeof a.strictNullHandling=="boolean"?a.strictNullHandling:Z.strictNullHandling}}function uc(a,e={}){let t=a;const r=dc(e);let n,i;typeof r.filter=="function"?(i=r.filter,t=i("",t)):_e(r.filter)&&(i=r.filter,n=i);const o=[];if(typeof t!="object"||t===null)return"";const l=ci[r.arrayFormat],u=l==="comma"&&r.commaRoundTrip;n||(n=Object.keys(t)),r.sort&&n.sort(r.sort);const c=new WeakMap;for(let N=0;N<n.length;++N){const b=n[N];r.skipNulls&&t[b]===null||di(o,ui(t[b],b,l,u,r.allowEmptyArrays,r.strictNullHandling,r.skipNulls,r.encodeDotInKeys,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,c))}const m=o.join(r.delimiter);let h=r.addQueryPrefix===!0?"?":"";return r.charsetSentinel&&(r.charset==="iso-8859-1"?h+="utf8=%26%2310003%3B&":h+="utf8=%E2%9C%93&"),m.length>0?h+m:""}const gt="4.104.0";let Ja=!1,Ht,mi,hi,Mr,gi,pi,fi,xi,yi;function mc(a,e={auto:!1}){if(Ja)throw new Error(`you must \`import 'openai/shims/${a.kind}'\` before importing anything else from openai`);if(Ht)throw new Error(`can't \`import 'openai/shims/${a.kind}'\` after \`import 'openai/shims/${Ht}'\``);Ja=e.auto,Ht=a.kind,mi=a.fetch,a.Request,a.Response,a.Headers,hi=a.FormData,a.Blob,Mr=a.File,gi=a.ReadableStream,pi=a.getMultipartRequestOptions,fi=a.getDefaultAgent,xi=a.fileFromPath,yi=a.isFsReadStream}class hc{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}function gc({manuallyImported:a}={}){const e=a?"You may need to use polyfills":"Add one of these imports before your first `import â€¦ from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let t,r,n,i;try{t=fetch,r=Request,n=Response,i=Headers}catch(o){throw new Error(`this environment is missing the following Web Fetch API type: ${o.message}. ${e}`)}return{kind:"web",fetch:t,Request:r,Response:n,Headers:i,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(o,l)=>({...l,body:new hc(o)}),getDefaultAgent:o=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:o=>!1}}const bi=()=>{Ht||mc(gc(),{auto:!0})};bi();class O extends Error{}class ae extends O{constructor(e,t,r,n){super(`${ae.makeMessage(e,t,r)}`),this.status=e,this.headers=n,this.request_id=n?.["x-request-id"],this.error=t;const i=t;this.code=i?.code,this.param=i?.param,this.type=i?.type}static makeMessage(e,t,r){const n=t?.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):r;return e&&n?`${e} ${n}`:e?`${e} status code (no body)`:n||"(no status code or body)"}static generate(e,t,r,n){if(!e||!n)return new Fs({message:r,cause:Pr(t)});const i=t?.error;return e===400?new wi(e,i,r,n):e===401?new vi(e,i,r,n):e===403?new Ni(e,i,r,n):e===404?new ji(e,i,r,n):e===409?new ki(e,i,r,n):e===422?new _i(e,i,r,n):e===429?new Si(e,i,r,n):e>=500?new Ci(e,i,r,n):new ae(e,i,r,n)}}class fe extends ae{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class Fs extends ae{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class Qr extends Fs{constructor({message:e}={}){super({message:e??"Request timed out."})}}class wi extends ae{}class vi extends ae{}class Ni extends ae{}class ji extends ae{}class ki extends ae{}class _i extends ae{}class Si extends ae{}class Ci extends ae{}class Ai extends O{constructor(){super("Could not parse response content as the length limit was reached")}}class Ei extends O{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}var is=globalThis&&globalThis.__classPrivateFieldSet||function(a,e,t,r,n){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?a!==e||!n:!e.has(a))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?n.call(a,t):n?n.value=t:e.set(a,t),t},Ke=globalThis&&globalThis.__classPrivateFieldGet||function(a,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?a!==e||!r:!e.has(a))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(a):r?r.value:e.get(a)},ge;class Bs{constructor(){ge.set(this,void 0),this.buffer=new Uint8Array,is(this,ge,null,"f")}decode(e){if(e==null)return[];const t=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?new TextEncoder().encode(e):e;let r=new Uint8Array(this.buffer.length+t.length);r.set(this.buffer),r.set(t,this.buffer.length),this.buffer=r;const n=[];let i;for(;(i=pc(this.buffer,Ke(this,ge,"f")))!=null;){if(i.carriage&&Ke(this,ge,"f")==null){is(this,ge,i.index,"f");continue}if(Ke(this,ge,"f")!=null&&(i.index!==Ke(this,ge,"f")+1||i.carriage)){n.push(this.decodeText(this.buffer.slice(0,Ke(this,ge,"f")-1))),this.buffer=this.buffer.slice(Ke(this,ge,"f")),is(this,ge,null,"f");continue}const o=Ke(this,ge,"f")!==null?i.preceding-1:i.preceding,l=this.decodeText(this.buffer.slice(0,o));n.push(l),this.buffer=this.buffer.slice(i.index),is(this,ge,null,"f")}return n}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new O(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new O(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new O("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){return this.buffer.length?this.decode(`
`):[]}}ge=new WeakMap;Bs.NEWLINE_CHARS=new Set([`
`,"\r"]);Bs.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function pc(a,e){for(let n=e??0;n<a.length;n++){if(a[n]===10)return{preceding:n,index:n+1,carriage:!1};if(a[n]===13)return{preceding:n,index:n+1,carriage:!0}}return null}function fc(a){for(let r=0;r<a.length-1;r++){if(a[r]===10&&a[r+1]===10||a[r]===13&&a[r+1]===13)return r+2;if(a[r]===13&&a[r+1]===10&&r+3<a.length&&a[r+2]===13&&a[r+3]===10)return r+4}return-1}function Ri(a){if(a[Symbol.asyncIterator])return a;const e=a.getReader();return{async next(){try{const t=await e.read();return t?.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}class Ae{constructor(e,t){this.iterator=e,this.controller=t}static fromSSEResponse(e,t){let r=!1;async function*n(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let i=!1;try{for await(const o of xc(e,t))if(!i){if(o.data.startsWith("[DONE]")){i=!0;continue}if(o.event===null||o.event.startsWith("response.")||o.event.startsWith("transcript.")){let l;try{l=JSON.parse(o.data)}catch(u){throw console.error("Could not parse message into JSON:",o.data),console.error("From chunk:",o.raw),u}if(l&&l.error)throw new ae(void 0,l.error,void 0,Fi(e.headers));yield l}else{let l;try{l=JSON.parse(o.data)}catch(u){throw console.error("Could not parse message into JSON:",o.data),console.error("From chunk:",o.raw),u}if(o.event=="error")throw new ae(void 0,l.error,l.message,void 0);yield{event:o.event,data:l}}}i=!0}catch(o){if(o instanceof Error&&o.name==="AbortError")return;throw o}finally{i||t.abort()}}return new Ae(n,t)}static fromReadableStream(e,t){let r=!1;async function*n(){const o=new Bs,l=Ri(e);for await(const u of l)for(const c of o.decode(u))yield c;for(const u of o.flush())yield u}async function*i(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let o=!1;try{for await(const l of n())o||l&&(yield JSON.parse(l));o=!0}catch(l){if(l instanceof Error&&l.name==="AbortError")return;throw l}finally{o||t.abort()}}return new Ae(i,t)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],r=this.iterator(),n=i=>({next:()=>{if(i.length===0){const o=r.next();e.push(o),t.push(o)}return i.shift()}});return[new Ae(()=>n(e),this.controller),new Ae(()=>n(t),this.controller)]}toReadableStream(){const e=this;let t;const r=new TextEncoder;return new gi({async start(){t=e[Symbol.asyncIterator]()},async pull(n){try{const{value:i,done:o}=await t.next();if(o)return n.close();const l=r.encode(JSON.stringify(i)+`
`);n.enqueue(l)}catch(i){n.error(i)}},async cancel(){await t.return?.()}})}}async function*xc(a,e){if(!a.body)throw e.abort(),new O("Attempted to iterate over a response with no body");const t=new bc,r=new Bs,n=Ri(a.body);for await(const i of yc(n))for(const o of r.decode(i)){const l=t.decode(o);l&&(yield l)}for(const i of r.flush()){const o=t.decode(i);o&&(yield o)}}async function*yc(a){let e=new Uint8Array;for await(const t of a){if(t==null)continue;const r=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?new TextEncoder().encode(t):t;let n=new Uint8Array(e.length+r.length);n.set(e),n.set(r,e.length),e=n;let i;for(;(i=fc(e))!==-1;)yield e.slice(0,i),e=e.slice(i)}e.length>0&&(yield e)}class bc{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const i={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],i}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,r,n]=wc(e,":");return n.startsWith(" ")&&(n=n.substring(1)),t==="event"?this.event=n:t==="data"&&this.data.push(n),null}}function wc(a,e){const t=a.indexOf(e);return t!==-1?[a.substring(0,t),e,a.substring(t+e.length)]:[a,"",""]}const Ti=a=>a!=null&&typeof a=="object"&&typeof a.url=="string"&&typeof a.blob=="function",Mi=a=>a!=null&&typeof a=="object"&&typeof a.name=="string"&&typeof a.lastModified=="number"&&$s(a),$s=a=>a!=null&&typeof a=="object"&&typeof a.size=="number"&&typeof a.type=="string"&&typeof a.text=="function"&&typeof a.slice=="function"&&typeof a.arrayBuffer=="function",vc=a=>Mi(a)||Ti(a)||yi(a);async function Ii(a,e,t){if(a=await a,Mi(a))return a;if(Ti(a)){const n=await a.blob();e||(e=new URL(a.url).pathname.split(/[\\/]/).pop()??"unknown_file");const i=$s(n)?[await n.arrayBuffer()]:[n];return new Mr(i,e,t)}const r=await Nc(a);if(e||(e=kc(a)??"unknown_file"),!t?.type){const n=r[0]?.type;typeof n=="string"&&(t={...t,type:n})}return new Mr(r,e,t)}async function Nc(a){let e=[];if(typeof a=="string"||ArrayBuffer.isView(a)||a instanceof ArrayBuffer)e.push(a);else if($s(a))e.push(await a.arrayBuffer());else if(_c(a))for await(const t of a)e.push(t);else throw new Error(`Unexpected data type: ${typeof a}; constructor: ${a?.constructor?.name}; props: ${jc(a)}`);return e}function jc(a){return`[${Object.getOwnPropertyNames(a).map(t=>`"${t}"`).join(", ")}]`}function kc(a){return lr(a.name)||lr(a.filename)||lr(a.path)?.split(/[\\/]/).pop()}const lr=a=>{if(typeof a=="string")return a;if(typeof Buffer<"u"&&a instanceof Buffer)return String(a)},_c=a=>a!=null&&typeof a=="object"&&typeof a[Symbol.asyncIterator]=="function",Ka=a=>a&&typeof a=="object"&&a.body&&a[Symbol.toStringTag]==="MultipartBody",it=async a=>{const e=await Sc(a.body);return pi(e,a)},Sc=async a=>{const e=new hi;return await Promise.all(Object.entries(a||{}).map(([t,r])=>Ir(e,t,r))),e},Ir=async(a,e,t)=>{if(t!==void 0){if(t==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof t=="string"||typeof t=="number"||typeof t=="boolean")a.append(e,String(t));else if(vc(t)){const r=await Ii(t);a.append(e,r)}else if(Array.isArray(t))await Promise.all(t.map(r=>Ir(a,e+"[]",r)));else if(typeof t=="object")await Promise.all(Object.entries(t).map(([r,n])=>Ir(a,`${e}[${r}]`,n)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${t} instead`)}};var Cc=globalThis&&globalThis.__classPrivateFieldSet||function(a,e,t,r,n){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?a!==e||!n:!e.has(a))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?n.call(a,t):n?n.value=t:e.set(a,t),t},Ac=globalThis&&globalThis.__classPrivateFieldGet||function(a,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?a!==e||!r:!e.has(a))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(a):r?r.value:e.get(a)},os;bi();async function Pi(a){const{response:e}=a;if(a.options.stream)return qe("response",e.status,e.url,e.headers,e.body),a.options.__streamClass?a.options.__streamClass.fromSSEResponse(e,a.controller):Ae.fromSSEResponse(e,a.controller);if(e.status===204)return null;if(a.options.__binaryResponse)return e;const r=e.headers.get("content-type")?.split(";")[0]?.trim();if(r?.includes("application/json")||r?.endsWith("+json")){const o=await e.json();return qe("response",e.status,e.url,e.headers,o),Oi(o,e)}const i=await e.text();return qe("response",e.status,e.url,e.headers,i),i}function Oi(a,e){return!a||typeof a!="object"||Array.isArray(a)?a:Object.defineProperty(a,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}class Ls extends Promise{constructor(e,t=Pi){super(r=>{r(null)}),this.responsePromise=e,this.parseResponse=t}_thenUnwrap(e){return new Ls(this.responsePromise,async t=>Oi(e(await this.parseResponse(t),t),t.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class Ec{constructor({baseURL:e,maxRetries:t=2,timeout:r=6e5,httpAgent:n,fetch:i}){this.baseURL=e,this.maxRetries=cr("maxRetries",t),this.timeout=cr("timeout",r),this.httpAgent=n,this.fetch=i??mi}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...Pc(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${Bc()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,r){return this.request(Promise.resolve(r).then(async n=>{const i=n&&$s(n?.body)?new DataView(await n.body.arrayBuffer()):n?.body instanceof DataView?n.body:n?.body instanceof ArrayBuffer?new DataView(n.body):n&&ArrayBuffer.isView(n?.body)?new DataView(n.body.buffer):n?.body;return{method:e,path:t,...n,body:i}}))}getAPIList(e,t,r){return this.requestAPIList(t,{method:"get",path:e,...r})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:t=0}={}){const r={...e},{method:n,path:i,query:o,headers:l={}}=r,u=ArrayBuffer.isView(r.body)||r.__binaryRequest&&typeof r.body=="string"?r.body:Ka(r.body)?r.body.body:r.body?JSON.stringify(r.body,null,2):null,c=this.calculateContentLength(u),m=this.buildURL(i,o);"timeout"in r&&cr("timeout",r.timeout),r.timeout=r.timeout??this.timeout;const h=r.httpAgent??this.httpAgent??fi(m),N=r.timeout+1e3;typeof h?.options?.timeout=="number"&&N>(h.options.timeout??0)&&(h.options.timeout=N),this.idempotencyHeader&&n!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),l[this.idempotencyHeader]=e.idempotencyKey);const b=this.buildHeaders({options:r,headers:l,contentLength:c,retryCount:t});return{req:{method:n,...u&&{body:u},headers:b,...h&&{agent:h},signal:r.signal??null},url:m,timeout:r.timeout}}buildHeaders({options:e,headers:t,contentLength:r,retryCount:n}){const i={};r&&(i["content-length"]=r);const o=this.defaultHeaders(e);return Za(i,o),Za(i,t),Ka(e.body)&&Ht!=="node"&&delete i["content-type"],cs(o,"x-stainless-retry-count")===void 0&&cs(t,"x-stainless-retry-count")===void 0&&(i["x-stainless-retry-count"]=String(n)),cs(o,"x-stainless-timeout")===void 0&&cs(t,"x-stainless-timeout")===void 0&&e.timeout&&(i["x-stainless-timeout"]=String(Math.trunc(e.timeout/1e3))),this.validateHeaders(i,t),i}async prepareOptions(e){}async prepareRequest(e,{url:t,options:r}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(t=>[...t])):{...e}:{}}makeStatusError(e,t,r,n){return ae.generate(e,t,r,n)}request(e,t=null){return new Ls(this.makeRequest(e,t))}async makeRequest(e,t){const r=await e,n=r.maxRetries??this.maxRetries;t==null&&(t=n),await this.prepareOptions(r);const{req:i,url:o,timeout:l}=this.buildRequest(r,{retryCount:n-t});if(await this.prepareRequest(i,{url:o,options:r}),qe("request",o,r,i.headers),r.signal?.aborted)throw new fe;const u=new AbortController,c=await this.fetchWithTimeout(o,i,l,u).catch(Pr);if(c instanceof Error){if(r.signal?.aborted)throw new fe;if(t)return this.retryRequest(r,t);throw c.name==="AbortError"?new Qr:new Fs({cause:c})}const m=Fi(c.headers);if(!c.ok){if(t&&this.shouldRetry(c)){const v=`retrying, ${t} attempts remaining`;return qe(`response (error; ${v})`,c.status,o,m),this.retryRequest(r,t,m)}const h=await c.text().catch(v=>Pr(v).message),N=Oc(h),b=N?void 0:h;throw qe(`response (error; ${t?"(error; no more retries left)":"(error; not retryable)"})`,c.status,o,m,b),this.makeStatusError(c.status,N,b,m)}return{response:c,options:r,controller:u}}requestAPIList(e,t){const r=this.makeRequest(t,null);return new Rc(this,r,e)}buildURL(e,t){const r=Fc(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),n=this.defaultQuery();return Bi(n)||(t={...n,...t}),typeof t=="object"&&t&&!Array.isArray(t)&&(r.search=this.stringifyQuery(t)),r.toString()}stringifyQuery(e){return Object.entries(e).filter(([t,r])=>typeof r<"u").map(([t,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(t)}=`;throw new O(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,t,r,n){const{signal:i,...o}=t||{};i&&i.addEventListener("abort",()=>n.abort());const l=setTimeout(()=>n.abort(),r),u={signal:n.signal,...o};return u.method&&(u.method=u.method.toUpperCase()),this.fetch.call(void 0,e,u).finally(()=>{clearTimeout(l)})}shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,r){let n;const i=r?.["retry-after-ms"];if(i){const l=parseFloat(i);Number.isNaN(l)||(n=l)}const o=r?.["retry-after"];if(o&&!n){const l=parseFloat(o);Number.isNaN(l)?n=Date.parse(o)-Date.now():n=l*1e3}if(!(n&&0<=n&&n<60*1e3)){const l=e.maxRetries??this.maxRetries;n=this.calculateDefaultRetryTimeoutMillis(t,l)}return await Jt(n),this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){const i=t-e,o=Math.min(.5*Math.pow(2,i),8),l=1-Math.random()*.25;return o*l*1e3}getUserAgent(){return`${this.constructor.name}/JS ${gt}`}}class Di{constructor(e,t,r,n){os.set(this,void 0),Cc(this,os,e,"f"),this.options=n,this.response=t,this.body=r}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new O("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const t={...this.options};if("params"in e&&typeof t.query=="object")t.query={...t.query,...e.params};else if("url"in e){const r=[...Object.entries(t.query||{}),...e.url.searchParams.entries()];for(const[n,i]of r)e.url.searchParams.set(n,i);t.query=void 0,t.path=e.url.toString()}return await Ac(this,os,"f").requestAPIList(this.constructor,t)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(os=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const t of e.getPaginatedItems())yield t}}class Rc extends Ls{constructor(e,t,r){super(t,async n=>new r(e,n.response,await Pi(n),n.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const t of e)yield t}}const Fi=a=>new Proxy(Object.fromEntries(a.entries()),{get(e,t){const r=t.toString();return e[r.toLowerCase()]||e[r]}}),Tc={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__metadata:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},J=a=>typeof a=="object"&&a!==null&&!Bi(a)&&Object.keys(a).every(e=>$i(Tc,e)),Mc=()=>{if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":gt,"X-Stainless-OS":Xa(Deno.build.os),"X-Stainless-Arch":Ya(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:Deno.version?.deno??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":gt,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":gt,"X-Stainless-OS":Xa(process.platform),"X-Stainless-Arch":Ya(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const a=Ic();return a?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":gt,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${a.browser}`,"X-Stainless-Runtime-Version":a.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":gt,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function Ic(){if(typeof navigator>"u"||!navigator)return null;const a=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of a){const r=t.exec(navigator.userAgent);if(r){const n=r[1]||0,i=r[2]||0,o=r[3]||0;return{browser:e,version:`${n}.${i}.${o}`}}}return null}const Ya=a=>a==="x32"?"x32":a==="x86_64"||a==="x64"?"x64":a==="arm"?"arm":a==="aarch64"||a==="arm64"?"arm64":a?`other:${a}`:"unknown",Xa=a=>(a=a.toLowerCase(),a.includes("ios")?"iOS":a==="android"?"Android":a==="darwin"?"MacOS":a==="win32"?"Windows":a==="freebsd"?"FreeBSD":a==="openbsd"?"OpenBSD":a==="linux"?"Linux":a?`Other:${a}`:"Unknown");let Qa;const Pc=()=>Qa??(Qa=Mc()),Oc=a=>{try{return JSON.parse(a)}catch{return}},Dc=/^[a-z][a-z0-9+.-]*:/i,Fc=a=>Dc.test(a),Jt=a=>new Promise(e=>setTimeout(e,a)),cr=(a,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new O(`${a} must be an integer`);if(e<0)throw new O(`${a} must be a positive integer`);return e},Pr=a=>{if(a instanceof Error)return a;if(typeof a=="object"&&a!==null)try{return new Error(JSON.stringify(a))}catch{}return new Error(a)},ls=a=>{if(typeof process<"u")return process.env?.[a]?.trim()??void 0;if(typeof Deno<"u")return Deno.env?.get?.(a)?.trim()};function Bi(a){if(!a)return!0;for(const e in a)return!1;return!0}function $i(a,e){return Object.prototype.hasOwnProperty.call(a,e)}function Za(a,e){for(const t in e){if(!$i(e,t))continue;const r=t.toLowerCase();if(!r)continue;const n=e[t];n===null?delete a[r]:n!==void 0&&(a[r]=n)}}const en=new Set(["authorization","api-key"]);function qe(a,...e){if(typeof process<"u"&&process?.env?.DEBUG==="true"){const t=e.map(r=>{if(!r)return r;if(r.headers){const i={...r,headers:{...r.headers}};for(const o in r.headers)en.has(o.toLowerCase())&&(i.headers[o]="REDACTED");return i}let n=null;for(const i in r)en.has(i.toLowerCase())&&(n??(n={...r}),n[i]="REDACTED");return n??r});console.log(`OpenAI:DEBUG:${a}`,...t)}}const Bc=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,a=>{const e=Math.random()*16|0;return(a==="x"?e:e&3|8).toString(16)}),$c=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",Lc=a=>typeof a?.get=="function",cs=(a,e)=>{const t=e.toLowerCase();if(Lc(a)){const r=e[0]?.toUpperCase()+e.substring(1).replace(/([^\w])(\w)/g,(n,i,o)=>i+o.toUpperCase());for(const n of[e,t,e.toUpperCase(),r]){const i=a.get(n);if(i)return i}}for(const[r,n]of Object.entries(a))if(r.toLowerCase()===t)return Array.isArray(n)?(n.length<=1||console.warn(`Received ${n.length} entries for the ${e} header, using the first entry.`),n[0]):n},Uc=a=>{if(typeof Buffer<"u"){const e=Buffer.from(a,"base64");return Array.from(new Float32Array(e.buffer,e.byteOffset,e.length/Float32Array.BYTES_PER_ELEMENT))}else{const e=atob(a),t=e.length,r=new Uint8Array(t);for(let n=0;n<t;n++)r[n]=e.charCodeAt(n);return Array.from(new Float32Array(r.buffer))}};function dr(a){return a!=null&&typeof a=="object"&&!Array.isArray(a)}class Us extends Di{constructor(e,t,r,n){super(e,t,r,n),this.data=r.data||[],this.object=r.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class ee extends Di{constructor(e,t,r,n){super(e,t,r,n),this.data=r.data||[],this.has_more=r.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const t=Object.fromEntries(e.url.searchParams);return Object.keys(t).length?t:null}nextPageInfo(){const e=this.getPaginatedItems();if(!e.length)return null;const t=e[e.length-1]?.id;return t?{params:{after:t}}:null}}class D{constructor(e){this._client=e}}let Li=class extends D{list(e,t={},r){return J(t)?this.list(e,{},t):this._client.getAPIList(`/chat/completions/${e}/messages`,Hc,{query:t,...r})}},Hs=class extends D{constructor(){super(...arguments),this.messages=new Li(this._client)}create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}retrieve(e,t){return this._client.get(`/chat/completions/${e}`,t)}update(e,t,r){return this._client.post(`/chat/completions/${e}`,{body:t,...r})}list(e={},t){return J(e)?this.list({},e):this._client.getAPIList("/chat/completions",zs,{query:e,...t})}del(e,t){return this._client.delete(`/chat/completions/${e}`,t)}};class zs extends ee{}class Hc extends ee{}Hs.ChatCompletionsPage=zs;Hs.Messages=Li;let Vs=class extends D{constructor(){super(...arguments),this.completions=new Hs(this._client)}};Vs.Completions=Hs;Vs.ChatCompletionsPage=zs;class Ui extends D{create(e,t){return this._client.post("/audio/speech",{body:e,...t,headers:{Accept:"application/octet-stream",...t?.headers},__binaryResponse:!0})}}class Hi extends D{create(e,t){return this._client.post("/audio/transcriptions",it({body:e,...t,stream:e.stream??!1,__metadata:{model:e.model}}))}}class zi extends D{create(e,t){return this._client.post("/audio/translations",it({body:e,...t,__metadata:{model:e.model}}))}}class Kt extends D{constructor(){super(...arguments),this.transcriptions=new Hi(this._client),this.translations=new zi(this._client),this.speech=new Ui(this._client)}}Kt.Transcriptions=Hi;Kt.Translations=zi;Kt.Speech=Ui;class Zr extends D{create(e,t){return this._client.post("/batches",{body:e,...t})}retrieve(e,t){return this._client.get(`/batches/${e}`,t)}list(e={},t){return J(e)?this.list({},e):this._client.getAPIList("/batches",ea,{query:e,...t})}cancel(e,t){return this._client.post(`/batches/${e}/cancel`,t)}}class ea extends ee{}Zr.BatchesPage=ea;var xe=globalThis&&globalThis.__classPrivateFieldSet||function(a,e,t,r,n){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?a!==e||!n:!e.has(a))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?n.call(a,t):n?n.value=t:e.set(a,t),t},W=globalThis&&globalThis.__classPrivateFieldGet||function(a,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?a!==e||!r:!e.has(a))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(a):r?r.value:e.get(a)},Or,ys,bs,Pt,Ot,ws,Dt,Ie,Ft,Es,Rs,pt,Vi;class ta{constructor(){Or.add(this),this.controller=new AbortController,ys.set(this,void 0),bs.set(this,()=>{}),Pt.set(this,()=>{}),Ot.set(this,void 0),ws.set(this,()=>{}),Dt.set(this,()=>{}),Ie.set(this,{}),Ft.set(this,!1),Es.set(this,!1),Rs.set(this,!1),pt.set(this,!1),xe(this,ys,new Promise((e,t)=>{xe(this,bs,e,"f"),xe(this,Pt,t,"f")}),"f"),xe(this,Ot,new Promise((e,t)=>{xe(this,ws,e,"f"),xe(this,Dt,t,"f")}),"f"),W(this,ys,"f").catch(()=>{}),W(this,Ot,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},W(this,Or,"m",Vi).bind(this))},0)}_connected(){this.ended||(W(this,bs,"f").call(this),this._emit("connect"))}get ended(){return W(this,Ft,"f")}get errored(){return W(this,Es,"f")}get aborted(){return W(this,Rs,"f")}abort(){this.controller.abort()}on(e,t){return(W(this,Ie,"f")[e]||(W(this,Ie,"f")[e]=[])).push({listener:t}),this}off(e,t){const r=W(this,Ie,"f")[e];if(!r)return this;const n=r.findIndex(i=>i.listener===t);return n>=0&&r.splice(n,1),this}once(e,t){return(W(this,Ie,"f")[e]||(W(this,Ie,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,r)=>{xe(this,pt,!0,"f"),e!=="error"&&this.once("error",r),this.once(e,t)})}async done(){xe(this,pt,!0,"f"),await W(this,Ot,"f")}_emit(e,...t){if(W(this,Ft,"f"))return;e==="end"&&(xe(this,Ft,!0,"f"),W(this,ws,"f").call(this));const r=W(this,Ie,"f")[e];if(r&&(W(this,Ie,"f")[e]=r.filter(n=>!n.once),r.forEach(({listener:n})=>n(...t))),e==="abort"){const n=t[0];!W(this,pt,"f")&&!r?.length&&Promise.reject(n),W(this,Pt,"f").call(this,n),W(this,Dt,"f").call(this,n),this._emit("end");return}if(e==="error"){const n=t[0];!W(this,pt,"f")&&!r?.length&&Promise.reject(n),W(this,Pt,"f").call(this,n),W(this,Dt,"f").call(this,n),this._emit("end")}}_emitFinal(){}}ys=new WeakMap,bs=new WeakMap,Pt=new WeakMap,Ot=new WeakMap,ws=new WeakMap,Dt=new WeakMap,Ie=new WeakMap,Ft=new WeakMap,Es=new WeakMap,Rs=new WeakMap,pt=new WeakMap,Or=new WeakSet,Vi=function(e){if(xe(this,Es,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new fe),e instanceof fe)return xe(this,Rs,!0,"f"),this._emit("abort",e);if(e instanceof O)return this._emit("error",e);if(e instanceof Error){const t=new O(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new O(String(e)))};var I=globalThis&&globalThis.__classPrivateFieldGet||function(a,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?a!==e||!r:!e.has(a))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(a):r?r.value:e.get(a)},he=globalThis&&globalThis.__classPrivateFieldSet||function(a,e,t,r,n){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?a!==e||!n:!e.has(a))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?n.call(a,t):n?n.value=t:e.set(a,t),t},re,Dr,Se,vs,ye,st,xt,Qe,Ts,pe,Ns,js,zt,Bt,$t,tn,sn,rn,an,nn,on,ln;class we extends ta{constructor(){super(...arguments),re.add(this),Dr.set(this,[]),Se.set(this,{}),vs.set(this,{}),ye.set(this,void 0),st.set(this,void 0),xt.set(this,void 0),Qe.set(this,void 0),Ts.set(this,void 0),pe.set(this,void 0),Ns.set(this,void 0),js.set(this,void 0),zt.set(this,void 0)}[(Dr=new WeakMap,Se=new WeakMap,vs=new WeakMap,ye=new WeakMap,st=new WeakMap,xt=new WeakMap,Qe=new WeakMap,Ts=new WeakMap,pe=new WeakMap,Ns=new WeakMap,js=new WeakMap,zt=new WeakMap,re=new WeakSet,Symbol.asyncIterator)](){const e=[],t=[];let r=!1;return this.on("event",n=>{const i=t.shift();i?i.resolve(n):e.push(n)}),this.on("end",()=>{r=!0;for(const n of t)n.resolve(void 0);t.length=0}),this.on("abort",n=>{r=!0;for(const i of t)i.reject(n);t.length=0}),this.on("error",n=>{r=!0;for(const i of t)i.reject(n);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,o)=>t.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const t=new we;return t._run(()=>t._fromReadableStream(e)),t}async _fromReadableStream(e,t){const r=t?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),this._connected();const n=Ae.fromReadableStream(e,this.controller);for await(const i of n)I(this,re,"m",Bt).call(this,i);if(n.controller.signal?.aborted)throw new fe;return this._addRun(I(this,re,"m",$t).call(this))}toReadableStream(){return new Ae(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,t,r,n,i){const o=new we;return o._run(()=>o._runToolAssistantStream(e,t,r,n,{...i,headers:{...i?.headers,"X-Stainless-Helper-Method":"stream"}})),o}async _createToolAssistantStream(e,t,r,n,i){const o=i?.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort()));const l={...n,stream:!0},u=await e.submitToolOutputs(t,r,l,{...i,signal:this.controller.signal});this._connected();for await(const c of u)I(this,re,"m",Bt).call(this,c);if(u.controller.signal?.aborted)throw new fe;return this._addRun(I(this,re,"m",$t).call(this))}static createThreadAssistantStream(e,t,r){const n=new we;return n._run(()=>n._threadAssistantStream(e,t,{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}})),n}static createAssistantStream(e,t,r,n){const i=new we;return i._run(()=>i._runAssistantStream(e,t,r,{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}})),i}currentEvent(){return I(this,Ns,"f")}currentRun(){return I(this,js,"f")}currentMessageSnapshot(){return I(this,ye,"f")}currentRunStepSnapshot(){return I(this,zt,"f")}async finalRunSteps(){return await this.done(),Object.values(I(this,Se,"f"))}async finalMessages(){return await this.done(),Object.values(I(this,vs,"f"))}async finalRun(){if(await this.done(),!I(this,st,"f"))throw Error("Final run was not received.");return I(this,st,"f")}async _createThreadAssistantStream(e,t,r){const n=r?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort()));const i={...t,stream:!0},o=await e.createAndRun(i,{...r,signal:this.controller.signal});this._connected();for await(const l of o)I(this,re,"m",Bt).call(this,l);if(o.controller.signal?.aborted)throw new fe;return this._addRun(I(this,re,"m",$t).call(this))}async _createAssistantStream(e,t,r,n){const i=n?.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const o={...r,stream:!0},l=await e.create(t,o,{...n,signal:this.controller.signal});this._connected();for await(const u of l)I(this,re,"m",Bt).call(this,u);if(l.controller.signal?.aborted)throw new fe;return this._addRun(I(this,re,"m",$t).call(this))}static accumulateDelta(e,t){for(const[r,n]of Object.entries(t)){if(!e.hasOwnProperty(r)){e[r]=n;continue}let i=e[r];if(i==null){e[r]=n;continue}if(r==="index"||r==="type"){e[r]=n;continue}if(typeof i=="string"&&typeof n=="string")i+=n;else if(typeof i=="number"&&typeof n=="number")i+=n;else if(dr(i)&&dr(n))i=this.accumulateDelta(i,n);else if(Array.isArray(i)&&Array.isArray(n)){if(i.every(o=>typeof o=="string"||typeof o=="number")){i.push(...n);continue}for(const o of n){if(!dr(o))throw new Error(`Expected array delta entry to be an object but got: ${o}`);const l=o.index;if(l==null)throw console.error(o),new Error("Expected array delta entry to have an `index` property");if(typeof l!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${l}`);const u=i[l];u==null?i.push(o):i[l]=this.accumulateDelta(u,o)}continue}else throw Error(`Unhandled record type: ${r}, deltaValue: ${n}, accValue: ${i}`);e[r]=i}return e}_addRun(e){return e}async _threadAssistantStream(e,t,r){return await this._createThreadAssistantStream(t,e,r)}async _runAssistantStream(e,t,r,n){return await this._createAssistantStream(t,e,r,n)}async _runToolAssistantStream(e,t,r,n,i){return await this._createToolAssistantStream(r,e,t,n,i)}}Bt=function(e){if(!this.ended)switch(he(this,Ns,e,"f"),I(this,re,"m",rn).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":I(this,re,"m",ln).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":I(this,re,"m",sn).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":I(this,re,"m",tn).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},$t=function(){if(this.ended)throw new O("stream has ended, this shouldn't happen");if(!I(this,st,"f"))throw Error("Final run has not been received");return I(this,st,"f")},tn=function(e){const[t,r]=I(this,re,"m",nn).call(this,e,I(this,ye,"f"));he(this,ye,t,"f"),I(this,vs,"f")[t.id]=t;for(const n of r){const i=t.content[n.index];i?.type=="text"&&this._emit("textCreated",i.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(const n of e.data.delta.content){if(n.type=="text"&&n.text){let i=n.text,o=t.content[n.index];if(o&&o.type=="text")this._emit("textDelta",i,o.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(n.index!=I(this,xt,"f")){if(I(this,Qe,"f"))switch(I(this,Qe,"f").type){case"text":this._emit("textDone",I(this,Qe,"f").text,I(this,ye,"f"));break;case"image_file":this._emit("imageFileDone",I(this,Qe,"f").image_file,I(this,ye,"f"));break}he(this,xt,n.index,"f")}he(this,Qe,t.content[n.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(I(this,xt,"f")!==void 0){const n=e.data.content[I(this,xt,"f")];if(n)switch(n.type){case"image_file":this._emit("imageFileDone",n.image_file,I(this,ye,"f"));break;case"text":this._emit("textDone",n.text,I(this,ye,"f"));break}}I(this,ye,"f")&&this._emit("messageDone",e.data),he(this,ye,void 0,"f")}},sn=function(e){const t=I(this,re,"m",an).call(this,e);switch(he(this,zt,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const r=e.data.delta;if(r.step_details&&r.step_details.type=="tool_calls"&&r.step_details.tool_calls&&t.step_details.type=="tool_calls")for(const i of r.step_details.tool_calls)i.index==I(this,Ts,"f")?this._emit("toolCallDelta",i,t.step_details.tool_calls[i.index]):(I(this,pe,"f")&&this._emit("toolCallDone",I(this,pe,"f")),he(this,Ts,i.index,"f"),he(this,pe,t.step_details.tool_calls[i.index],"f"),I(this,pe,"f")&&this._emit("toolCallCreated",I(this,pe,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":he(this,zt,void 0,"f"),e.data.step_details.type=="tool_calls"&&I(this,pe,"f")&&(this._emit("toolCallDone",I(this,pe,"f")),he(this,pe,void 0,"f")),this._emit("runStepDone",e.data,t);break}},rn=function(e){I(this,Dr,"f").push(e),this._emit("event",e)},an=function(e){switch(e.event){case"thread.run.step.created":return I(this,Se,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=I(this,Se,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let r=e.data;if(r.delta){const n=we.accumulateDelta(t,r.delta);I(this,Se,"f")[e.data.id]=n}return I(this,Se,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":I(this,Se,"f")[e.data.id]=e.data;break}if(I(this,Se,"f")[e.data.id])return I(this,Se,"f")[e.data.id];throw new Error("No snapshot available")},nn=function(e,t){let r=[];switch(e.event){case"thread.message.created":return[e.data,r];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let n=e.data;if(n.delta.content)for(const i of n.delta.content)if(i.index in t.content){let o=t.content[i.index];t.content[i.index]=I(this,re,"m",on).call(this,i,o)}else t.content[i.index]=i,r.push(i);return[t,r];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,r];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},on=function(e,t){return we.accumulateDelta(t,e)},ln=function(e){switch(he(this,js,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":he(this,st,e.data,"f"),I(this,pe,"f")&&(this._emit("toolCallDone",I(this,pe,"f")),he(this,pe,void 0,"f"));break}};class sa extends D{create(e,t){return this._client.post("/assistants",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}retrieve(e,t){return this._client.get(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}update(e,t,r){return this._client.post(`/assistants/${e}`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}list(e={},t){return J(e)?this.list({},e):this._client.getAPIList("/assistants",ra,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}del(e,t){return this._client.delete(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}}class ra extends ee{}sa.AssistantsPage=ra;function cn(a){return typeof a.parse=="function"}const yt=a=>a?.role==="assistant",qi=a=>a?.role==="function",Gi=a=>a?.role==="tool";function aa(a){return a?.$brand==="auto-parseable-response-format"}function Yt(a){return a?.$brand==="auto-parseable-tool"}function zc(a,e){return!e||!Wi(e)?{...a,choices:a.choices.map(t=>({...t,message:{...t.message,parsed:null,...t.message.tool_calls?{tool_calls:t.message.tool_calls}:void 0}}))}:na(a,e)}function na(a,e){const t=a.choices.map(r=>{if(r.finish_reason==="length")throw new Ai;if(r.finish_reason==="content_filter")throw new Ei;return{...r,message:{...r.message,...r.message.tool_calls?{tool_calls:r.message.tool_calls?.map(n=>qc(e,n))??void 0}:void 0,parsed:r.message.content&&!r.message.refusal?Vc(e,r.message.content):null}}});return{...a,choices:t}}function Vc(a,e){return a.response_format?.type!=="json_schema"?null:a.response_format?.type==="json_schema"?"$parseRaw"in a.response_format?a.response_format.$parseRaw(e):JSON.parse(e):null}function qc(a,e){const t=a.tools?.find(r=>r.function?.name===e.function.name);return{...e,function:{...e.function,parsed_arguments:Yt(t)?t.$parseRaw(e.function.arguments):t?.function.strict?JSON.parse(e.function.arguments):null}}}function Gc(a,e){if(!a)return!1;const t=a.tools?.find(r=>r.function?.name===e.function.name);return Yt(t)||t?.function.strict||!1}function Wi(a){return aa(a.response_format)?!0:a.tools?.some(e=>Yt(e)||e.type==="function"&&e.function.strict===!0)??!1}function Wc(a){for(const e of a??[]){if(e.type!=="function")throw new O(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new O(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var ce=globalThis&&globalThis.__classPrivateFieldGet||function(a,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?a!==e||!r:!e.has(a))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(a):r?r.value:e.get(a)},ne,Fr,Ms,Br,$r,Lr,Ji,Ur;const dn=10;class Ki extends ta{constructor(){super(...arguments),ne.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){this._chatCompletions.push(e),this._emit("chatCompletion",e);const t=e.choices[0]?.message;return t&&this._addMessage(t),e}_addMessage(e,t=!0){if("content"in e||(e.content=null),this.messages.push(e),t){if(this._emit("message",e),(qi(e)||Gi(e))&&e.content)this._emit("functionCallResult",e.content);else if(yt(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(yt(e)&&e.tool_calls)for(const r of e.tool_calls)r.type==="function"&&this._emit("functionCall",r.function)}}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new O("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),ce(this,ne,"m",Fr).call(this)}async finalMessage(){return await this.done(),ce(this,ne,"m",Ms).call(this)}async finalFunctionCall(){return await this.done(),ce(this,ne,"m",Br).call(this)}async finalFunctionCallResult(){return await this.done(),ce(this,ne,"m",$r).call(this)}async totalUsage(){return await this.done(),ce(this,ne,"m",Lr).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const t=ce(this,ne,"m",Ms).call(this);t&&this._emit("finalMessage",t);const r=ce(this,ne,"m",Fr).call(this);r&&this._emit("finalContent",r);const n=ce(this,ne,"m",Br).call(this);n&&this._emit("finalFunctionCall",n);const i=ce(this,ne,"m",$r).call(this);i!=null&&this._emit("finalFunctionCallResult",i),this._chatCompletions.some(o=>o.usage)&&this._emit("totalUsage",ce(this,ne,"m",Lr).call(this))}async _createChatCompletion(e,t,r){const n=r?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),ce(this,ne,"m",Ji).call(this,t);const i=await e.chat.completions.create({...t,stream:!1},{...r,signal:this.controller.signal});return this._connected(),this._addChatCompletion(na(i,t))}async _runChatCompletion(e,t,r){for(const n of t.messages)this._addMessage(n,!1);return await this._createChatCompletion(e,t,r)}async _runFunctions(e,t,r){const n="function",{function_call:i="auto",stream:o,...l}=t,u=typeof i!="string"&&i?.name,{maxChatCompletions:c=dn}=r||{},m={};for(const N of t.functions)m[N.name||N.function.name]=N;const h=t.functions.map(N=>({name:N.name||N.function.name,parameters:N.parameters,description:N.description}));for(const N of t.messages)this._addMessage(N,!1);for(let N=0;N<c;++N){const f=(await this._createChatCompletion(e,{...l,function_call:i,functions:h,messages:[...this.messages]},r)).choices[0]?.message;if(!f)throw new O("missing message in ChatCompletion response");if(!f.function_call)return;const{name:g,arguments:v}=f.function_call,x=m[g];if(x){if(u&&u!==g){const _=`Invalid function_call: ${JSON.stringify(g)}. ${JSON.stringify(u)} requested. Please try again`;this._addMessage({role:n,name:g,content:_});continue}}else{const _=`Invalid function_call: ${JSON.stringify(g)}. Available options are: ${h.map(M=>JSON.stringify(M.name)).join(", ")}. Please try again`;this._addMessage({role:n,name:g,content:_});continue}let y;try{y=cn(x)?await x.parse(v):v}catch(_){this._addMessage({role:n,name:g,content:_ instanceof Error?_.message:String(_)});continue}const d=await x.function(y,this),w=ce(this,ne,"m",Ur).call(this,d);if(this._addMessage({role:n,name:g,content:w}),u)return}}async _runTools(e,t,r){const n="tool",{tool_choice:i="auto",stream:o,...l}=t,u=typeof i!="string"&&i?.function?.name,{maxChatCompletions:c=dn}=r||{},m=t.tools.map(b=>{if(Yt(b)){if(!b.$callback)throw new O("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:b.$callback,name:b.function.name,description:b.function.description||"",parameters:b.function.parameters,parse:b.$parseRaw,strict:!0}}}return b}),h={};for(const b of m)b.type==="function"&&(h[b.function.name||b.function.function.name]=b.function);const N="tools"in t?m.map(b=>b.type==="function"?{type:"function",function:{name:b.function.name||b.function.function.name,parameters:b.function.parameters,description:b.function.description,strict:b.function.strict}}:b):void 0;for(const b of t.messages)this._addMessage(b,!1);for(let b=0;b<c;++b){const g=(await this._createChatCompletion(e,{...l,tool_choice:i,tools:N,messages:[...this.messages]},r)).choices[0]?.message;if(!g)throw new O("missing message in ChatCompletion response");if(!g.tool_calls?.length)return;for(const v of g.tool_calls){if(v.type!=="function")continue;const x=v.id,{name:y,arguments:d}=v.function,w=h[y];if(w){if(u&&u!==y){const C=`Invalid tool_call: ${JSON.stringify(y)}. ${JSON.stringify(u)} requested. Please try again`;this._addMessage({role:n,tool_call_id:x,content:C});continue}}else{const C=`Invalid tool_call: ${JSON.stringify(y)}. Available options are: ${Object.keys(h).map(E=>JSON.stringify(E)).join(", ")}. Please try again`;this._addMessage({role:n,tool_call_id:x,content:C});continue}let _;try{_=cn(w)?await w.parse(d):d}catch(C){const E=C instanceof Error?C.message:String(C);this._addMessage({role:n,tool_call_id:x,content:E});continue}const M=await w.function(_,this),p=ce(this,ne,"m",Ur).call(this,M);if(this._addMessage({role:n,tool_call_id:x,content:p}),u)return}}}}ne=new WeakSet,Fr=function(){return ce(this,ne,"m",Ms).call(this).content??null},Ms=function(){let e=this.messages.length;for(;e-- >0;){const t=this.messages[e];if(yt(t)){const{function_call:r,...n}=t,i={...n,content:t.content??null,refusal:t.refusal??null};return r&&(i.function_call=r),i}}throw new O("stream ended without producing a ChatCompletionMessage with role=assistant")},Br=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(yt(t)&&t?.function_call)return t.function_call;if(yt(t)&&t?.tool_calls?.length)return t.tool_calls.at(-1)?.function}},$r=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(qi(t)&&t.content!=null||Gi(t)&&t.content!=null&&typeof t.content=="string"&&this.messages.some(r=>r.role==="assistant"&&r.tool_calls?.some(n=>n.type==="function"&&n.id===t.tool_call_id)))return t.content}},Lr=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},Ji=function(e){if(e.n!=null&&e.n>1)throw new O("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},Ur=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class Gt extends Ki{static runFunctions(e,t,r){const n=new Gt,i={...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"runFunctions"}};return n._run(()=>n._runFunctions(e,t,i)),n}static runTools(e,t,r){const n=new Gt,i={...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"runTools"}};return n._run(()=>n._runTools(e,t,i)),n}_addMessage(e,t=!0){super._addMessage(e,t),yt(e)&&e.content&&this._emit("content",e.content)}}const Yi=1,Xi=2,Qi=4,Zi=8,eo=16,to=32,so=64,ro=128,ao=256,no=ro|ao,io=eo|to|no|so,oo=Yi|Xi|io,lo=Qi|Zi,Jc=oo|lo,se={STR:Yi,NUM:Xi,ARR:Qi,OBJ:Zi,NULL:eo,BOOL:to,NAN:so,INFINITY:ro,MINUS_INFINITY:ao,INF:no,SPECIAL:io,ATOM:oo,COLLECTION:lo,ALL:Jc};class Kc extends Error{}class Yc extends Error{}function Xc(a,e=se.ALL){if(typeof a!="string")throw new TypeError(`expecting str, got ${typeof a}`);if(!a.trim())throw new Error(`${a} is empty`);return Qc(a.trim(),e)}const Qc=(a,e)=>{const t=a.length;let r=0;const n=N=>{throw new Kc(`${N} at position ${r}`)},i=N=>{throw new Yc(`${N} at position ${r}`)},o=()=>(h(),r>=t&&n("Unexpected end of input"),a[r]==='"'?l():a[r]==="{"?u():a[r]==="["?c():a.substring(r,r+4)==="null"||se.NULL&e&&t-r<4&&"null".startsWith(a.substring(r))?(r+=4,null):a.substring(r,r+4)==="true"||se.BOOL&e&&t-r<4&&"true".startsWith(a.substring(r))?(r+=4,!0):a.substring(r,r+5)==="false"||se.BOOL&e&&t-r<5&&"false".startsWith(a.substring(r))?(r+=5,!1):a.substring(r,r+8)==="Infinity"||se.INFINITY&e&&t-r<8&&"Infinity".startsWith(a.substring(r))?(r+=8,1/0):a.substring(r,r+9)==="-Infinity"||se.MINUS_INFINITY&e&&1<t-r&&t-r<9&&"-Infinity".startsWith(a.substring(r))?(r+=9,-1/0):a.substring(r,r+3)==="NaN"||se.NAN&e&&t-r<3&&"NaN".startsWith(a.substring(r))?(r+=3,NaN):m()),l=()=>{const N=r;let b=!1;for(r++;r<t&&(a[r]!=='"'||b&&a[r-1]==="\\");)b=a[r]==="\\"?!b:!1,r++;if(a.charAt(r)=='"')try{return JSON.parse(a.substring(N,++r-Number(b)))}catch(f){i(String(f))}else if(se.STR&e)try{return JSON.parse(a.substring(N,r-Number(b))+'"')}catch{return JSON.parse(a.substring(N,a.lastIndexOf("\\"))+'"')}n("Unterminated string literal")},u=()=>{r++,h();const N={};try{for(;a[r]!=="}";){if(h(),r>=t&&se.OBJ&e)return N;const b=l();h(),r++;try{const f=o();Object.defineProperty(N,b,{value:f,writable:!0,enumerable:!0,configurable:!0})}catch(f){if(se.OBJ&e)return N;throw f}h(),a[r]===","&&r++}}catch{if(se.OBJ&e)return N;n("Expected '}' at end of object")}return r++,N},c=()=>{r++;const N=[];try{for(;a[r]!=="]";)N.push(o()),h(),a[r]===","&&r++}catch{if(se.ARR&e)return N;n("Expected ']' at end of array")}return r++,N},m=()=>{if(r===0){a==="-"&&se.NUM&e&&n("Not sure what '-' is");try{return JSON.parse(a)}catch(b){if(se.NUM&e)try{return a[a.length-1]==="."?JSON.parse(a.substring(0,a.lastIndexOf("."))):JSON.parse(a.substring(0,a.lastIndexOf("e")))}catch{}i(String(b))}}const N=r;for(a[r]==="-"&&r++;a[r]&&!",]}".includes(a[r]);)r++;r==t&&!(se.NUM&e)&&n("Unterminated number literal");try{return JSON.parse(a.substring(N,r))}catch{a.substring(N,r)==="-"&&se.NUM&e&&n("Not sure what '-' is");try{return JSON.parse(a.substring(N,a.lastIndexOf("e")))}catch(f){i(String(f))}}},h=()=>{for(;r<t&&` 
\r	`.includes(a[r]);)r++};return o()},un=a=>Xc(a,se.ALL^se.NUM);var ct=globalThis&&globalThis.__classPrivateFieldSet||function(a,e,t,r,n){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?a!==e||!n:!e.has(a))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?n.call(a,t):n?n.value=t:e.set(a,t),t},V=globalThis&&globalThis.__classPrivateFieldGet||function(a,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?a!==e||!r:!e.has(a))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(a):r?r.value:e.get(a)},Q,Re,dt,Fe,ur,ds,mr,hr,gr,us,pr,mn;class Wt extends Ki{constructor(e){super(),Q.add(this),Re.set(this,void 0),dt.set(this,void 0),Fe.set(this,void 0),ct(this,Re,e,"f"),ct(this,dt,[],"f")}get currentChatCompletionSnapshot(){return V(this,Fe,"f")}static fromReadableStream(e){const t=new Wt(null);return t._run(()=>t._fromReadableStream(e)),t}static createChatCompletion(e,t,r){const n=new Wt(t);return n._run(()=>n._runChatCompletion(e,{...t,stream:!0},{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}})),n}async _createChatCompletion(e,t,r){super._createChatCompletion;const n=r?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),V(this,Q,"m",ur).call(this);const i=await e.chat.completions.create({...t,stream:!0},{...r,signal:this.controller.signal});this._connected();for await(const o of i)V(this,Q,"m",mr).call(this,o);if(i.controller.signal?.aborted)throw new fe;return this._addChatCompletion(V(this,Q,"m",us).call(this))}async _fromReadableStream(e,t){const r=t?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),V(this,Q,"m",ur).call(this),this._connected();const n=Ae.fromReadableStream(e,this.controller);let i;for await(const o of n)i&&i!==o.id&&this._addChatCompletion(V(this,Q,"m",us).call(this)),V(this,Q,"m",mr).call(this,o),i=o.id;if(n.controller.signal?.aborted)throw new fe;return this._addChatCompletion(V(this,Q,"m",us).call(this))}[(Re=new WeakMap,dt=new WeakMap,Fe=new WeakMap,Q=new WeakSet,ur=function(){this.ended||ct(this,Fe,void 0,"f")},ds=function(t){let r=V(this,dt,"f")[t.index];return r||(r={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},V(this,dt,"f")[t.index]=r,r)},mr=function(t){if(this.ended)return;const r=V(this,Q,"m",mn).call(this,t);this._emit("chunk",t,r);for(const n of t.choices){const i=r.choices[n.index];n.delta.content!=null&&i.message?.role==="assistant"&&i.message?.content&&(this._emit("content",n.delta.content,i.message.content),this._emit("content.delta",{delta:n.delta.content,snapshot:i.message.content,parsed:i.message.parsed})),n.delta.refusal!=null&&i.message?.role==="assistant"&&i.message?.refusal&&this._emit("refusal.delta",{delta:n.delta.refusal,snapshot:i.message.refusal}),n.logprobs?.content!=null&&i.message?.role==="assistant"&&this._emit("logprobs.content.delta",{content:n.logprobs?.content,snapshot:i.logprobs?.content??[]}),n.logprobs?.refusal!=null&&i.message?.role==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:n.logprobs?.refusal,snapshot:i.logprobs?.refusal??[]});const o=V(this,Q,"m",ds).call(this,i);i.finish_reason&&(V(this,Q,"m",gr).call(this,i),o.current_tool_call_index!=null&&V(this,Q,"m",hr).call(this,i,o.current_tool_call_index));for(const l of n.delta.tool_calls??[])o.current_tool_call_index!==l.index&&(V(this,Q,"m",gr).call(this,i),o.current_tool_call_index!=null&&V(this,Q,"m",hr).call(this,i,o.current_tool_call_index)),o.current_tool_call_index=l.index;for(const l of n.delta.tool_calls??[]){const u=i.message.tool_calls?.[l.index];u?.type&&(u?.type==="function"?this._emit("tool_calls.function.arguments.delta",{name:u.function?.name,index:l.index,arguments:u.function.arguments,parsed_arguments:u.function.parsed_arguments,arguments_delta:l.function?.arguments??""}):(u?.type,void 0))}}},hr=function(t,r){if(V(this,Q,"m",ds).call(this,t).done_tool_calls.has(r))return;const i=t.message.tool_calls?.[r];if(!i)throw new Error("no tool call snapshot");if(!i.type)throw new Error("tool call snapshot missing `type`");if(i.type==="function"){const o=V(this,Re,"f")?.tools?.find(l=>l.type==="function"&&l.function.name===i.function.name);this._emit("tool_calls.function.arguments.done",{name:i.function.name,index:r,arguments:i.function.arguments,parsed_arguments:Yt(o)?o.$parseRaw(i.function.arguments):o?.function.strict?JSON.parse(i.function.arguments):null})}else i.type},gr=function(t){const r=V(this,Q,"m",ds).call(this,t);if(t.message.content&&!r.content_done){r.content_done=!0;const n=V(this,Q,"m",pr).call(this);this._emit("content.done",{content:t.message.content,parsed:n?n.$parseRaw(t.message.content):null})}t.message.refusal&&!r.refusal_done&&(r.refusal_done=!0,this._emit("refusal.done",{refusal:t.message.refusal})),t.logprobs?.content&&!r.logprobs_content_done&&(r.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:t.logprobs.content})),t.logprobs?.refusal&&!r.logprobs_refusal_done&&(r.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:t.logprobs.refusal}))},us=function(){if(this.ended)throw new O("stream has ended, this shouldn't happen");const t=V(this,Fe,"f");if(!t)throw new O("request ended without sending any chunks");return ct(this,Fe,void 0,"f"),ct(this,dt,[],"f"),Zc(t,V(this,Re,"f"))},pr=function(){const t=V(this,Re,"f")?.response_format;return aa(t)?t:null},mn=function(t){var r,n,i,o;let l=V(this,Fe,"f");const{choices:u,...c}=t;l?Object.assign(l,c):l=ct(this,Fe,{...c,choices:[]},"f");for(const{delta:m,finish_reason:h,index:N,logprobs:b=null,...f}of t.choices){let g=l.choices[N];if(g||(g=l.choices[N]={finish_reason:h,index:N,message:{},logprobs:b,...f}),b)if(!g.logprobs)g.logprobs=Object.assign({},b);else{const{content:M,refusal:p,...C}=b;Object.assign(g.logprobs,C),M&&((r=g.logprobs).content??(r.content=[]),g.logprobs.content.push(...M)),p&&((n=g.logprobs).refusal??(n.refusal=[]),g.logprobs.refusal.push(...p))}if(h&&(g.finish_reason=h,V(this,Re,"f")&&Wi(V(this,Re,"f")))){if(h==="length")throw new Ai;if(h==="content_filter")throw new Ei}if(Object.assign(g,f),!m)continue;const{content:v,refusal:x,function_call:y,role:d,tool_calls:w,..._}=m;if(Object.assign(g.message,_),x&&(g.message.refusal=(g.message.refusal||"")+x),d&&(g.message.role=d),y&&(g.message.function_call?(y.name&&(g.message.function_call.name=y.name),y.arguments&&((i=g.message.function_call).arguments??(i.arguments=""),g.message.function_call.arguments+=y.arguments)):g.message.function_call=y),v&&(g.message.content=(g.message.content||"")+v,!g.message.refusal&&V(this,Q,"m",pr).call(this)&&(g.message.parsed=un(g.message.content))),w){g.message.tool_calls||(g.message.tool_calls=[]);for(const{index:M,id:p,type:C,function:E,...A}of w){const R=(o=g.message.tool_calls)[M]??(o[M]={});Object.assign(R,A),p&&(R.id=p),C&&(R.type=C),E&&(R.function??(R.function={name:E.name??"",arguments:""})),E?.name&&(R.function.name=E.name),E?.arguments&&(R.function.arguments+=E.arguments,Gc(V(this,Re,"f"),R)&&(R.function.parsed_arguments=un(R.function.arguments)))}}}return l},Symbol.asyncIterator)](){const e=[],t=[];let r=!1;return this.on("chunk",n=>{const i=t.shift();i?i.resolve(n):e.push(n)}),this.on("end",()=>{r=!0;for(const n of t)n.resolve(void 0);t.length=0}),this.on("abort",n=>{r=!0;for(const i of t)i.reject(n);t.length=0}),this.on("error",n=>{r=!0;for(const i of t)i.reject(n);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,o)=>t.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new Ae(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function Zc(a,e){const{id:t,choices:r,created:n,model:i,system_fingerprint:o,...l}=a,u={...l,id:t,choices:r.map(({message:c,finish_reason:m,index:h,logprobs:N,...b})=>{if(!m)throw new O(`missing finish_reason for choice ${h}`);const{content:f=null,function_call:g,tool_calls:v,...x}=c,y=c.role;if(!y)throw new O(`missing role for choice ${h}`);if(g){const{arguments:d,name:w}=g;if(d==null)throw new O(`missing function_call.arguments for choice ${h}`);if(!w)throw new O(`missing function_call.name for choice ${h}`);return{...b,message:{content:f,function_call:{arguments:d,name:w},role:y,refusal:c.refusal??null},finish_reason:m,index:h,logprobs:N}}return v?{...b,index:h,finish_reason:m,logprobs:N,message:{...x,role:y,content:f,refusal:c.refusal??null,tool_calls:v.map((d,w)=>{const{function:_,type:M,id:p,...C}=d,{arguments:E,name:A,...R}=_||{};if(p==null)throw new O(`missing choices[${h}].tool_calls[${w}].id
${ms(a)}`);if(M==null)throw new O(`missing choices[${h}].tool_calls[${w}].type
${ms(a)}`);if(A==null)throw new O(`missing choices[${h}].tool_calls[${w}].function.name
${ms(a)}`);if(E==null)throw new O(`missing choices[${h}].tool_calls[${w}].function.arguments
${ms(a)}`);return{...C,id:p,type:M,function:{...R,name:A,arguments:E}}})}}:{...b,message:{...x,content:f,role:y,refusal:c.refusal??null},finish_reason:m,index:h,logprobs:N}}),created:n,model:i,object:"chat.completion",...o?{system_fingerprint:o}:{}};return zc(u,e)}function ms(a){return JSON.stringify(a)}class bt extends Wt{static fromReadableStream(e){const t=new bt(null);return t._run(()=>t._fromReadableStream(e)),t}static runFunctions(e,t,r){const n=new bt(null),i={...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"runFunctions"}};return n._run(()=>n._runFunctions(e,t,i)),n}static runTools(e,t,r){const n=new bt(t),i={...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"runTools"}};return n._run(()=>n._runTools(e,t,i)),n}}let co=class extends D{parse(e,t){return Wc(e.tools),this._client.chat.completions.create(e,{...t,headers:{...t?.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap(r=>na(r,e))}runFunctions(e,t){return e.stream?bt.runFunctions(this._client,e,t):Gt.runFunctions(this._client,e,t)}runTools(e,t){return e.stream?bt.runTools(this._client,e,t):Gt.runTools(this._client,e,t)}stream(e,t){return Wt.createChatCompletion(this._client,e,t)}};class Hr extends D{constructor(){super(...arguments),this.completions=new co(this._client)}}(function(a){a.Completions=co})(Hr||(Hr={}));class uo extends D{create(e,t){return this._client.post("/realtime/sessions",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}}class mo extends D{create(e,t){return this._client.post("/realtime/transcription_sessions",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}}class qs extends D{constructor(){super(...arguments),this.sessions=new uo(this._client),this.transcriptionSessions=new mo(this._client)}}qs.Sessions=uo;qs.TranscriptionSessions=mo;class ia extends D{create(e,t,r){return this._client.post(`/threads/${e}/messages`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}retrieve(e,t,r){return this._client.get(`/threads/${e}/messages/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}update(e,t,r,n){return this._client.post(`/threads/${e}/messages/${t}`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}list(e,t={},r){return J(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/messages`,oa,{query:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}del(e,t,r){return this._client.delete(`/threads/${e}/messages/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}}class oa extends ee{}ia.MessagesPage=oa;class la extends D{retrieve(e,t,r,n={},i){return J(n)?this.retrieve(e,t,r,{},n):this._client.get(`/threads/${e}/runs/${t}/steps/${r}`,{query:n,...i,headers:{"OpenAI-Beta":"assistants=v2",...i?.headers}})}list(e,t,r={},n){return J(r)?this.list(e,t,{},r):this._client.getAPIList(`/threads/${e}/runs/${t}/steps`,ca,{query:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}}class ca extends ee{}la.RunStepsPage=ca;let Xt=class extends D{constructor(){super(...arguments),this.steps=new la(this._client)}create(e,t,r){const{include:n,...i}=t;return this._client.post(`/threads/${e}/runs`,{query:{include:n},body:i,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers},stream:t.stream??!1})}retrieve(e,t,r){return this._client.get(`/threads/${e}/runs/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}update(e,t,r,n){return this._client.post(`/threads/${e}/runs/${t}`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}list(e,t={},r){return J(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/runs`,da,{query:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}cancel(e,t,r){return this._client.post(`/threads/${e}/runs/${t}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}async createAndPoll(e,t,r){const n=await this.create(e,t,r);return await this.poll(e,n.id,r)}createAndStream(e,t,r){return we.createAssistantStream(e,this._client.beta.threads.runs,t,r)}async poll(e,t,r){const n={...r?.headers,"X-Stainless-Poll-Helper":"true"};for(r?.pollIntervalMs&&(n["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:i,response:o}=await this.retrieve(e,t,{...r,headers:{...r?.headers,...n}}).withResponse();switch(i.status){case"queued":case"in_progress":case"cancelling":let l=5e3;if(r?.pollIntervalMs)l=r.pollIntervalMs;else{const u=o.headers.get("openai-poll-after-ms");if(u){const c=parseInt(u);isNaN(c)||(l=c)}}await Jt(l);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return i}}}stream(e,t,r){return we.createAssistantStream(e,this._client.beta.threads.runs,t,r)}submitToolOutputs(e,t,r,n){return this._client.post(`/threads/${e}/runs/${t}/submit_tool_outputs`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers},stream:r.stream??!1})}async submitToolOutputsAndPoll(e,t,r,n){const i=await this.submitToolOutputs(e,t,r,n);return await this.poll(e,i.id,n)}submitToolOutputsStream(e,t,r,n){return we.createToolAssistantStream(e,t,this._client.beta.threads.runs,r,n)}};class da extends ee{}Xt.RunsPage=da;Xt.Steps=la;Xt.RunStepsPage=ca;class kt extends D{constructor(){super(...arguments),this.runs=new Xt(this._client),this.messages=new ia(this._client)}create(e={},t){return J(e)?this.create({},e):this._client.post("/threads",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}retrieve(e,t){return this._client.get(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}update(e,t,r){return this._client.post(`/threads/${e}`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}del(e,t){return this._client.delete(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}createAndRun(e,t){return this._client.post("/threads/runs",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers},stream:e.stream??!1})}async createAndRunPoll(e,t){const r=await this.createAndRun(e,t);return await this.runs.poll(r.thread_id,r.id,t)}createAndRunStream(e,t){return we.createThreadAssistantStream(e,this._client.beta.threads,t)}}kt.Runs=Xt;kt.RunsPage=da;kt.Messages=ia;kt.MessagesPage=oa;class _t extends D{constructor(){super(...arguments),this.realtime=new qs(this._client),this.chat=new Hr(this._client),this.assistants=new sa(this._client),this.threads=new kt(this._client)}}_t.Realtime=qs;_t.Assistants=sa;_t.AssistantsPage=ra;_t.Threads=kt;class ho extends D{create(e,t){return this._client.post("/completions",{body:e,...t,stream:e.stream??!1})}}class go extends D{retrieve(e,t,r){return this._client.get(`/containers/${e}/files/${t}/content`,{...r,headers:{Accept:"application/binary",...r?.headers},__binaryResponse:!0})}}let Gs=class extends D{constructor(){super(...arguments),this.content=new go(this._client)}create(e,t,r){return this._client.post(`/containers/${e}/files`,it({body:t,...r}))}retrieve(e,t,r){return this._client.get(`/containers/${e}/files/${t}`,r)}list(e,t={},r){return J(t)?this.list(e,{},t):this._client.getAPIList(`/containers/${e}/files`,ua,{query:t,...r})}del(e,t,r){return this._client.delete(`/containers/${e}/files/${t}`,{...r,headers:{Accept:"*/*",...r?.headers}})}};class ua extends ee{}Gs.FileListResponsesPage=ua;Gs.Content=go;class Qt extends D{constructor(){super(...arguments),this.files=new Gs(this._client)}create(e,t){return this._client.post("/containers",{body:e,...t})}retrieve(e,t){return this._client.get(`/containers/${e}`,t)}list(e={},t){return J(e)?this.list({},e):this._client.getAPIList("/containers",ma,{query:e,...t})}del(e,t){return this._client.delete(`/containers/${e}`,{...t,headers:{Accept:"*/*",...t?.headers}})}}class ma extends ee{}Qt.ContainerListResponsesPage=ma;Qt.Files=Gs;Qt.FileListResponsesPage=ua;class po extends D{create(e,t){const r=!!e.encoding_format;let n=r?e.encoding_format:"base64";r&&qe("Request","User defined encoding_format:",e.encoding_format);const i=this._client.post("/embeddings",{body:{...e,encoding_format:n},...t});return r?i:(qe("response","Decoding base64 embeddings to float32 array"),i._thenUnwrap(o=>(o&&o.data&&o.data.forEach(l=>{const u=l.embedding;l.embedding=Uc(u)}),o)))}}class ha extends D{retrieve(e,t,r,n){return this._client.get(`/evals/${e}/runs/${t}/output_items/${r}`,n)}list(e,t,r={},n){return J(r)?this.list(e,t,{},r):this._client.getAPIList(`/evals/${e}/runs/${t}/output_items`,ga,{query:r,...n})}}class ga extends ee{}ha.OutputItemListResponsesPage=ga;class Zt extends D{constructor(){super(...arguments),this.outputItems=new ha(this._client)}create(e,t,r){return this._client.post(`/evals/${e}/runs`,{body:t,...r})}retrieve(e,t,r){return this._client.get(`/evals/${e}/runs/${t}`,r)}list(e,t={},r){return J(t)?this.list(e,{},t):this._client.getAPIList(`/evals/${e}/runs`,pa,{query:t,...r})}del(e,t,r){return this._client.delete(`/evals/${e}/runs/${t}`,r)}cancel(e,t,r){return this._client.post(`/evals/${e}/runs/${t}`,r)}}class pa extends ee{}Zt.RunListResponsesPage=pa;Zt.OutputItems=ha;Zt.OutputItemListResponsesPage=ga;class es extends D{constructor(){super(...arguments),this.runs=new Zt(this._client)}create(e,t){return this._client.post("/evals",{body:e,...t})}retrieve(e,t){return this._client.get(`/evals/${e}`,t)}update(e,t,r){return this._client.post(`/evals/${e}`,{body:t,...r})}list(e={},t){return J(e)?this.list({},e):this._client.getAPIList("/evals",fa,{query:e,...t})}del(e,t){return this._client.delete(`/evals/${e}`,t)}}class fa extends ee{}es.EvalListResponsesPage=fa;es.Runs=Zt;es.RunListResponsesPage=pa;let xa=class extends D{create(e,t){return this._client.post("/files",it({body:e,...t}))}retrieve(e,t){return this._client.get(`/files/${e}`,t)}list(e={},t){return J(e)?this.list({},e):this._client.getAPIList("/files",ya,{query:e,...t})}del(e,t){return this._client.delete(`/files/${e}`,t)}content(e,t){return this._client.get(`/files/${e}/content`,{...t,headers:{Accept:"application/binary",...t?.headers},__binaryResponse:!0})}retrieveContent(e,t){return this._client.get(`/files/${e}/content`,t)}async waitForProcessing(e,{pollInterval:t=5e3,maxWait:r=30*60*1e3}={}){const n=new Set(["processed","error","deleted"]),i=Date.now();let o=await this.retrieve(e);for(;!o.status||!n.has(o.status);)if(await Jt(t),o=await this.retrieve(e),Date.now()-i>r)throw new Qr({message:`Giving up on waiting for file ${e} to finish processing after ${r} milliseconds.`});return o}};class ya extends ee{}xa.FileObjectsPage=ya;class fo extends D{}let xo=class extends D{run(e,t){return this._client.post("/fine_tuning/alpha/graders/run",{body:e,...t})}validate(e,t){return this._client.post("/fine_tuning/alpha/graders/validate",{body:e,...t})}};class ba extends D{constructor(){super(...arguments),this.graders=new xo(this._client)}}ba.Graders=xo;class wa extends D{create(e,t,r){return this._client.getAPIList(`/fine_tuning/checkpoints/${e}/permissions`,va,{body:t,method:"post",...r})}retrieve(e,t={},r){return J(t)?this.retrieve(e,{},t):this._client.get(`/fine_tuning/checkpoints/${e}/permissions`,{query:t,...r})}del(e,t,r){return this._client.delete(`/fine_tuning/checkpoints/${e}/permissions/${t}`,r)}}class va extends Us{}wa.PermissionCreateResponsesPage=va;let Ws=class extends D{constructor(){super(...arguments),this.permissions=new wa(this._client)}};Ws.Permissions=wa;Ws.PermissionCreateResponsesPage=va;class Na extends D{list(e,t={},r){return J(t)?this.list(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,ja,{query:t,...r})}}class ja extends ee{}Na.FineTuningJobCheckpointsPage=ja;class St extends D{constructor(){super(...arguments),this.checkpoints=new Na(this._client)}create(e,t){return this._client.post("/fine_tuning/jobs",{body:e,...t})}retrieve(e,t){return this._client.get(`/fine_tuning/jobs/${e}`,t)}list(e={},t){return J(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",ka,{query:e,...t})}cancel(e,t){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,t)}listEvents(e,t={},r){return J(t)?this.listEvents(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,_a,{query:t,...r})}pause(e,t){return this._client.post(`/fine_tuning/jobs/${e}/pause`,t)}resume(e,t){return this._client.post(`/fine_tuning/jobs/${e}/resume`,t)}}class ka extends ee{}class _a extends ee{}St.FineTuningJobsPage=ka;St.FineTuningJobEventsPage=_a;St.Checkpoints=Na;St.FineTuningJobCheckpointsPage=ja;class Ge extends D{constructor(){super(...arguments),this.methods=new fo(this._client),this.jobs=new St(this._client),this.checkpoints=new Ws(this._client),this.alpha=new ba(this._client)}}Ge.Methods=fo;Ge.Jobs=St;Ge.FineTuningJobsPage=ka;Ge.FineTuningJobEventsPage=_a;Ge.Checkpoints=Ws;Ge.Alpha=ba;class yo extends D{}class Sa extends D{constructor(){super(...arguments),this.graderModels=new yo(this._client)}}Sa.GraderModels=yo;class bo extends D{createVariation(e,t){return this._client.post("/images/variations",it({body:e,...t}))}edit(e,t){return this._client.post("/images/edits",it({body:e,...t}))}generate(e,t){return this._client.post("/images/generations",{body:e,...t})}}class Ca extends D{retrieve(e,t){return this._client.get(`/models/${e}`,t)}list(e){return this._client.getAPIList("/models",Aa,e)}del(e,t){return this._client.delete(`/models/${e}`,t)}}class Aa extends Us{}Ca.ModelsPage=Aa;class wo extends D{create(e,t){return this._client.post("/moderations",{body:e,...t})}}function ed(a,e){return!e||!sd(e)?{...a,output_parsed:null,output:a.output.map(t=>t.type==="function_call"?{...t,parsed_arguments:null}:t.type==="message"?{...t,content:t.content.map(r=>({...r,parsed:null}))}:t)}:vo(a,e)}function vo(a,e){const t=a.output.map(n=>{if(n.type==="function_call")return{...n,parsed_arguments:nd(e,n)};if(n.type==="message"){const i=n.content.map(o=>o.type==="output_text"?{...o,parsed:td(e,o.text)}:o);return{...n,content:i}}return n}),r=Object.assign({},a,{output:t});return Object.getOwnPropertyDescriptor(a,"output_text")||No(r),Object.defineProperty(r,"output_parsed",{enumerable:!0,get(){for(const n of r.output)if(n.type==="message"){for(const i of n.content)if(i.type==="output_text"&&i.parsed!==null)return i.parsed}return null}}),r}function td(a,e){return a.text?.format?.type!=="json_schema"?null:"$parseRaw"in a.text?.format?(a.text?.format).$parseRaw(e):JSON.parse(e)}function sd(a){return!!aa(a.text?.format)}function rd(a){return a?.$brand==="auto-parseable-tool"}function ad(a,e){return a.find(t=>t.type==="function"&&t.name===e)}function nd(a,e){const t=ad(a.tools??[],e.name);return{...e,...e,parsed_arguments:rd(t)?t.$parseRaw(e.arguments):t?.strict?JSON.parse(e.arguments):null}}function No(a){const e=[];for(const t of a.output)if(t.type==="message")for(const r of t.content)r.type==="output_text"&&e.push(r.text);a.output_text=e.join("")}class jo extends D{list(e,t={},r){return J(t)?this.list(e,{},t):this._client.getAPIList(`/responses/${e}/input_items`,od,{query:t,...r})}}var ut=globalThis&&globalThis.__classPrivateFieldSet||function(a,e,t,r,n){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?a!==e||!n:!e.has(a))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?n.call(a,t):n?n.value=t:e.set(a,t),t},Be=globalThis&&globalThis.__classPrivateFieldGet||function(a,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?a!==e||!r:!e.has(a))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(a):r?r.value:e.get(a)},mt,hs,$e,gs,hn,gn,pn,fn;class Ea extends ta{constructor(e){super(),mt.add(this),hs.set(this,void 0),$e.set(this,void 0),gs.set(this,void 0),ut(this,hs,e,"f")}static createResponse(e,t,r){const n=new Ea(t);return n._run(()=>n._createOrRetrieveResponse(e,t,{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}})),n}async _createOrRetrieveResponse(e,t,r){const n=r?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),Be(this,mt,"m",hn).call(this);let i,o=null;"response_id"in t?(i=await e.responses.retrieve(t.response_id,{stream:!0},{...r,signal:this.controller.signal,stream:!0}),o=t.starting_after??null):i=await e.responses.create({...t,stream:!0},{...r,signal:this.controller.signal}),this._connected();for await(const l of i)Be(this,mt,"m",gn).call(this,l,o);if(i.controller.signal?.aborted)throw new fe;return Be(this,mt,"m",pn).call(this)}[(hs=new WeakMap,$e=new WeakMap,gs=new WeakMap,mt=new WeakSet,hn=function(){this.ended||ut(this,$e,void 0,"f")},gn=function(t,r){if(this.ended)return;const n=(o,l)=>{(r==null||l.sequence_number>r)&&this._emit(o,l)},i=Be(this,mt,"m",fn).call(this,t);switch(n("event",t),t.type){case"response.output_text.delta":{const o=i.output[t.output_index];if(!o)throw new O(`missing output at index ${t.output_index}`);if(o.type==="message"){const l=o.content[t.content_index];if(!l)throw new O(`missing content at index ${t.content_index}`);if(l.type!=="output_text")throw new O(`expected content to be 'output_text', got ${l.type}`);n("response.output_text.delta",{...t,snapshot:l.text})}break}case"response.function_call_arguments.delta":{const o=i.output[t.output_index];if(!o)throw new O(`missing output at index ${t.output_index}`);o.type==="function_call"&&n("response.function_call_arguments.delta",{...t,snapshot:o.arguments});break}default:n(t.type,t);break}},pn=function(){if(this.ended)throw new O("stream has ended, this shouldn't happen");const t=Be(this,$e,"f");if(!t)throw new O("request ended without sending any events");ut(this,$e,void 0,"f");const r=id(t,Be(this,hs,"f"));return ut(this,gs,r,"f"),r},fn=function(t){let r=Be(this,$e,"f");if(!r){if(t.type!=="response.created")throw new O(`When snapshot hasn't been set yet, expected 'response.created' event, got ${t.type}`);return r=ut(this,$e,t.response,"f"),r}switch(t.type){case"response.output_item.added":{r.output.push(t.item);break}case"response.content_part.added":{const n=r.output[t.output_index];if(!n)throw new O(`missing output at index ${t.output_index}`);n.type==="message"&&n.content.push(t.part);break}case"response.output_text.delta":{const n=r.output[t.output_index];if(!n)throw new O(`missing output at index ${t.output_index}`);if(n.type==="message"){const i=n.content[t.content_index];if(!i)throw new O(`missing content at index ${t.content_index}`);if(i.type!=="output_text")throw new O(`expected content to be 'output_text', got ${i.type}`);i.text+=t.delta}break}case"response.function_call_arguments.delta":{const n=r.output[t.output_index];if(!n)throw new O(`missing output at index ${t.output_index}`);n.type==="function_call"&&(n.arguments+=t.delta);break}case"response.completed":{ut(this,$e,t.response,"f");break}}return r},Symbol.asyncIterator)](){const e=[],t=[];let r=!1;return this.on("event",n=>{const i=t.shift();i?i.resolve(n):e.push(n)}),this.on("end",()=>{r=!0;for(const n of t)n.resolve(void 0);t.length=0}),this.on("abort",n=>{r=!0;for(const i of t)i.reject(n);t.length=0}),this.on("error",n=>{r=!0;for(const i of t)i.reject(n);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,o)=>t.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const e=Be(this,gs,"f");if(!e)throw new O("stream ended without producing a ChatCompletion");return e}}function id(a,e){return ed(a,e)}class Ra extends D{constructor(){super(...arguments),this.inputItems=new jo(this._client)}create(e,t){return this._client.post("/responses",{body:e,...t,stream:e.stream??!1})._thenUnwrap(r=>("object"in r&&r.object==="response"&&No(r),r))}retrieve(e,t={},r){return this._client.get(`/responses/${e}`,{query:t,...r,stream:t?.stream??!1})}del(e,t){return this._client.delete(`/responses/${e}`,{...t,headers:{Accept:"*/*",...t?.headers}})}parse(e,t){return this._client.responses.create(e,t)._thenUnwrap(r=>vo(r,e))}stream(e,t){return Ea.createResponse(this._client,e,t)}cancel(e,t){return this._client.post(`/responses/${e}/cancel`,{...t,headers:{Accept:"*/*",...t?.headers}})}}class od extends ee{}Ra.InputItems=jo;class ko extends D{create(e,t,r){return this._client.post(`/uploads/${e}/parts`,it({body:t,...r}))}}class Ta extends D{constructor(){super(...arguments),this.parts=new ko(this._client)}create(e,t){return this._client.post("/uploads",{body:e,...t})}cancel(e,t){return this._client.post(`/uploads/${e}/cancel`,t)}complete(e,t,r){return this._client.post(`/uploads/${e}/complete`,{body:t,...r})}}Ta.Parts=ko;const ld=async a=>{const e=await Promise.allSettled(a),t=e.filter(n=>n.status==="rejected");if(t.length){for(const n of t)console.error(n.reason);throw new Error(`${t.length} promise(s) failed - see the above errors`)}const r=[];for(const n of e)n.status==="fulfilled"&&r.push(n.value);return r};class Js extends D{create(e,t,r){return this._client.post(`/vector_stores/${e}/files`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}retrieve(e,t,r){return this._client.get(`/vector_stores/${e}/files/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}update(e,t,r,n){return this._client.post(`/vector_stores/${e}/files/${t}`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}list(e,t={},r){return J(t)?this.list(e,{},t):this._client.getAPIList(`/vector_stores/${e}/files`,Ks,{query:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}del(e,t,r){return this._client.delete(`/vector_stores/${e}/files/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}async createAndPoll(e,t,r){const n=await this.create(e,t,r);return await this.poll(e,n.id,r)}async poll(e,t,r){const n={...r?.headers,"X-Stainless-Poll-Helper":"true"};for(r?.pollIntervalMs&&(n["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const i=await this.retrieve(e,t,{...r,headers:n}).withResponse(),o=i.data;switch(o.status){case"in_progress":let l=5e3;if(r?.pollIntervalMs)l=r.pollIntervalMs;else{const u=i.response.headers.get("openai-poll-after-ms");if(u){const c=parseInt(u);isNaN(c)||(l=c)}}await Jt(l);break;case"failed":case"completed":return o}}}async upload(e,t,r){const n=await this._client.files.create({file:t,purpose:"assistants"},r);return this.create(e,{file_id:n.id},r)}async uploadAndPoll(e,t,r){const n=await this.upload(e,t,r);return await this.poll(e,n.id,r)}content(e,t,r){return this._client.getAPIList(`/vector_stores/${e}/files/${t}/content`,Ma,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}}class Ks extends ee{}class Ma extends Us{}Js.VectorStoreFilesPage=Ks;Js.FileContentResponsesPage=Ma;class _o extends D{create(e,t,r){return this._client.post(`/vector_stores/${e}/file_batches`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}retrieve(e,t,r){return this._client.get(`/vector_stores/${e}/file_batches/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}cancel(e,t,r){return this._client.post(`/vector_stores/${e}/file_batches/${t}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}async createAndPoll(e,t,r){const n=await this.create(e,t);return await this.poll(e,n.id,r)}listFiles(e,t,r={},n){return J(r)?this.listFiles(e,t,{},r):this._client.getAPIList(`/vector_stores/${e}/file_batches/${t}/files`,Ks,{query:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}async poll(e,t,r){const n={...r?.headers,"X-Stainless-Poll-Helper":"true"};for(r?.pollIntervalMs&&(n["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:i,response:o}=await this.retrieve(e,t,{...r,headers:n}).withResponse();switch(i.status){case"in_progress":let l=5e3;if(r?.pollIntervalMs)l=r.pollIntervalMs;else{const u=o.headers.get("openai-poll-after-ms");if(u){const c=parseInt(u);isNaN(c)||(l=c)}}await Jt(l);break;case"failed":case"cancelled":case"completed":return i}}}async uploadAndPoll(e,{files:t,fileIds:r=[]},n){if(t==null||t.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const i=n?.maxConcurrency??5,o=Math.min(i,t.length),l=this._client,u=t.values(),c=[...r];async function m(N){for(let b of N){const f=await l.files.create({file:b,purpose:"assistants"},n);c.push(f.id)}}const h=Array(o).fill(u).map(m);return await ld(h),await this.createAndPoll(e,{file_ids:c})}}class We extends D{constructor(){super(...arguments),this.files=new Js(this._client),this.fileBatches=new _o(this._client)}create(e,t){return this._client.post("/vector_stores",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}retrieve(e,t){return this._client.get(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}update(e,t,r){return this._client.post(`/vector_stores/${e}`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}list(e={},t){return J(e)?this.list({},e):this._client.getAPIList("/vector_stores",Ia,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}del(e,t){return this._client.delete(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}search(e,t,r){return this._client.getAPIList(`/vector_stores/${e}/search`,Pa,{body:t,method:"post",...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}}class Ia extends ee{}class Pa extends Us{}We.VectorStoresPage=Ia;We.VectorStoreSearchResponsesPage=Pa;We.Files=Js;We.VectorStoreFilesPage=Ks;We.FileContentResponsesPage=Ma;We.FileBatches=_o;var So;class F extends Ec{constructor({baseURL:e=ls("OPENAI_BASE_URL"),apiKey:t=ls("OPENAI_API_KEY"),organization:r=ls("OPENAI_ORG_ID")??null,project:n=ls("OPENAI_PROJECT_ID")??null,...i}={}){if(t===void 0)throw new O("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const o={apiKey:t,organization:r,project:n,...i,baseURL:e||"https://api.openai.com/v1"};if(!o.dangerouslyAllowBrowser&&$c())throw new O(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:o.baseURL,timeout:o.timeout??6e5,httpAgent:o.httpAgent,maxRetries:o.maxRetries,fetch:o.fetch}),this.completions=new ho(this),this.chat=new Vs(this),this.embeddings=new po(this),this.files=new xa(this),this.images=new bo(this),this.audio=new Kt(this),this.moderations=new wo(this),this.models=new Ca(this),this.fineTuning=new Ge(this),this.graders=new Sa(this),this.vectorStores=new We(this),this.beta=new _t(this),this.batches=new Zr(this),this.uploads=new Ta(this),this.responses=new Ra(this),this.evals=new es(this),this.containers=new Qt(this),this._options=o,this.apiKey=t,this.organization=r,this.project=n}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return uc(e,{arrayFormat:"brackets"})}}So=F;F.OpenAI=So;F.DEFAULT_TIMEOUT=6e5;F.OpenAIError=O;F.APIError=ae;F.APIConnectionError=Fs;F.APIConnectionTimeoutError=Qr;F.APIUserAbortError=fe;F.NotFoundError=ji;F.ConflictError=ki;F.RateLimitError=Si;F.BadRequestError=wi;F.AuthenticationError=vi;F.InternalServerError=Ci;F.PermissionDeniedError=Ni;F.UnprocessableEntityError=_i;F.toFile=Ii;F.fileFromPath=xi;F.Completions=ho;F.Chat=Vs;F.ChatCompletionsPage=zs;F.Embeddings=po;F.Files=xa;F.FileObjectsPage=ya;F.Images=bo;F.Audio=Kt;F.Moderations=wo;F.Models=Ca;F.ModelsPage=Aa;F.FineTuning=Ge;F.Graders=Sa;F.VectorStores=We;F.VectorStoresPage=Ia;F.VectorStoreSearchResponsesPage=Pa;F.Beta=_t;F.Batches=Zr;F.BatchesPage=ea;F.Uploads=Ta;F.Responses=Ra;F.Evals=es;F.EvalListResponsesPage=fa;F.Containers=Qt;F.ContainerListResponsesPage=ma;const cd=F;function Co(a,e){return function(){return a.apply(e,arguments)}}const{toString:dd}=Object.prototype,{getPrototypeOf:Oa}=Object,{iterator:Ys,toStringTag:Ao}=Symbol,Xs=(a=>e=>{const t=dd.call(e);return a[t]||(a[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),Ne=a=>(a=a.toLowerCase(),e=>Xs(e)===a),Qs=a=>e=>typeof e===a,{isArray:Ct}=Array,Nt=Qs("undefined");function ts(a){return a!==null&&!Nt(a)&&a.constructor!==null&&!Nt(a.constructor)&&ue(a.constructor.isBuffer)&&a.constructor.isBuffer(a)}const Eo=Ne("ArrayBuffer");function ud(a){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(a):e=a&&a.buffer&&Eo(a.buffer),e}const md=Qs("string"),ue=Qs("function"),Ro=Qs("number"),ss=a=>a!==null&&typeof a=="object",hd=a=>a===!0||a===!1,ks=a=>{if(Xs(a)!=="object")return!1;const e=Oa(a);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Ao in a)&&!(Ys in a)},gd=a=>{if(!ss(a)||ts(a))return!1;try{return Object.keys(a).length===0&&Object.getPrototypeOf(a)===Object.prototype}catch{return!1}},pd=Ne("Date"),fd=Ne("File"),xd=Ne("Blob"),yd=Ne("FileList"),bd=a=>ss(a)&&ue(a.pipe),wd=a=>{let e;return a&&(typeof FormData=="function"&&a instanceof FormData||ue(a.append)&&((e=Xs(a))==="formdata"||e==="object"&&ue(a.toString)&&a.toString()==="[object FormData]"))},vd=Ne("URLSearchParams"),[Nd,jd,kd,_d]=["ReadableStream","Request","Response","Headers"].map(Ne),Sd=a=>a.trim?a.trim():a.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function rs(a,e,{allOwnKeys:t=!1}={}){if(a===null||typeof a>"u")return;let r,n;if(typeof a!="object"&&(a=[a]),Ct(a))for(r=0,n=a.length;r<n;r++)e.call(null,a[r],r,a);else{if(ts(a))return;const i=t?Object.getOwnPropertyNames(a):Object.keys(a),o=i.length;let l;for(r=0;r<o;r++)l=i[r],e.call(null,a[l],l,a)}}function To(a,e){if(ts(a))return null;e=e.toLowerCase();const t=Object.keys(a);let r=t.length,n;for(;r-- >0;)if(n=t[r],e===n.toLowerCase())return n;return null}const rt=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),Mo=a=>!Nt(a)&&a!==rt;function zr(){const{caseless:a,skipUndefined:e}=Mo(this)&&this||{},t={},r=(n,i)=>{const o=a&&To(t,i)||i;ks(t[o])&&ks(n)?t[o]=zr(t[o],n):ks(n)?t[o]=zr({},n):Ct(n)?t[o]=n.slice():(!e||!Nt(n))&&(t[o]=n)};for(let n=0,i=arguments.length;n<i;n++)arguments[n]&&rs(arguments[n],r);return t}const Cd=(a,e,t,{allOwnKeys:r}={})=>(rs(e,(n,i)=>{t&&ue(n)?a[i]=Co(n,t):a[i]=n},{allOwnKeys:r}),a),Ad=a=>(a.charCodeAt(0)===65279&&(a=a.slice(1)),a),Ed=(a,e,t,r)=>{a.prototype=Object.create(e.prototype,r),a.prototype.constructor=a,Object.defineProperty(a,"super",{value:e.prototype}),t&&Object.assign(a.prototype,t)},Rd=(a,e,t,r)=>{let n,i,o;const l={};if(e=e||{},a==null)return e;do{for(n=Object.getOwnPropertyNames(a),i=n.length;i-- >0;)o=n[i],(!r||r(o,a,e))&&!l[o]&&(e[o]=a[o],l[o]=!0);a=t!==!1&&Oa(a)}while(a&&(!t||t(a,e))&&a!==Object.prototype);return e},Td=(a,e,t)=>{a=String(a),(t===void 0||t>a.length)&&(t=a.length),t-=e.length;const r=a.indexOf(e,t);return r!==-1&&r===t},Md=a=>{if(!a)return null;if(Ct(a))return a;let e=a.length;if(!Ro(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=a[e];return t},Id=(a=>e=>a&&e instanceof a)(typeof Uint8Array<"u"&&Oa(Uint8Array)),Pd=(a,e)=>{const r=(a&&a[Ys]).call(a);let n;for(;(n=r.next())&&!n.done;){const i=n.value;e.call(a,i[0],i[1])}},Od=(a,e)=>{let t;const r=[];for(;(t=a.exec(e))!==null;)r.push(t);return r},Dd=Ne("HTMLFormElement"),Fd=a=>a.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,r,n){return r.toUpperCase()+n}),xn=(({hasOwnProperty:a})=>(e,t)=>a.call(e,t))(Object.prototype),Bd=Ne("RegExp"),Io=(a,e)=>{const t=Object.getOwnPropertyDescriptors(a),r={};rs(t,(n,i)=>{let o;(o=e(n,i,a))!==!1&&(r[i]=o||n)}),Object.defineProperties(a,r)},$d=a=>{Io(a,(e,t)=>{if(ue(a)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const r=a[t];if(ue(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},Ld=(a,e)=>{const t={},r=n=>{n.forEach(i=>{t[i]=!0})};return Ct(a)?r(a):r(String(a).split(e)),t},Ud=()=>{},Hd=(a,e)=>a!=null&&Number.isFinite(a=+a)?a:e;function zd(a){return!!(a&&ue(a.append)&&a[Ao]==="FormData"&&a[Ys])}const Vd=a=>{const e=new Array(10),t=(r,n)=>{if(ss(r)){if(e.indexOf(r)>=0)return;if(ts(r))return r;if(!("toJSON"in r)){e[n]=r;const i=Ct(r)?[]:{};return rs(r,(o,l)=>{const u=t(o,n+1);!Nt(u)&&(i[l]=u)}),e[n]=void 0,i}}return r};return t(a,0)},qd=Ne("AsyncFunction"),Gd=a=>a&&(ss(a)||ue(a))&&ue(a.then)&&ue(a.catch),Po=((a,e)=>a?setImmediate:e?((t,r)=>(rt.addEventListener("message",({source:n,data:i})=>{n===rt&&i===t&&r.length&&r.shift()()},!1),n=>{r.push(n),rt.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",ue(rt.postMessage)),Wd=typeof queueMicrotask<"u"?queueMicrotask.bind(rt):typeof process<"u"&&process.nextTick||Po,Jd=a=>a!=null&&ue(a[Ys]),j={isArray:Ct,isArrayBuffer:Eo,isBuffer:ts,isFormData:wd,isArrayBufferView:ud,isString:md,isNumber:Ro,isBoolean:hd,isObject:ss,isPlainObject:ks,isEmptyObject:gd,isReadableStream:Nd,isRequest:jd,isResponse:kd,isHeaders:_d,isUndefined:Nt,isDate:pd,isFile:fd,isBlob:xd,isRegExp:Bd,isFunction:ue,isStream:bd,isURLSearchParams:vd,isTypedArray:Id,isFileList:yd,forEach:rs,merge:zr,extend:Cd,trim:Sd,stripBOM:Ad,inherits:Ed,toFlatObject:Rd,kindOf:Xs,kindOfTest:Ne,endsWith:Td,toArray:Md,forEachEntry:Pd,matchAll:Od,isHTMLForm:Dd,hasOwnProperty:xn,hasOwnProp:xn,reduceDescriptors:Io,freezeMethods:$d,toObjectSet:Ld,toCamelCase:Fd,noop:Ud,toFiniteNumber:Hd,findKey:To,global:rt,isContextDefined:Mo,isSpecCompliantForm:zd,toJSONObject:Vd,isAsyncFn:qd,isThenable:Gd,setImmediate:Po,asap:Wd,isIterable:Jd};function B(a,e,t,r,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=a,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),r&&(this.request=r),n&&(this.response=n,this.status=n.status?n.status:null)}j.inherits(B,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:j.toJSONObject(this.config),code:this.code,status:this.status}}});const Oo=B.prototype,Do={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(a=>{Do[a]={value:a}});Object.defineProperties(B,Do);Object.defineProperty(Oo,"isAxiosError",{value:!0});B.from=(a,e,t,r,n,i)=>{const o=Object.create(Oo);j.toFlatObject(a,o,function(m){return m!==Error.prototype},c=>c!=="isAxiosError");const l=a&&a.message?a.message:"Error",u=e==null&&a?a.code:e;return B.call(o,l,u,t,r,n),a&&o.cause==null&&Object.defineProperty(o,"cause",{value:a,configurable:!0}),o.name=a&&a.name||"Error",i&&Object.assign(o,i),o};const Kd=null;function Vr(a){return j.isPlainObject(a)||j.isArray(a)}function Fo(a){return j.endsWith(a,"[]")?a.slice(0,-2):a}function yn(a,e,t){return a?a.concat(e).map(function(n,i){return n=Fo(n),!t&&i?"["+n+"]":n}).join(t?".":""):e}function Yd(a){return j.isArray(a)&&!a.some(Vr)}const Xd=j.toFlatObject(j,{},null,function(e){return/^is[A-Z]/.test(e)});function Zs(a,e,t){if(!j.isObject(a))throw new TypeError("target must be an object");e=e||new FormData,t=j.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(g,v){return!j.isUndefined(v[g])});const r=t.metaTokens,n=t.visitor||m,i=t.dots,o=t.indexes,u=(t.Blob||typeof Blob<"u"&&Blob)&&j.isSpecCompliantForm(e);if(!j.isFunction(n))throw new TypeError("visitor must be a function");function c(f){if(f===null)return"";if(j.isDate(f))return f.toISOString();if(j.isBoolean(f))return f.toString();if(!u&&j.isBlob(f))throw new B("Blob is not supported. Use a Buffer instead.");return j.isArrayBuffer(f)||j.isTypedArray(f)?u&&typeof Blob=="function"?new Blob([f]):Buffer.from(f):f}function m(f,g,v){let x=f;if(f&&!v&&typeof f=="object"){if(j.endsWith(g,"{}"))g=r?g:g.slice(0,-2),f=JSON.stringify(f);else if(j.isArray(f)&&Yd(f)||(j.isFileList(f)||j.endsWith(g,"[]"))&&(x=j.toArray(f)))return g=Fo(g),x.forEach(function(d,w){!(j.isUndefined(d)||d===null)&&e.append(o===!0?yn([g],w,i):o===null?g:g+"[]",c(d))}),!1}return Vr(f)?!0:(e.append(yn(v,g,i),c(f)),!1)}const h=[],N=Object.assign(Xd,{defaultVisitor:m,convertValue:c,isVisitable:Vr});function b(f,g){if(!j.isUndefined(f)){if(h.indexOf(f)!==-1)throw Error("Circular reference detected in "+g.join("."));h.push(f),j.forEach(f,function(x,y){(!(j.isUndefined(x)||x===null)&&n.call(e,x,j.isString(y)?y.trim():y,g,N))===!0&&b(x,g?g.concat(y):[y])}),h.pop()}}if(!j.isObject(a))throw new TypeError("data must be an object");return b(a),e}function bn(a){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(a).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function Da(a,e){this._pairs=[],a&&Zs(a,this,e)}const Bo=Da.prototype;Bo.append=function(e,t){this._pairs.push([e,t])};Bo.toString=function(e){const t=e?function(r){return e.call(this,r,bn)}:bn;return this._pairs.map(function(n){return t(n[0])+"="+t(n[1])},"").join("&")};function Qd(a){return encodeURIComponent(a).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function $o(a,e,t){if(!e)return a;const r=t&&t.encode||Qd;j.isFunction(t)&&(t={serialize:t});const n=t&&t.serialize;let i;if(n?i=n(e,t):i=j.isURLSearchParams(e)?e.toString():new Da(e,t).toString(r),i){const o=a.indexOf("#");o!==-1&&(a=a.slice(0,o)),a+=(a.indexOf("?")===-1?"?":"&")+i}return a}class Zd{constructor(){this.handlers=[]}use(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){j.forEach(this.handlers,function(r){r!==null&&e(r)})}}const wn=Zd,Lo={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},eu=typeof URLSearchParams<"u"?URLSearchParams:Da,tu=typeof FormData<"u"?FormData:null,su=typeof Blob<"u"?Blob:null,ru={isBrowser:!0,classes:{URLSearchParams:eu,FormData:tu,Blob:su},protocols:["http","https","file","blob","url","data"]},Fa=typeof window<"u"&&typeof document<"u",qr=typeof navigator=="object"&&navigator||void 0,au=Fa&&(!qr||["ReactNative","NativeScript","NS"].indexOf(qr.product)<0),nu=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),iu=Fa&&window.location.href||"http://localhost",ou=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Fa,hasStandardBrowserEnv:au,hasStandardBrowserWebWorkerEnv:nu,navigator:qr,origin:iu},Symbol.toStringTag,{value:"Module"})),ie={...ou,...ru};function lu(a,e){return Zs(a,new ie.classes.URLSearchParams,{visitor:function(t,r,n,i){return ie.isNode&&j.isBuffer(t)?(this.append(r,t.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...e})}function cu(a){return j.matchAll(/\w+|\[(\w*)]/g,a).map(e=>e[0]==="[]"?"":e[1]||e[0])}function du(a){const e={},t=Object.keys(a);let r;const n=t.length;let i;for(r=0;r<n;r++)i=t[r],e[i]=a[i];return e}function Uo(a){function e(t,r,n,i){let o=t[i++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),u=i>=t.length;return o=!o&&j.isArray(n)?n.length:o,u?(j.hasOwnProp(n,o)?n[o]=[n[o],r]:n[o]=r,!l):((!n[o]||!j.isObject(n[o]))&&(n[o]=[]),e(t,r,n[o],i)&&j.isArray(n[o])&&(n[o]=du(n[o])),!l)}if(j.isFormData(a)&&j.isFunction(a.entries)){const t={};return j.forEachEntry(a,(r,n)=>{e(cu(r),n,t,0)}),t}return null}function uu(a,e,t){if(j.isString(a))try{return(e||JSON.parse)(a),j.trim(a)}catch(r){if(r.name!=="SyntaxError")throw r}return(t||JSON.stringify)(a)}const Ba={transitional:Lo,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const r=t.getContentType()||"",n=r.indexOf("application/json")>-1,i=j.isObject(e);if(i&&j.isHTMLForm(e)&&(e=new FormData(e)),j.isFormData(e))return n?JSON.stringify(Uo(e)):e;if(j.isArrayBuffer(e)||j.isBuffer(e)||j.isStream(e)||j.isFile(e)||j.isBlob(e)||j.isReadableStream(e))return e;if(j.isArrayBufferView(e))return e.buffer;if(j.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let l;if(i){if(r.indexOf("application/x-www-form-urlencoded")>-1)return lu(e,this.formSerializer).toString();if((l=j.isFileList(e))||r.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return Zs(l?{"files[]":e}:e,u&&new u,this.formSerializer)}}return i||n?(t.setContentType("application/json",!1),uu(e)):e}],transformResponse:[function(e){const t=this.transitional||Ba.transitional,r=t&&t.forcedJSONParsing,n=this.responseType==="json";if(j.isResponse(e)||j.isReadableStream(e))return e;if(e&&j.isString(e)&&(r&&!this.responseType||n)){const o=!(t&&t.silentJSONParsing)&&n;try{return JSON.parse(e,this.parseReviver)}catch(l){if(o)throw l.name==="SyntaxError"?B.from(l,B.ERR_BAD_RESPONSE,this,null,this.response):l}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ie.classes.FormData,Blob:ie.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};j.forEach(["delete","get","head","post","put","patch"],a=>{Ba.headers[a]={}});const $a=Ba,mu=j.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),hu=a=>{const e={};let t,r,n;return a&&a.split(`
`).forEach(function(o){n=o.indexOf(":"),t=o.substring(0,n).trim().toLowerCase(),r=o.substring(n+1).trim(),!(!t||e[t]&&mu[t])&&(t==="set-cookie"?e[t]?e[t].push(r):e[t]=[r]:e[t]=e[t]?e[t]+", "+r:r)}),e},vn=Symbol("internals");function Rt(a){return a&&String(a).trim().toLowerCase()}function _s(a){return a===!1||a==null?a:j.isArray(a)?a.map(_s):String(a)}function gu(a){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=t.exec(a);)e[r[1]]=r[2];return e}const pu=a=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(a.trim());function fr(a,e,t,r,n){if(j.isFunction(r))return r.call(this,e,t);if(n&&(e=t),!!j.isString(e)){if(j.isString(r))return e.indexOf(r)!==-1;if(j.isRegExp(r))return r.test(e)}}function fu(a){return a.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,r)=>t.toUpperCase()+r)}function xu(a,e){const t=j.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(a,r+t,{value:function(n,i,o){return this[r].call(this,e,n,i,o)},configurable:!0})})}class er{constructor(e){e&&this.set(e)}set(e,t,r){const n=this;function i(l,u,c){const m=Rt(u);if(!m)throw new Error("header name must be a non-empty string");const h=j.findKey(n,m);(!h||n[h]===void 0||c===!0||c===void 0&&n[h]!==!1)&&(n[h||u]=_s(l))}const o=(l,u)=>j.forEach(l,(c,m)=>i(c,m,u));if(j.isPlainObject(e)||e instanceof this.constructor)o(e,t);else if(j.isString(e)&&(e=e.trim())&&!pu(e))o(hu(e),t);else if(j.isObject(e)&&j.isIterable(e)){let l={},u,c;for(const m of e){if(!j.isArray(m))throw TypeError("Object iterator must return a key-value pair");l[c=m[0]]=(u=l[c])?j.isArray(u)?[...u,m[1]]:[u,m[1]]:m[1]}o(l,t)}else e!=null&&i(t,e,r);return this}get(e,t){if(e=Rt(e),e){const r=j.findKey(this,e);if(r){const n=this[r];if(!t)return n;if(t===!0)return gu(n);if(j.isFunction(t))return t.call(this,n,r);if(j.isRegExp(t))return t.exec(n);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=Rt(e),e){const r=j.findKey(this,e);return!!(r&&this[r]!==void 0&&(!t||fr(this,this[r],r,t)))}return!1}delete(e,t){const r=this;let n=!1;function i(o){if(o=Rt(o),o){const l=j.findKey(r,o);l&&(!t||fr(r,r[l],l,t))&&(delete r[l],n=!0)}}return j.isArray(e)?e.forEach(i):i(e),n}clear(e){const t=Object.keys(this);let r=t.length,n=!1;for(;r--;){const i=t[r];(!e||fr(this,this[i],i,e,!0))&&(delete this[i],n=!0)}return n}normalize(e){const t=this,r={};return j.forEach(this,(n,i)=>{const o=j.findKey(r,i);if(o){t[o]=_s(n),delete t[i];return}const l=e?fu(i):String(i).trim();l!==i&&delete t[i],t[l]=_s(n),r[l]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return j.forEach(this,(r,n)=>{r!=null&&r!==!1&&(t[n]=e&&j.isArray(r)?r.join(", "):r)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const r=new this(e);return t.forEach(n=>r.set(n)),r}static accessor(e){const r=(this[vn]=this[vn]={accessors:{}}).accessors,n=this.prototype;function i(o){const l=Rt(o);r[l]||(xu(n,o),r[l]=!0)}return j.isArray(e)?e.forEach(i):i(e),this}}er.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);j.reduceDescriptors(er.prototype,({value:a},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>a,set(r){this[t]=r}}});j.freezeMethods(er);const ve=er;function xr(a,e){const t=this||$a,r=e||t,n=ve.from(r.headers);let i=r.data;return j.forEach(a,function(l){i=l.call(t,i,n.normalize(),e?e.status:void 0)}),n.normalize(),i}function Ho(a){return!!(a&&a.__CANCEL__)}function At(a,e,t){B.call(this,a??"canceled",B.ERR_CANCELED,e,t),this.name="CanceledError"}j.inherits(At,B,{__CANCEL__:!0});function zo(a,e,t){const r=t.config.validateStatus;!t.status||!r||r(t.status)?a(t):e(new B("Request failed with status code "+t.status,[B.ERR_BAD_REQUEST,B.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function yu(a){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(a);return e&&e[1]||""}function bu(a,e){a=a||10;const t=new Array(a),r=new Array(a);let n=0,i=0,o;return e=e!==void 0?e:1e3,function(u){const c=Date.now(),m=r[i];o||(o=c),t[n]=u,r[n]=c;let h=i,N=0;for(;h!==n;)N+=t[h++],h=h%a;if(n=(n+1)%a,n===i&&(i=(i+1)%a),c-o<e)return;const b=m&&c-m;return b?Math.round(N*1e3/b):void 0}}function wu(a,e){let t=0,r=1e3/e,n,i;const o=(c,m=Date.now())=>{t=m,n=null,i&&(clearTimeout(i),i=null),a(...c)};return[(...c)=>{const m=Date.now(),h=m-t;h>=r?o(c,m):(n=c,i||(i=setTimeout(()=>{i=null,o(n)},r-h)))},()=>n&&o(n)]}const Is=(a,e,t=3)=>{let r=0;const n=bu(50,250);return wu(i=>{const o=i.loaded,l=i.lengthComputable?i.total:void 0,u=o-r,c=n(u),m=o<=l;r=o;const h={loaded:o,total:l,progress:l?o/l:void 0,bytes:u,rate:c||void 0,estimated:c&&l&&m?(l-o)/c:void 0,event:i,lengthComputable:l!=null,[e?"download":"upload"]:!0};a(h)},t)},Nn=(a,e)=>{const t=a!=null;return[r=>e[0]({lengthComputable:t,total:a,loaded:r}),e[1]]},jn=a=>(...e)=>j.asap(()=>a(...e)),vu=ie.hasStandardBrowserEnv?((a,e)=>t=>(t=new URL(t,ie.origin),a.protocol===t.protocol&&a.host===t.host&&(e||a.port===t.port)))(new URL(ie.origin),ie.navigator&&/(msie|trident)/i.test(ie.navigator.userAgent)):()=>!0,Nu=ie.hasStandardBrowserEnv?{write(a,e,t,r,n,i){const o=[a+"="+encodeURIComponent(e)];j.isNumber(t)&&o.push("expires="+new Date(t).toGMTString()),j.isString(r)&&o.push("path="+r),j.isString(n)&&o.push("domain="+n),i===!0&&o.push("secure"),document.cookie=o.join("; ")},read(a){const e=document.cookie.match(new RegExp("(^|;\\s*)("+a+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(a){this.write(a,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function ju(a){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(a)}function ku(a,e){return e?a.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):a}function Vo(a,e,t){let r=!ju(e);return a&&(r||t==!1)?ku(a,e):e}const kn=a=>a instanceof ve?{...a}:a;function ot(a,e){e=e||{};const t={};function r(c,m,h,N){return j.isPlainObject(c)&&j.isPlainObject(m)?j.merge.call({caseless:N},c,m):j.isPlainObject(m)?j.merge({},m):j.isArray(m)?m.slice():m}function n(c,m,h,N){if(j.isUndefined(m)){if(!j.isUndefined(c))return r(void 0,c,h,N)}else return r(c,m,h,N)}function i(c,m){if(!j.isUndefined(m))return r(void 0,m)}function o(c,m){if(j.isUndefined(m)){if(!j.isUndefined(c))return r(void 0,c)}else return r(void 0,m)}function l(c,m,h){if(h in e)return r(c,m);if(h in a)return r(void 0,c)}const u={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(c,m,h)=>n(kn(c),kn(m),h,!0)};return j.forEach(Object.keys({...a,...e}),function(m){const h=u[m]||n,N=h(a[m],e[m],m);j.isUndefined(N)&&h!==l||(t[m]=N)}),t}const qo=a=>{const e=ot({},a);let{data:t,withXSRFToken:r,xsrfHeaderName:n,xsrfCookieName:i,headers:o,auth:l}=e;if(e.headers=o=ve.from(o),e.url=$o(Vo(e.baseURL,e.url,e.allowAbsoluteUrls),a.params,a.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),j.isFormData(t)){if(ie.hasStandardBrowserEnv||ie.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(j.isFunction(t.getHeaders)){const u=t.getHeaders(),c=["content-type","content-length"];Object.entries(u).forEach(([m,h])=>{c.includes(m.toLowerCase())&&o.set(m,h)})}}if(ie.hasStandardBrowserEnv&&(r&&j.isFunction(r)&&(r=r(e)),r||r!==!1&&vu(e.url))){const u=n&&i&&Nu.read(i);u&&o.set(n,u)}return e},_u=typeof XMLHttpRequest<"u",Su=_u&&function(a){return new Promise(function(t,r){const n=qo(a);let i=n.data;const o=ve.from(n.headers).normalize();let{responseType:l,onUploadProgress:u,onDownloadProgress:c}=n,m,h,N,b,f;function g(){b&&b(),f&&f(),n.cancelToken&&n.cancelToken.unsubscribe(m),n.signal&&n.signal.removeEventListener("abort",m)}let v=new XMLHttpRequest;v.open(n.method.toUpperCase(),n.url,!0),v.timeout=n.timeout;function x(){if(!v)return;const d=ve.from("getAllResponseHeaders"in v&&v.getAllResponseHeaders()),_={data:!l||l==="text"||l==="json"?v.responseText:v.response,status:v.status,statusText:v.statusText,headers:d,config:a,request:v};zo(function(p){t(p),g()},function(p){r(p),g()},_),v=null}"onloadend"in v?v.onloadend=x:v.onreadystatechange=function(){!v||v.readyState!==4||v.status===0&&!(v.responseURL&&v.responseURL.indexOf("file:")===0)||setTimeout(x)},v.onabort=function(){v&&(r(new B("Request aborted",B.ECONNABORTED,a,v)),v=null)},v.onerror=function(w){const _=w&&w.message?w.message:"Network Error",M=new B(_,B.ERR_NETWORK,a,v);M.event=w||null,r(M),v=null},v.ontimeout=function(){let w=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const _=n.transitional||Lo;n.timeoutErrorMessage&&(w=n.timeoutErrorMessage),r(new B(w,_.clarifyTimeoutError?B.ETIMEDOUT:B.ECONNABORTED,a,v)),v=null},i===void 0&&o.setContentType(null),"setRequestHeader"in v&&j.forEach(o.toJSON(),function(w,_){v.setRequestHeader(_,w)}),j.isUndefined(n.withCredentials)||(v.withCredentials=!!n.withCredentials),l&&l!=="json"&&(v.responseType=n.responseType),c&&([N,f]=Is(c,!0),v.addEventListener("progress",N)),u&&v.upload&&([h,b]=Is(u),v.upload.addEventListener("progress",h),v.upload.addEventListener("loadend",b)),(n.cancelToken||n.signal)&&(m=d=>{v&&(r(!d||d.type?new At(null,a,v):d),v.abort(),v=null)},n.cancelToken&&n.cancelToken.subscribe(m),n.signal&&(n.signal.aborted?m():n.signal.addEventListener("abort",m)));const y=yu(n.url);if(y&&ie.protocols.indexOf(y)===-1){r(new B("Unsupported protocol "+y+":",B.ERR_BAD_REQUEST,a));return}v.send(i||null)})},Cu=(a,e)=>{const{length:t}=a=a?a.filter(Boolean):[];if(e||t){let r=new AbortController,n;const i=function(c){if(!n){n=!0,l();const m=c instanceof Error?c:this.reason;r.abort(m instanceof B?m:new At(m instanceof Error?m.message:m))}};let o=e&&setTimeout(()=>{o=null,i(new B(`timeout ${e} of ms exceeded`,B.ETIMEDOUT))},e);const l=()=>{a&&(o&&clearTimeout(o),o=null,a.forEach(c=>{c.unsubscribe?c.unsubscribe(i):c.removeEventListener("abort",i)}),a=null)};a.forEach(c=>c.addEventListener("abort",i));const{signal:u}=r;return u.unsubscribe=()=>j.asap(l),u}},Au=Cu,Eu=function*(a,e){let t=a.byteLength;if(!e||t<e){yield a;return}let r=0,n;for(;r<t;)n=r+e,yield a.slice(r,n),r=n},Ru=async function*(a,e){for await(const t of Tu(a))yield*Eu(t,e)},Tu=async function*(a){if(a[Symbol.asyncIterator]){yield*a;return}const e=a.getReader();try{for(;;){const{done:t,value:r}=await e.read();if(t)break;yield r}}finally{await e.cancel()}},_n=(a,e,t,r)=>{const n=Ru(a,e);let i=0,o,l=u=>{o||(o=!0,r&&r(u))};return new ReadableStream({async pull(u){try{const{done:c,value:m}=await n.next();if(c){l(),u.close();return}let h=m.byteLength;if(t){let N=i+=h;t(N)}u.enqueue(new Uint8Array(m))}catch(c){throw l(c),c}},cancel(u){return l(u),n.return()}},{highWaterMark:2})},Sn=64*1024,{isFunction:ps}=j,Mu=(({Request:a,Response:e})=>({Request:a,Response:e}))(j.global),{ReadableStream:Cn,TextEncoder:An}=j.global,En=(a,...e)=>{try{return!!a(...e)}catch{return!1}},Iu=a=>{a=j.merge.call({skipUndefined:!0},Mu,a);const{fetch:e,Request:t,Response:r}=a,n=e?ps(e):typeof fetch=="function",i=ps(t),o=ps(r);if(!n)return!1;const l=n&&ps(Cn),u=n&&(typeof An=="function"?(f=>g=>f.encode(g))(new An):async f=>new Uint8Array(await new t(f).arrayBuffer())),c=i&&l&&En(()=>{let f=!1;const g=new t(ie.origin,{body:new Cn,method:"POST",get duplex(){return f=!0,"half"}}).headers.has("Content-Type");return f&&!g}),m=o&&l&&En(()=>j.isReadableStream(new r("").body)),h={stream:m&&(f=>f.body)};n&&["text","arrayBuffer","blob","formData","stream"].forEach(f=>{!h[f]&&(h[f]=(g,v)=>{let x=g&&g[f];if(x)return x.call(g);throw new B(`Response type '${f}' is not supported`,B.ERR_NOT_SUPPORT,v)})});const N=async f=>{if(f==null)return 0;if(j.isBlob(f))return f.size;if(j.isSpecCompliantForm(f))return(await new t(ie.origin,{method:"POST",body:f}).arrayBuffer()).byteLength;if(j.isArrayBufferView(f)||j.isArrayBuffer(f))return f.byteLength;if(j.isURLSearchParams(f)&&(f=f+""),j.isString(f))return(await u(f)).byteLength},b=async(f,g)=>{const v=j.toFiniteNumber(f.getContentLength());return v??N(g)};return async f=>{let{url:g,method:v,data:x,signal:y,cancelToken:d,timeout:w,onDownloadProgress:_,onUploadProgress:M,responseType:p,headers:C,withCredentials:E="same-origin",fetchOptions:A}=qo(f),R=e||fetch;p=p?(p+"").toLowerCase():"text";let P=Au([y,d&&d.toAbortSignal()],w),H=null;const U=P&&P.unsubscribe&&(()=>{P.unsubscribe()});let K;try{if(M&&c&&v!=="get"&&v!=="head"&&(K=await b(C,x))!==0){let te=new t(g,{method:"POST",body:x,duplex:"half"}),lt;if(j.isFormData(x)&&(lt=te.headers.get("content-type"))&&C.setContentType(lt),te.body){const[sr,as]=Nn(K,Is(jn(M)));x=_n(te.body,Sn,sr,as)}}j.isString(E)||(E=E?"include":"omit");const Y=i&&"credentials"in t.prototype,G={...A,signal:P,method:v.toUpperCase(),headers:C.normalize().toJSON(),body:x,duplex:"half",credentials:Y?E:void 0};H=i&&new t(g,G);let z=await(i?R(H,A):R(g,G));const L=m&&(p==="stream"||p==="response");if(m&&(_||L&&U)){const te={};["status","statusText","headers"].forEach(Ha=>{te[Ha]=z[Ha]});const lt=j.toFiniteNumber(z.headers.get("content-length")),[sr,as]=_&&Nn(lt,Is(jn(_),!0))||[];z=new r(_n(z.body,Sn,sr,()=>{as&&as(),U&&U()}),te)}p=p||"text";let Je=await h[j.findKey(h,p)||"text"](z,f);return!L&&U&&U(),await new Promise((te,lt)=>{zo(te,lt,{data:Je,headers:ve.from(z.headers),status:z.status,statusText:z.statusText,config:f,request:H})})}catch(Y){throw U&&U(),Y&&Y.name==="TypeError"&&/Load failed|fetch/i.test(Y.message)?Object.assign(new B("Network Error",B.ERR_NETWORK,f,H),{cause:Y.cause||Y}):B.from(Y,Y&&Y.code,f,H)}}},Pu=new Map,Go=a=>{let e=a?a.env:{};const{fetch:t,Request:r,Response:n}=e,i=[r,n,t];let o=i.length,l=o,u,c,m=Pu;for(;l--;)u=i[l],c=m.get(u),c===void 0&&m.set(u,c=l?new Map:Iu(e)),m=c;return c};Go();const Gr={http:Kd,xhr:Su,fetch:{get:Go}};j.forEach(Gr,(a,e)=>{if(a){try{Object.defineProperty(a,"name",{value:e})}catch{}Object.defineProperty(a,"adapterName",{value:e})}});const Rn=a=>`- ${a}`,Ou=a=>j.isFunction(a)||a===null||a===!1,Wo={getAdapter:(a,e)=>{a=j.isArray(a)?a:[a];const{length:t}=a;let r,n;const i={};for(let o=0;o<t;o++){r=a[o];let l;if(n=r,!Ou(r)&&(n=Gr[(l=String(r)).toLowerCase()],n===void 0))throw new B(`Unknown adapter '${l}'`);if(n&&(j.isFunction(n)||(n=n.get(e))))break;i[l||"#"+o]=n}if(!n){const o=Object.entries(i).map(([u,c])=>`adapter ${u} `+(c===!1?"is not supported by the environment":"is not available in the build"));let l=t?o.length>1?`since :
`+o.map(Rn).join(`
`):" "+Rn(o[0]):"as no adapter specified";throw new B("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return n},adapters:Gr};function yr(a){if(a.cancelToken&&a.cancelToken.throwIfRequested(),a.signal&&a.signal.aborted)throw new At(null,a)}function Tn(a){return yr(a),a.headers=ve.from(a.headers),a.data=xr.call(a,a.transformRequest),["post","put","patch"].indexOf(a.method)!==-1&&a.headers.setContentType("application/x-www-form-urlencoded",!1),Wo.getAdapter(a.adapter||$a.adapter,a)(a).then(function(r){return yr(a),r.data=xr.call(a,a.transformResponse,r),r.headers=ve.from(r.headers),r},function(r){return Ho(r)||(yr(a),r&&r.response&&(r.response.data=xr.call(a,a.transformResponse,r.response),r.response.headers=ve.from(r.response.headers))),Promise.reject(r)})}const Jo="1.12.2",tr={};["object","boolean","number","function","string","symbol"].forEach((a,e)=>{tr[a]=function(r){return typeof r===a||"a"+(e<1?"n ":" ")+a}});const Mn={};tr.transitional=function(e,t,r){function n(i,o){return"[Axios v"+Jo+"] Transitional option '"+i+"'"+o+(r?". "+r:"")}return(i,o,l)=>{if(e===!1)throw new B(n(o," has been removed"+(t?" in "+t:"")),B.ERR_DEPRECATED);return t&&!Mn[o]&&(Mn[o]=!0,console.warn(n(o," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(i,o,l):!0}};tr.spelling=function(e){return(t,r)=>(console.warn(`${r} is likely a misspelling of ${e}`),!0)};function Du(a,e,t){if(typeof a!="object")throw new B("options must be an object",B.ERR_BAD_OPTION_VALUE);const r=Object.keys(a);let n=r.length;for(;n-- >0;){const i=r[n],o=e[i];if(o){const l=a[i],u=l===void 0||o(l,i,a);if(u!==!0)throw new B("option "+i+" must be "+u,B.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new B("Unknown option "+i,B.ERR_BAD_OPTION)}}const Ss={assertOptions:Du,validators:tr},ke=Ss.validators;class Ps{constructor(e){this.defaults=e||{},this.interceptors={request:new wn,response:new wn}}async request(e,t){try{return await this._request(e,t)}catch(r){if(r instanceof Error){let n={};Error.captureStackTrace?Error.captureStackTrace(n):n=new Error;const i=n.stack?n.stack.replace(/^.+\n/,""):"";try{r.stack?i&&!String(r.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+i):r.stack=i}catch{}}throw r}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=ot(this.defaults,t);const{transitional:r,paramsSerializer:n,headers:i}=t;r!==void 0&&Ss.assertOptions(r,{silentJSONParsing:ke.transitional(ke.boolean),forcedJSONParsing:ke.transitional(ke.boolean),clarifyTimeoutError:ke.transitional(ke.boolean)},!1),n!=null&&(j.isFunction(n)?t.paramsSerializer={serialize:n}:Ss.assertOptions(n,{encode:ke.function,serialize:ke.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),Ss.assertOptions(t,{baseUrl:ke.spelling("baseURL"),withXsrfToken:ke.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let o=i&&j.merge(i.common,i[t.method]);i&&j.forEach(["delete","get","head","post","put","patch","common"],f=>{delete i[f]}),t.headers=ve.concat(o,i);const l=[];let u=!0;this.interceptors.request.forEach(function(g){typeof g.runWhen=="function"&&g.runWhen(t)===!1||(u=u&&g.synchronous,l.unshift(g.fulfilled,g.rejected))});const c=[];this.interceptors.response.forEach(function(g){c.push(g.fulfilled,g.rejected)});let m,h=0,N;if(!u){const f=[Tn.bind(this),void 0];for(f.unshift(...l),f.push(...c),N=f.length,m=Promise.resolve(t);h<N;)m=m.then(f[h++],f[h++]);return m}N=l.length;let b=t;for(;h<N;){const f=l[h++],g=l[h++];try{b=f(b)}catch(v){g.call(this,v);break}}try{m=Tn.call(this,b)}catch(f){return Promise.reject(f)}for(h=0,N=c.length;h<N;)m=m.then(c[h++],c[h++]);return m}getUri(e){e=ot(this.defaults,e);const t=Vo(e.baseURL,e.url,e.allowAbsoluteUrls);return $o(t,e.params,e.paramsSerializer)}}j.forEach(["delete","get","head","options"],function(e){Ps.prototype[e]=function(t,r){return this.request(ot(r||{},{method:e,url:t,data:(r||{}).data}))}});j.forEach(["post","put","patch"],function(e){function t(r){return function(i,o,l){return this.request(ot(l||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:i,data:o}))}}Ps.prototype[e]=t(),Ps.prototype[e+"Form"]=t(!0)});const Cs=Ps;class La{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(i){t=i});const r=this;this.promise.then(n=>{if(!r._listeners)return;let i=r._listeners.length;for(;i-- >0;)r._listeners[i](n);r._listeners=null}),this.promise.then=n=>{let i;const o=new Promise(l=>{r.subscribe(l),i=l}).then(n);return o.cancel=function(){r.unsubscribe(i)},o},e(function(i,o,l){r.reason||(r.reason=new At(i,o,l),t(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=r=>{e.abort(r)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new La(function(n){e=n}),cancel:e}}}const Fu=La;function Bu(a){return function(t){return a.apply(null,t)}}function $u(a){return j.isObject(a)&&a.isAxiosError===!0}const Wr={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Wr).forEach(([a,e])=>{Wr[e]=a});const Lu=Wr;function Ko(a){const e=new Cs(a),t=Co(Cs.prototype.request,e);return j.extend(t,Cs.prototype,e,{allOwnKeys:!0}),j.extend(t,e,null,{allOwnKeys:!0}),t.create=function(n){return Ko(ot(a,n))},t}const X=Ko($a);X.Axios=Cs;X.CanceledError=At;X.CancelToken=Fu;X.isCancel=Ho;X.VERSION=Jo;X.toFormData=Zs;X.AxiosError=B;X.Cancel=X.CanceledError;X.all=function(e){return Promise.all(e)};X.spread=Bu;X.isAxiosError=$u;X.mergeConfig=ot;X.AxiosHeaders=ve;X.formToJSON=a=>Uo(j.isHTMLForm(a)?new FormData(a):a);X.getAdapter=Wo.getAdapter;X.HttpStatusCode=Lu;X.default=X;const Uu=X;class br{static NUTRIENTS={protein:{nutrient:"Protein",function:"Essential for muscle synthesis, enzyme production, hormone regulation, and immune function",sources:["Quinoa","Lentils","Chickpeas","Tempeh","Hemp seeds","Chia seeds","Spirulina","Greek yogurt","Eggs","Fish"],dailyValue:{male:56,female:46,unit:"g"},deficiency:["Muscle wasting","Weak immune system","Hair loss","Edema","Fatigue"],excess:["Kidney stress","Dehydration","Bone loss"],molecularBenefits:["Provides 9 essential amino acids","Supports collagen synthesis","Enhances neurotransmitter production"],absorptionFactors:["Vitamin C enhances iron absorption","Consume with complex carbohydrates","Avoid excessive fiber during meals"]},iron:{nutrient:"Iron",function:"Critical for oxygen transport, energy production, and cognitive function",sources:["Spinach","Lentils","Quinoa","Dark chocolate","Pumpkin seeds","Beans","Fortified cereals","Red meat"],dailyValue:{male:8,female:18,unit:"mg"},deficiency:["Anemia","Fatigue","Cognitive impairment","Cold intolerance","Brittle nails"],excess:["Organ damage","Oxidative stress","Constipation"],molecularBenefits:["Forms hemoglobin for oxygen transport","Supports mitochondrial function","Essential for DNA synthesis"],absorptionFactors:["Vitamin C increases absorption 6x","Avoid calcium and tannins","Heme iron (animal sources) more bioavailable"]},vitaminC:{nutrient:"Vitamin C",function:"Powerful antioxidant, collagen synthesis, immune support, and iron absorption",sources:["Citrus fruits","Bell peppers","Strawberries","Broccoli","Kiwi","Papaya","Brussels sprouts"],dailyValue:{male:90,female:75,unit:"mg"},deficiency:["Scurvy","Poor wound healing","Bleeding gums","Fatigue","Joint pain"],excess:["Diarrhea","Kidney stones","Iron overload"],molecularBenefits:["Regenerates vitamin E","Synthesizes collagen","Enhances iron absorption","Supports neurotransmitter synthesis"],absorptionFactors:["Heat sensitive - consume raw","Water soluble - excess excreted","Smoking increases requirements"]},omega3:{nutrient:"Omega-3 Fatty Acids",function:"Anti-inflammatory, brain health, heart protection, and joint mobility",sources:["Flaxseeds","Chia seeds","Walnuts","Hemp seeds","Algae oil","Fatty fish","Seaweed"],dailyValue:{male:1.6,female:1.1,unit:"g"},deficiency:["Inflammation","Depression","Poor memory","Dry skin","Joint pain"],excess:["Bleeding risk","Immune suppression"],molecularBenefits:["Reduces inflammatory cytokines","Supports brain cell membranes","Regulates gene expression"],absorptionFactors:["Consume with healthy fats","Avoid high heat cooking","Balance with omega-6"]},magnesium:{nutrient:"Magnesium",function:"Muscle relaxation, energy production, bone health, and stress management",sources:["Spinach","Pumpkin seeds","Almonds","Black beans","Quinoa","Dark chocolate","Avocado"],dailyValue:{male:420,female:320,unit:"mg"},deficiency:["Muscle cramps","Anxiety","Insomnia","High blood pressure","Osteoporosis"],excess:["Diarrhea","Nausea","Low blood pressure"],molecularBenefits:["Activates 300+ enzymes","Supports ATP production","Regulates calcium channels"],absorptionFactors:["Vitamin D enhances absorption","Avoid excessive calcium","Stress depletes magnesium"]},zinc:{nutrient:"Zinc",function:"Immune function, wound healing, taste perception, and hormone production",sources:["Pumpkin seeds","Hemp seeds","Lentils","Chickpeas","Cashews","Quinoa","Oysters"],dailyValue:{male:11,female:8,unit:"mg"},deficiency:["Weak immunity","Slow healing","Loss of taste","Hair loss","Skin problems"],excess:["Nausea","Copper deficiency","Immune suppression"],molecularBenefits:["Essential for 100+ enzymes","Supports DNA repair","Regulates gene expression"],absorptionFactors:["Phytates reduce absorption","Protein enhances absorption","Avoid excessive iron"]},vitaminB12:{nutrient:"Vitamin B12",function:"Nerve function, red blood cell formation, and DNA synthesis",sources:["Nutritional yeast","Fortified cereals","Algae supplements","Dairy products","Eggs","Meat"],dailyValue:{male:2.4,female:2.4,unit:"mcg"},deficiency:["Pernicious anemia","Neurological damage","Fatigue","Memory problems","Depression"],excess:["Acne","Allergic reactions"],molecularBenefits:["Essential for myelin sheath","Supports neurotransmitter synthesis","Prevents homocysteine buildup"],absorptionFactors:["Requires intrinsic factor","Stomach acid needed","Vegans need supplementation"]},folate:{nutrient:"Folate",function:"DNA synthesis, cell division, and neural tube development",sources:["Dark leafy greens","Lentils","Chickpeas","Asparagus","Avocado","Citrus fruits","Beans"],dailyValue:{male:400,female:400,unit:"mcg"},deficiency:["Megaloblastic anemia","Birth defects","Depression","Cognitive decline"],excess:["Masks B12 deficiency","Seizures"],molecularBenefits:["Essential for DNA methylation","Supports neurotransmitter synthesis","Prevents neural tube defects"],absorptionFactors:["Heat sensitive","Alcohol interferes","Some medications reduce absorption"]},calcium:{nutrient:"Calcium",function:"Bone health, muscle contraction, nerve transmission, and blood clotting",sources:["Kale","Broccoli","Almonds","Sesame seeds","Fortified plant milks","Dairy products","Sardines"],dailyValue:{male:1e3,female:1e3,unit:"mg"},deficiency:["Osteoporosis","Muscle cramps","Numbness","Abnormal heart rhythm"],excess:["Kidney stones","Constipation","Interferes with iron absorption"],molecularBenefits:["Forms hydroxyapatite in bones","Regulates muscle contraction","Supports blood clotting"],absorptionFactors:["Vitamin D essential","Magnesium needed","Avoid excessive phosphorus"]},vitaminD:{nutrient:"Vitamin D",function:"Bone health, immune function, mood regulation, and calcium absorption",sources:["Sunlight","Mushrooms","Fortified foods","Fatty fish","Egg yolks","Supplements"],dailyValue:{male:15,female:15,unit:"mcg"},deficiency:["Rickets","Osteoporosis","Depression","Weak immunity","Muscle weakness"],excess:["Hypercalcemia","Kidney damage","Nausea"],molecularBenefits:["Regulates 200+ genes","Supports immune cell function","Enhances calcium absorption"],absorptionFactors:["Fat-soluble vitamin","Sunlight exposure","Age reduces synthesis"]}};static FOODS={quinoa:{name:"Quinoa",category:"Complete Protein Grain",macronutrients:{protein:8,carbohydrates:39,fat:3.5,fiber:5,calories:222},micronutrients:{iron:2.8,magnesium:118,phosphorus:281,folate:78,zinc:2},molecularCompounds:["Quercetin","Kaempferol","Saponins","Betaine"],healthBenefits:["Complete protein source","Anti-inflammatory","Heart health","Blood sugar control"],preparationTips:["Rinse before cooking","Toast for nutty flavor","Use 2:1 water ratio"],bioavailability:"High - complete amino acid profile with excellent mineral absorption"},lentils:{name:"Lentils",category:"Legume",macronutrients:{protein:18,carbohydrates:40,fat:1,fiber:16,calories:230},micronutrients:{iron:6.6,folate:358,magnesium:71,phosphorus:356,zinc:3.3},molecularCompounds:["Isoflavones","Saponins","Phytic acid","Resistant starch"],healthBenefits:["Heart health","Blood sugar control","Digestive health","Weight management"],preparationTips:["Soak overnight","Add kombu for digestibility","Cook with herbs"],bioavailability:"Good - high protein and minerals, enhanced by vitamin C"},spinach:{name:"Spinach",category:"Dark Leafy Green",macronutrients:{protein:3,carbohydrates:3.6,fat:.4,fiber:2.2,calories:23},micronutrients:{iron:2.7,folate:194,vitaminK:483,vitaminA:469,magnesium:79},molecularCompounds:["Lutein","Zeaxanthin","Nitrates","Chlorophyll","Betaine"],healthBenefits:["Eye health","Bone strength","Heart health","Cognitive function"],preparationTips:["Eat raw or lightly steamed","Pair with vitamin C","Avoid overcooking"],bioavailability:"Moderate - oxalates reduce mineral absorption, enhanced by cooking"},chiaSeeds:{name:"Chia Seeds",category:"Superfood Seed",macronutrients:{protein:4.7,carbohydrates:12,fat:8.6,fiber:10.6,calories:137},micronutrients:{calcium:177,magnesium:95,phosphorus:265,omega3:4.9},molecularCompounds:["Alpha-linolenic acid","Chlorogenic acid","Caffeic acid","Quercetin"],healthBenefits:["Heart health","Blood sugar control","Hydration","Digestive health"],preparationTips:["Soak for gel formation","Grind for better absorption","Store in refrigerator"],bioavailability:"High - excellent omega-3 and mineral content with gel-forming properties"},hempSeeds:{name:"Hemp Seeds",category:"Complete Protein Seed",macronutrients:{protein:9.5,carbohydrates:2.6,fat:14.6,fiber:1.2,calories:161},micronutrients:{magnesium:210,phosphorus:700,zinc:2.4,iron:2.4},molecularCompounds:["Gamma-linolenic acid","Edestin protein","Phytosterols","Chlorophyll"],healthBenefits:["Complete protein","Heart health","Skin health","Hormone balance"],preparationTips:["Eat raw or lightly toasted","Add to smoothies","Store in refrigerator"],bioavailability:"Excellent - complete amino acid profile with optimal omega-6:3 ratio"}};static getLifestyleGuidance(e){const t={vegan:["Focus on complete proteins: quinoa, hemp seeds, chia seeds, and complementary combinations","Ensure B12 supplementation or fortified foods","Pair iron-rich foods with vitamin C for enhanced absorption","Include omega-3 sources: flaxseeds, chia seeds, walnuts, algae oil","Consume calcium-rich foods: kale, broccoli, almonds, fortified plant milks","Consider zinc supplementation or include pumpkin seeds, hemp seeds regularly"],vegetarian:["Include dairy and eggs for complete protein and B12","Focus on plant-based iron sources with vitamin C","Ensure adequate omega-3 from plant sources","Include fermented foods for better nutrient absorption","Consider algae-based omega-3 supplements"],omnivore:["Balance plant and animal proteins for optimal amino acid profile","Include fatty fish for omega-3 fatty acids","Focus on lean proteins and limit processed meats","Ensure adequate fiber from plant sources","Include organ meats occasionally for micronutrients"],keto:["Focus on healthy fats: avocados, nuts, seeds, olive oil","Ensure adequate electrolytes: sodium, potassium, magnesium","Include non-starchy vegetables for micronutrients","Consider MCT oil for ketone production","Monitor protein intake to maintain ketosis"],paleo:["Focus on whole, unprocessed foods","Include grass-fed meats and wild-caught fish","Emphasize vegetables and fruits for micronutrients","Include nuts and seeds for healthy fats","Avoid grains, legumes, and dairy"]};return t[e]||t.omnivore}static getHealthGoalRecommendations(e){const t={muscle_gain:{protein:["Aim for 1.6-2.2g protein per kg body weight","Include complete proteins at each meal","Consider leucine-rich foods for muscle synthesis"],timing:["Consume protein within 2 hours post-workout","Include protein in pre-workout meal","Distribute protein evenly throughout day"],nutrients:["Ensure adequate zinc for testosterone production","Include magnesium for muscle relaxation","Consider creatine supplementation"]},weight_loss:{calories:["Create moderate calorie deficit (500-750 kcal/day)","Focus on nutrient-dense, low-calorie foods","Include fiber for satiety"],macronutrients:["Increase protein to 25-30% of calories","Include healthy fats for hormone production","Choose complex carbohydrates"],timing:["Consider intermittent fasting","Eat protein with each meal","Avoid late-night eating"]},energy_boost:{nutrients:["Ensure adequate iron for oxygen transport","Include B-vitamins for energy metabolism","Consider magnesium for ATP production"],foods:["Include complex carbohydrates for sustained energy","Add nuts and seeds for healthy fats","Stay hydrated"],lifestyle:["Optimize sleep quality","Manage stress levels","Consider adaptogenic herbs"]},mental_clarity:{nutrients:["Include omega-3 fatty acids for brain health","Ensure adequate B12 and folate","Consider choline-rich foods"],foods:["Blueberries for antioxidants","Dark leafy greens for folate","Nuts and seeds for vitamin E"],lifestyle:["Maintain stable blood sugar","Stay hydrated","Consider meditation and exercise"]},immune_support:{nutrients:["Ensure adequate vitamin C and D","Include zinc for immune function","Consider probiotics for gut health"],foods:["Citrus fruits for vitamin C","Mushrooms for vitamin D","Fermented foods for probiotics"],lifestyle:["Manage stress levels","Get adequate sleep","Exercise regularly"]}},r={};return e.forEach(n=>{t[n]&&Object.keys(t[n]).forEach(i=>{r[i]||(r[i]=[]),r[i].push(...t[n][i])})}),r}static getMolecularInsights(e){return{protein:["Proteins are composed of 20 amino acids, 9 of which are essential","Complete proteins contain all essential amino acids in optimal ratios","Protein synthesis requires adequate energy and micronutrients","Amino acids serve as precursors for neurotransmitters and hormones"],iron:["Iron exists in two forms: heme (animal) and non-heme (plant)","Heme iron has 15-35% absorption vs 2-20% for non-heme","Vitamin C can increase non-heme iron absorption by 6-fold","Iron is essential for oxygen transport via hemoglobin and myoglobin"],omega3:["Omega-3 fatty acids are essential for cell membrane fluidity","EPA and DHA are the most bioactive forms","Omega-3s compete with omega-6s for enzyme binding sites","Optimal omega-6:3 ratio is 4:1 or lower"],magnesium:["Magnesium is a cofactor for over 300 enzymatic reactions","It regulates calcium channels and muscle contraction","Stress and exercise increase magnesium requirements","Magnesium deficiency is common due to soil depletion"]}[e]||[]}}class wr{static ADVANCED_NUTRIENTS={vitaminD3:{name:"Vitamin D3 (Cholecalciferol)",category:"vitamin",molecularWeight:384.6,bioavailability:{food_source:60,supplement_form:95,factors_affecting:["fat_consumption","sun_exposure","skin_pigmentation","age"]},interactions:{enhances:["calcium_absorption","magnesium_utilization","immune_function"],inhibits:["vitamin_k_metabolism"],synergizes:["vitamin_k2","magnesium","zinc"]},genetic_variants:[{gene:"VDR",variant:"FokI",impact:"Affects vitamin D receptor function"},{gene:"CYP2R1",variant:"rs10741657",impact:"Influences vitamin D synthesis"}],clinical_evidence:[{study_type:"Meta",strength:"Strong",conclusion:"Reduces respiratory infections by 12-70%"},{study_type:"RCT",strength:"Moderate",conclusion:"May improve mood and cognitive function"}],therapeutic_doses:[{condition:"deficiency",dose_range:"2000-4000 IU/day",duration:"8-12 weeks",contraindications:["hypercalcemia","sarcoidosis"]},{condition:"immune_support",dose_range:"1000-2000 IU/day",duration:"ongoing",contraindications:["kidney_stones"]}]},omega3_epa_dha:{name:"Omega-3 EPA/DHA",category:"macronutrient",molecularWeight:302.5,bioavailability:{food_source:85,supplement_form:95,factors_affecting:["meal_timing","fat_content","oxidation_status"]},interactions:{enhances:["anti_inflammatory_response","brain_function","heart_health"],inhibits:["omega6_inflammation"],synergizes:["vitamin_e","astaxanthin"]},genetic_variants:[{gene:"FADS1",variant:"rs174537",impact:"Affects EPA/DHA conversion efficiency"},{gene:"COX2",variant:"rs5275",impact:"Influences anti-inflammatory response"}],clinical_evidence:[{study_type:"Meta",strength:"Strong",conclusion:"Reduces cardiovascular mortality by 8%"},{study_type:"RCT",strength:"Moderate",conclusion:"May improve depression symptoms"}],therapeutic_doses:[{condition:"heart_health",dose_range:"1000-2000mg EPA+DHA/day",duration:"ongoing",contraindications:["bleeding_disorders"]},{condition:"inflammation",dose_range:"2000-3000mg EPA+DHA/day",duration:"3-6 months",contraindications:["warfarin_therapy"]}]},magnesium_glycinate:{name:"Magnesium Glycinate",category:"mineral",molecularWeight:172.4,bioavailability:{food_source:45,supplement_form:80,factors_affecting:["stress_levels","exercise_intensity","alcohol_consumption"]},interactions:{enhances:["vitamin_d_activation","calcium_absorption","insulin_sensitivity"],inhibits:["calcium_excess"],synergizes:["vitamin_b6","zinc","vitamin_d3"]},genetic_variants:[{gene:"TRPM6",variant:"rs2274924",impact:"Affects magnesium absorption"},{gene:"SLC41A1",variant:"rs823156",impact:"Influences magnesium transport"}],clinical_evidence:[{study_type:"Meta",strength:"Moderate",conclusion:"May reduce blood pressure by 2-3 mmHg"},{study_type:"RCT",strength:"Strong",conclusion:"Improves sleep quality and duration"}],therapeutic_doses:[{condition:"sleep_quality",dose_range:"200-400mg/day",duration:"4-8 weeks",contraindications:["kidney_disease"]},{condition:"muscle_cramps",dose_range:"300-500mg/day",duration:"ongoing",contraindications:["myasthenia_gravis"]}]},curcumin:{name:"Curcumin (Curcuma longa)",category:"phytonutrient",molecularWeight:368.4,bioavailability:{food_source:1,supplement_form:65,factors_affecting:["piperine_addition","fat_content","thermal_processing"]},interactions:{enhances:["anti_inflammatory_response","antioxidant_capacity","neuroprotection"],inhibits:["inflammatory_cytokines"],synergizes:["piperine","quercetin","resveratrol"]},genetic_variants:[{gene:"COX2",variant:"rs5275",impact:"Influences anti-inflammatory response"},{gene:"IL1B",variant:"rs16944",impact:"Affects inflammatory cytokine production"}],clinical_evidence:[{study_type:"Meta",strength:"Strong",conclusion:"Reduces inflammation markers by 25-40%"},{study_type:"RCT",strength:"Moderate",conclusion:"May improve cognitive function in elderly"}],therapeutic_doses:[{condition:"inflammation",dose_range:"500-1000mg/day",duration:"2-3 months",contraindications:["gallbladder_disease"]},{condition:"joint_health",dose_range:"1000-1500mg/day",duration:"ongoing",contraindications:["bleeding_disorders"]}]},probiotics_lactobacillus:{name:"Lactobacillus Probiotics",category:"phytonutrient",molecularWeight:0,bioavailability:{food_source:20,supplement_form:90,factors_affecting:["stomach_acid","antibiotic_use","fiber_intake"]},interactions:{enhances:["immune_function","nutrient_absorption","gut_barrier_integrity"],inhibits:["pathogenic_bacteria"],synergizes:["prebiotic_fiber","vitamin_d","omega3"]},genetic_variants:[{gene:"TLR2",variant:"rs5743708",impact:"Affects probiotic recognition"},{gene:"NOD2",variant:"rs2066844",impact:"Influences gut immune response"}],clinical_evidence:[{study_type:"Meta",strength:"Strong",conclusion:"Reduces antibiotic-associated diarrhea by 42%"},{study_type:"RCT",strength:"Moderate",conclusion:"May improve mood and anxiety"}],therapeutic_doses:[{condition:"gut_health",dose_range:"10-50 billion CFU/day",duration:"4-12 weeks",contraindications:["immunocompromised"]},{condition:"immune_support",dose_range:"20-100 billion CFU/day",duration:"ongoing",contraindications:["central_line"]}]}};static MEAL_TIMING=[{meal_type:"pre_workout",optimal_timing:"1-3 hours before",macronutrient_ratio:{protein:25,carbs:60,fat:15},specific_nutrients:["beta_alanine","creatine","caffeine","nitrates"],molecular_rationale:"Optimizes glycogen stores and provides sustained energy during exercise",food_suggestions:["banana_with_peanut_butter","oatmeal_with_berries","sweet_potato","greek_yogurt"]},{meal_type:"post_workout",optimal_timing:"30-60 minutes after",macronutrient_ratio:{protein:40,carbs:45,fat:15},specific_nutrients:["leucine","whey_protein","fast_carbs","antioxidants"],molecular_rationale:"Maximizes muscle protein synthesis and glycogen replenishment",food_suggestions:["chicken_with_rice","protein_smoothie","quinoa_bowl","salmon_with_sweet_potato"]},{meal_type:"breakfast",optimal_timing:"Within 1 hour of waking",macronutrient_ratio:{protein:30,carbs:50,fat:20},specific_nutrients:["protein","fiber","healthy_fats","b_vitamins"],molecular_rationale:"Breaks overnight fast and stabilizes blood glucose for optimal cognitive function",food_suggestions:["eggs_with_avocado","greek_yogurt_parfait","protein_pancakes","chia_pudding"]}];static CIRCADIAN_NUTRITION=[{time_of_day:"morning_6_10am",metabolic_phase:"catabolic_recovery",optimal_nutrients:["protein","antioxidants","b_vitamins","omega3"],avoid_nutrients:["excessive_sugar","processed_foods"],food_timing_rationale:"Supports cortisol awakening response and metabolic reset"},{time_of_day:"midday_10_2pm",metabolic_phase:"metabolic_peak",optimal_nutrients:["complex_carbs","protein","iron","vitamin_c"],avoid_nutrients:["heavy_fats","excessive_caffeine"],food_timing_rationale:"Aligns with peak insulin sensitivity and digestive capacity"},{time_of_day:"evening_6_10pm",metabolic_phase:"anabolic_recovery",optimal_nutrients:["protein","magnesium","tryptophan","healthy_fats"],avoid_nutrients:["caffeine","sugar","large_meals"],food_timing_rationale:"Supports muscle recovery and prepares for sleep optimization"}];static getAdvancedTrainingPrompt(e,t,r){const n=this.getCircadianInsights(),i=this.getMealTimingInsights(),o=this.getGeneticConsiderations(),l=this.getTherapeuticNutrients(r);return`
You are an advanced molecular nutrition AI with expertise in:
- Nutrigenomics and personalized nutrition
- Circadian biology and meal timing
- Advanced supplement protocols
- Clinical nutrition research
- Bioavailability optimization

USER PROFILE ANALYSIS:
${JSON.stringify(e,null,2)}

CURRENT NUTRITION STATUS:
${JSON.stringify(t,null,2)}

IDENTIFIED DEFICIENCIES: ${r.join(", ")}

ADVANCED NUTRITION INSIGHTS:

CIRCADIAN NUTRITION OPTIMIZATION:
${n}

MEAL TIMING OPTIMIZATION:
${i}

GENETIC CONSIDERATIONS:
${o}

THERAPEUTIC NUTRIENT PROTOCOLS:
${l}

Provide recommendations that include:
1. Personalized nutrient timing based on circadian rhythms
2. Bioavailability optimization strategies
3. Genetic variant considerations
4. Advanced supplement protocols with clinical evidence
5. Meal timing optimization for metabolic health
6. Molecular mechanisms and scientific rationale

Format as JSON with detailed molecular explanations and clinical evidence.
`}static getCircadianInsights(){return this.CIRCADIAN_NUTRITION.map(e=>`
${e.time_of_day.toUpperCase()} (${e.metabolic_phase}):
- Optimal nutrients: ${e.optimal_nutrients.join(", ")}
- Avoid: ${e.avoid_nutrients.join(", ")}
- Rationale: ${e.food_timing_rationale}
`).join(`
`)}static getMealTimingInsights(){return this.MEAL_TIMING.map(e=>`
${e.meal_type.toUpperCase()}:
- Timing: ${e.optimal_timing}
- Macro ratio: P${e.macronutrient_ratio.protein}C${e.macronutrient_ratio.carbs}F${e.macronutrient_ratio.fat}
- Key nutrients: ${e.specific_nutrients.join(", ")}
- Molecular rationale: ${e.molecular_rationale}
- Food suggestions: ${e.food_suggestions.join(", ")}
`).join(`
`)}static getGeneticConsiderations(){return`
Genetic variants affecting nutrition:
- MTHFR: Affects folate metabolism and methylation
- COMT: Influences caffeine and dopamine metabolism
- CYP1A2: Affects caffeine metabolism speed
- FADS1/2: Influences omega-3 conversion efficiency
- VDR: Affects vitamin D receptor function

Consider genetic testing for personalized nutrition optimization.
`}static getTherapeuticNutrients(e){return e.map(r=>{const n=this.ADVANCED_NUTRIENTS[r.toLowerCase()];return n?`
${n.name.toUpperCase()}:
- Bioavailability: ${n.bioavailability.food_source}% (food) vs ${n.bioavailability.supplement_form}% (supplement)
- Key interactions: Enhances ${n.interactions.enhances.join(", ")}
- Clinical evidence: ${n.clinical_evidence.map(i=>`${i.study_type} (${i.strength}): ${i.conclusion}`).join("; ")}
- Therapeutic doses: ${n.therapeutic_doses.map(i=>`${i.condition}: ${i.dose_range}`).join("; ")}
`:""}).filter(Boolean).join(`
`)||"No specific therapeutic protocols identified for current deficiencies."}static getAdvancedNutrientProfile(e){return this.ADVANCED_NUTRIENTS[e.toLowerCase()]||null}static getMealTimingRecommendations(e){return this.MEAL_TIMING.find(t=>t.meal_type===e)||null}static getCircadianNutritionInsights(e){return this.CIRCADIAN_NUTRITION.find(t=>t.time_of_day===e)||null}static getBMIRecommendations(e,t){const r=[];return e<18.5?r.push("Underweight status detected. Focus on nutrient-dense, calorie-rich foods.","Increase healthy fats: avocados, nuts, olive oil, fatty fish.","Prioritize protein: lean meats, legumes, dairy, eggs for muscle building.","Consider smaller, frequent meals to increase caloric intake.","Monitor micronutrient status - underweight individuals often have deficiencies."):e>=18.5&&e<25?r.push("Healthy weight range. Maintain balanced macronutrient distribution.","Focus on nutrient density over calorie density.","Prioritize whole foods, lean proteins, complex carbohydrates.","Maintain regular meal timing for optimal metabolism."):e>=25&&e<30?r.push("Overweight status. Focus on calorie deficit with nutrient density.","Increase fiber intake for satiety: vegetables, fruits, whole grains.","Prioritize lean proteins to preserve muscle mass during weight loss.","Consider intermittent fasting or time-restricted eating.","Monitor portion sizes and meal frequency."):r.push("Obesity status. Comprehensive lifestyle intervention needed.","Significant calorie deficit required with medical supervision.","Focus on high-volume, low-calorie foods: vegetables, lean proteins.","Consider bariatric surgery evaluation if BMI > 40.","Prioritize metabolic health: blood sugar control, inflammation reduction."),t.sex==="female"?r.push("Women may need more iron and folate, especially during reproductive years.","Consider calcium and vitamin D for bone health.","Monitor for PCOS-related insulin resistance if applicable."):t.sex==="male"&&r.push("Men typically need more calories and protein for muscle maintenance.","Monitor for cardiovascular risk factors with higher BMI.","Consider zinc and magnesium for testosterone support."),r}static calculatePersonalizedCalories(e){const t=e.weight/(e.height/100)**2;let r;e.sex==="male"?r=88.362+13.397*e.weight+4.799*e.height-5.677*e.age:r=447.593+9.247*e.weight+3.098*e.height-4.33*e.age;const i=Math.round(r*1.55);let o=Math.round(i*.8),l=Math.round(i*1.1);return t<18.5?(o=Math.round(i*.95),l=Math.round(i*1.2)):t>30&&(o=Math.round(i*.7),l=Math.round(i*1.05)),{maintenance:i,deficit:o,surplus:l}}}const Hu=new cd({baseURL:"https://openrouter.ai/api/v1",apiKey:"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",dangerouslyAllowBrowser:!0}),zu="https://api.edamam.com/api/nutrition-data",In="openai/gpt-4o",Pn="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",vr={"1 cup rice":{calories:205,protein:4.3,carbohydrates:44.5,fat:.4,fiber:.6,iron:.8,calcium:16,vitamin_c:0,vitamin_d:0,vitamin_b12:0,zinc:.8},"100g lentils":{calories:116,protein:9,carbohydrates:20,fat:.4,fiber:7.9,iron:3.3,calcium:19,vitamin_c:1.5,vitamin_d:0,vitamin_b12:0,zinc:1.3},"1 apple":{calories:52,protein:.3,carbohydrates:13.8,fat:.2,fiber:2.4,iron:.1,calcium:6,vitamin_c:4.6,vitamin_d:0,vitamin_b12:0,zinc:.04},"1 banana":{calories:105,protein:1.3,carbohydrates:27,fat:.4,fiber:3,iron:.3,calcium:6,vitamin_c:10.3,vitamin_d:0,vitamin_b12:0,zinc:.2},"1 egg":{calories:70,protein:6,carbohydrates:.6,fat:5,fiber:0,iron:.9,calcium:28,vitamin_c:0,vitamin_d:44,vitamin_b12:.6,zinc:.6},"1 slice bread":{calories:80,protein:3,carbohydrates:15,fat:1,fiber:1,iron:.8,calcium:30,vitamin_c:0,vitamin_d:0,vitamin_b12:0,zinc:.3},chicken:{calories:165,protein:31,carbohydrates:0,fat:3.6,fiber:0,iron:1.3,calcium:15,vitamin_c:0,vitamin_d:0,vitamin_b12:.3,zinc:1},salmon:{calories:208,protein:25,carbohydrates:0,fat:12,fiber:0,iron:.8,calcium:12,vitamin_c:0,vitamin_d:988,vitamin_b12:3.2,zinc:.4},broccoli:{calories:34,protein:2.8,carbohydrates:7,fat:.4,fiber:2.6,iron:.7,calcium:47,vitamin_c:89.2,vitamin_d:0,vitamin_b12:0,zinc:.4},milk:{calories:103,protein:8,carbohydrates:12,fat:2.4,fiber:0,iron:.1,calcium:276,vitamin_c:0,vitamin_d:124,vitamin_b12:1.1,zinc:.9},yogurt:{calories:59,protein:10,carbohydrates:3.6,fat:.4,fiber:0,iron:.1,calcium:110,vitamin_c:0,vitamin_d:0,vitamin_b12:.4,zinc:.5}};class Vu{static async getNutritionData(e){try{console.log("Fetching nutrition data for:",e);const t=e.toLowerCase().trim();let r=null;if(r=vr[t],!r){for(const[n,i]of Object.entries(vr))if(t.includes(n.toLowerCase())||n.toLowerCase().includes(t)){r=i;break}}if(!r){const n=["rice","lentils","apple","banana","egg","bread","chicken","salmon","broccoli","milk","yogurt"];for(const i of n)if(t.includes(i)&&(r=vr[i],r))break}return r?(console.log("Using mock data for:",e),{food:{name:e,nutrients:r}}):In!=="your-app-id"&&Pn!=="your-app-key"?(await Uu.get(zu,{params:{app_id:In,app_key:Pn,ingr:e}})).data:(console.log("Creating fallback nutrition data for:",e),{food:{name:e,nutrients:{calories:100,protein:5,carbohydrates:15,fat:2,fiber:2,iron:1,calcium:50,vitamin_c:10,vitamin_d:0,vitamin_b12:0,zinc:1}}})}catch(t){return console.error("Error fetching nutrition data:",t),{food:{name:e,nutrients:{calories:100,protein:5,carbohydrates:15,fat:2,fiber:2,iron:1,calcium:50,vitamin_c:10,vitamin_d:0,vitamin_b12:0,zinc:1}}}}}static async parseFoodDescription(e){try{console.log("Parsing food description:",e);const t=e.split(/[,;]/).map(n=>n.trim()).filter(Boolean),r=[];for(const n of t){console.log("Processing food item:",n);try{const i=await this.getNutritionData(n);console.log("Nutrition data received:",i);const o=i.food?.nutrients||i.nutrients||i,l=i.food?.name||n,u={id:Math.random().toString(36).substr(2,9),name:l,description:n,quantity:1,unit:"serving",macronutrients:{protein:o.protein||0,carbohydrates:o.carbohydrates||0,fat:o.fat||0,fiber:o.fiber||0,calories:o.calories||0},micronutrients:[{name:"Iron",amount:o.iron||0,unit:"mg",status:"good",category:"mineral"},{name:"Calcium",amount:o.calcium||0,unit:"mg",status:"good",category:"mineral"},{name:"Vitamin C",amount:o.vitamin_c||0,unit:"mg",status:"good",category:"vitamin"},{name:"Vitamin D",amount:o.vitamin_d||0,unit:"IU",status:"good",category:"vitamin"},{name:"Vitamin B12",amount:o.vitamin_b12||0,unit:"mcg",status:"good",category:"vitamin"},{name:"Zinc",amount:o.zinc||0,unit:"mg",status:"good",category:"mineral"}],timestamp:new Date};r.push(u),console.log("Food item created:",u)}catch(i){console.error("Error processing individual food item:",n,i);const o={id:Math.random().toString(36).substr(2,9),name:n,description:n,quantity:1,unit:"serving",macronutrients:{protein:0,carbohydrates:0,fat:0,fiber:0,calories:0},micronutrients:[{name:"Iron",amount:0,unit:"mg",status:"good",category:"mineral"},{name:"Calcium",amount:0,unit:"mg",status:"good",category:"mineral"},{name:"Vitamin C",amount:0,unit:"mg",status:"good",category:"vitamin"},{name:"Vitamin D",amount:0,unit:"IU",status:"good",category:"vitamin"},{name:"Vitamin B12",amount:0,unit:"mcg",status:"good",category:"vitamin"},{name:"Zinc",amount:0,unit:"mg",status:"good",category:"mineral"}],timestamp:new Date};r.push(o)}}return console.log("Final parsed items:",r),r}catch(t){return console.error("Error parsing food description:",t),[{id:Math.random().toString(36).substr(2,9),name:e,description:e,quantity:1,unit:"serving",macronutrients:{protein:0,carbohydrates:0,fat:0,fiber:0,calories:0},micronutrients:[{name:"Iron",amount:0,unit:"mg",status:"good",category:"mineral"},{name:"Calcium",amount:0,unit:"mg",status:"good",category:"mineral"},{name:"Vitamin C",amount:0,unit:"mg",status:"good",category:"vitamin"},{name:"Vitamin D",amount:0,unit:"IU",status:"good",category:"vitamin"},{name:"Vitamin B12",amount:0,unit:"mcg",status:"good",category:"vitamin"},{name:"Zinc",amount:0,unit:"mg",status:"good",category:"mineral"}],timestamp:new Date}]}}}class qu{static async generateRecommendations(e,t,r){try{console.log("=== AI SERVICE: Starting recommendation generation ==="),console.log("API Key available:",!0),console.log("User profile:",e),console.log("Daily intake:",t),console.log("Deficiencies:",r);const n=this.buildRecommendationPrompt(e,t,r);console.log("Generated prompt:",n.substring(0,200)+"...");const o=(await Hu.chat.completions.create({model:"openai/gpt-4o",messages:[{role:"system",content:"You are a molecular nutrition AI expert. Provide personalized, science-based nutrition recommendations. Be specific about food suggestions and explain the molecular benefits."},{role:"user",content:n}],max_tokens:1e3,temperature:.7})).choices[0]?.message?.content||"";console.log("AI Response received:",o.substring(0,200)+"...");const l=this.parseRecommendations(o);return console.log("Parsed recommendations:",l),l}catch(n){return console.error("Error generating AI recommendations:",n),console.log("Falling back to mock recommendations"),this.getMockRecommendations(r)}}static buildRecommendationPrompt(e,t,r){const n=br.getLifestyleGuidance(e.lifestyle),i=br.getHealthGoalRecommendations(e.healthGoals),o=r.map(h=>br.getMolecularInsights(h.toLowerCase())).flat(),l=wr.getAdvancedTrainingPrompt(e,t,r),u=e.weight/(e.height/100)**2,c=wr.getBMIRecommendations(u,e),m=wr.calculatePersonalizedCalories(e);return`
${l}

ADDITIONAL CONTEXT:
You are a molecular nutrition AI expert with deep knowledge of biochemistry, nutrient interactions, and personalized nutrition. Use the following comprehensive knowledge base to provide expert recommendations.

USER PROFILE:
- Name: ${e.name}
- Age: ${e.age} years old
- Sex: ${e.sex}
- Height: ${e.height} cm
- Weight: ${e.weight} kg
- BMI: ${(e.weight/(e.height/100)**2).toFixed(1)}
- Lifestyle: ${e.lifestyle}
- Health Goals: ${e.healthGoals.join(", ")}
- Medical History: ${e.medicalHistory.join(", ")}

CURRENT NUTRITION INTAKE:
- Total Calories: ${t?.totalNutrients?.macronutrients?.find(h=>h.name==="Calories")?.amount||0} kcal
- Protein: ${t?.totalNutrients?.macronutrients?.find(h=>h.name==="Protein")?.amount||0}g
- Carbohydrates: ${t?.totalNutrients?.macronutrients?.find(h=>h.name==="Carbohydrates")?.amount||0}g
- Fat: ${t?.totalNutrients?.macronutrients?.find(h=>h.name==="Fat")?.amount||0}g
- Fiber: ${t?.totalNutrients?.macronutrients?.find(h=>h.name==="Fiber")?.amount||0}g

IDENTIFIED DEFICIENCIES: ${r.join(", ")}

LIFESTYLE-SPECIFIC GUIDANCE FOR ${e.lifestyle.toUpperCase()}:
${n.map(h=>`- ${h}`).join(`
`)}

HEALTH GOAL RECOMMENDATIONS:
${Object.entries(i).map(([h,N])=>`${h.toUpperCase()}:
${N.map(b=>`- ${b}`).join(`
`)}`).join(`

`)}

MOLECULAR NUTRITION INSIGHTS:
${o.slice(0,5).map(h=>`- ${h}`).join(`
`)}

BMI-BASED RECOMMENDATIONS (BMI: ${u.toFixed(1)}):
${c.map(h=>`- ${h}`).join(`
`)}

PERSONALIZED CALORIE NEEDS:
- Maintenance: ${m.maintenance} kcal/day
- Weight Loss: ${m.deficit} kcal/day (20% deficit)
- Weight Gain: ${m.surplus} kcal/day (10% surplus)

COMPREHENSIVE NUTRIENT KNOWLEDGE:
- Protein: Essential for muscle synthesis, enzyme production, hormone regulation. Complete proteins provide all 9 essential amino acids.
- Iron: Critical for oxygen transport via hemoglobin. Vitamin C increases non-heme iron absorption by 6x.
- Omega-3: Anti-inflammatory fatty acids essential for brain health and cell membrane fluidity.
- Magnesium: Cofactor for 300+ enzymatic reactions, supports ATP production and muscle relaxation.
- Vitamin C: Powerful antioxidant, collagen synthesis, enhances iron absorption.
- Zinc: Essential for 100+ enzymes, immune function, wound healing.
- B12: Nerve function, red blood cell formation, requires intrinsic factor for absorption.
- Folate: DNA synthesis, cell division, prevents neural tube defects.

INSTRUCTIONS:
Provide 3-5 highly specific, science-based nutrition recommendations. For each recommendation:

1. TYPE: Choose from food_suggestion, deficiency_alert, optimization_tip, health_insight
2. PRIORITY: high, medium, or low based on urgency and impact
3. TITLE: Clear, actionable title
4. DESCRIPTION: Detailed explanation with molecular benefits and scientific reasoning
5. REASONING: Specific to user's profile, lifestyle, and health goals
6. SUGGESTED_FOODS: Specific foods with serving sizes
7. TARGET_NUTRIENTS: Nutrients being addressed

Focus on:
- Molecular-level explanations of how nutrients work
- Specific food combinations for enhanced absorption
- Lifestyle-appropriate recommendations
- Health goal alignment
- Practical implementation tips

Format as JSON array with exact field names: type, priority, title, description, reasoning, suggestedFoods, targetNutrients
`}static parseRecommendations(e){try{const t=e.match(/\[[\s\S]*\]/);if(t)return JSON.parse(t[0]).map(n=>({id:Math.random().toString(36).substr(2,9),type:n.type||"optimization_tip",priority:n.priority||"medium",title:n.title||"Nutrition Tip",description:n.description||"",reasoning:n.reasoning||"",suggestedFoods:Array.isArray(n.suggestedFoods)?n.suggestedFoods:[],targetNutrients:Array.isArray(n.targetNutrients)?n.targetNutrients:[],createdAt:new Date,isRead:!1}))}catch(t){console.error("Error parsing AI recommendations:",t)}return[{id:Math.random().toString(36).substr(2,9),type:"optimization_tip",priority:"medium",title:"AI Nutrition Insight",description:e.substring(0,200)+"...",reasoning:"Generated by AI analysis of your nutrition profile",suggestedFoods:[],targetNutrients:[],createdAt:new Date,isRead:!1}]}static getMockRecommendations(e){const t=[];return e.includes("Protein")&&t.push({id:Math.random().toString(36).substr(2,9),type:"deficiency_alert",priority:"high",title:"Complete Protein Optimization",description:"Your protein intake is below optimal levels. Proteins provide 9 essential amino acids needed for muscle synthesis, enzyme production, and hormone regulation. Complete proteins contain all essential amino acids in optimal ratios for maximum biological value.",reasoning:"Based on your health goals and current intake, increasing complete protein sources will support muscle maintenance, recovery, and overall cellular function. Protein synthesis requires adequate energy and micronutrients.",suggestedFoods:["Quinoa (1 cup cooked)","Hemp seeds (3 tbsp)","Lentils (1 cup cooked)","Chia seeds (2 tbsp)","Tempeh (4 oz)"],targetNutrients:["Complete Proteins","Essential Amino Acids","Leucine"],createdAt:new Date,isRead:!1}),e.includes("Iron")&&t.push({id:Math.random().toString(36).substr(2,9),type:"deficiency_alert",priority:"high",title:"Iron Absorption Enhancement",description:"Your iron levels are below optimal. Iron is critical for oxygen transport via hemoglobin and myoglobin, energy production in mitochondria, and cognitive function. Non-heme iron from plant sources has 2-20% absorption vs 15-35% for heme iron.",reasoning:"Iron deficiency can lead to fatigue, cognitive impairment, and decreased exercise performance. Vitamin C can increase non-heme iron absorption by 6-fold, while calcium and tannins can inhibit absorption.",suggestedFoods:["Spinach with bell peppers","Lentils with citrus","Quinoa with strawberries","Pumpkin seeds with orange","Dark chocolate (85% cacao)"],targetNutrients:["Iron","Vitamin C","Folate"],createdAt:new Date,isRead:!1}),e.includes("Vitamin C")&&t.push({id:Math.random().toString(36).substr(2,9),type:"optimization_tip",priority:"medium",title:"Antioxidant Power Boost",description:"Vitamin C is a powerful antioxidant that regenerates vitamin E, synthesizes collagen, enhances iron absorption, and supports neurotransmitter synthesis. It's heat-sensitive and water-soluble, so consume raw sources for maximum benefit.",reasoning:"Vitamin C requirements increase with stress, smoking, and exercise. It works synergistically with other antioxidants and is essential for immune function and collagen synthesis.",suggestedFoods:["Bell peppers (raw)","Citrus fruits","Strawberries","Kiwi","Broccoli (lightly steamed)"],targetNutrients:["Vitamin C","Bioflavonoids","Antioxidants"],createdAt:new Date,isRead:!1}),t.push({id:Math.random().toString(36).substr(2,9),type:"health_insight",priority:"medium",title:"Molecular Nutrition Synergy",description:"Nutrients work synergistically at the molecular level. For example, vitamin C enhances iron absorption, magnesium activates vitamin D, and omega-3 fatty acids support the absorption of fat-soluble vitamins. Consider food combinations for optimal bioavailability.",reasoning:"Understanding nutrient interactions helps maximize absorption and biological activity. This is especially important for plant-based diets where bioavailability can be lower.",suggestedFoods:["Quinoa with vegetables","Nuts with berries","Leafy greens with citrus","Seeds with fruits"],targetNutrients:["Synergistic Nutrients","Bioavailability Factors"],createdAt:new Date,isRead:!1}),t.push({id:Math.random().toString(36).substr(2,9),type:"food_suggestion",priority:"low",title:"Superfood Integration",description:"Incorporate nutrient-dense superfoods that provide multiple benefits. Chia seeds offer complete protein, omega-3 fatty acids, and gel-forming fiber. Hemp seeds provide all essential amino acids with optimal omega-6:3 ratio.",reasoning:"Superfoods offer concentrated nutrition with multiple health benefits. They can help fill nutrient gaps while providing unique bioactive compounds.",suggestedFoods:["Chia seeds (soaked)","Hemp seeds (raw)","Spirulina powder","Nutritional yeast","Cacao powder"],targetNutrients:["Complete Proteins","Omega-3 Fatty Acids","Antioxidants","B-Vitamins"],createdAt:new Date,isRead:!1}),t}}class Te{static saveUserProfile(e){console.log("LocalStorageService: Saving profile:",e);try{localStorage.setItem("molecular-nutrition-user",JSON.stringify(e)),console.log("LocalStorageService: Profile saved successfully");const t=localStorage.getItem("molecular-nutrition-user");console.log("LocalStorageService: Verification - saved data:",t)}catch(t){throw console.error("LocalStorageService: Error saving profile:",t),t}}static loadUserProfile(){try{const e=localStorage.getItem("molecular-nutrition-user");return e?JSON.parse(e):null}catch(e){return console.error("Error loading user profile:",e),null}}static saveDailyIntake(e,t){const r=`daily-intake-${e}`;localStorage.setItem(r,JSON.stringify(t))}static loadDailyIntake(e){try{const t=`daily-intake-${e}`,r=localStorage.getItem(t);return r?JSON.parse(r):null}catch(t){return console.error("Error loading daily intake:",t),null}}static saveRecommendations(e){localStorage.setItem("ai-recommendations",JSON.stringify(e))}static loadRecommendations(){try{const e=localStorage.getItem("ai-recommendations");return e?JSON.parse(e):[]}catch(e){return console.error("Error loading recommendations:",e),[]}}}class On{static getMacronutrientTargets(e){const{age:t,sex:r,height:n,weight:i,healthGoals:o}=e;let l;r==="male"?l=88.362+13.397*i+4.799*n-5.677*t:l=447.593+9.247*i+3.098*n-4.33*t;let c=Math.round(l*1.55);o.includes("muscle_gain")&&(c+=300),o.includes("weight_loss")&&(c-=300);const m=i/(n/100)**2;m<18.5?c+=200:m>30&&(c-=400);const h=Math.round(i*1.6),N=h*4,b=c-N,f=Math.round(b*.55/4),g=Math.round(b*.45/9),v=Math.round(i*.4);return[{name:"Calories",amount:c,unit:"kcal",calories:c,status:"good"},{name:"Protein",amount:h,unit:"g",calories:h*4,status:"good"},{name:"Carbohydrates",amount:f,unit:"g",calories:f*4,status:"good"},{name:"Fat",amount:g,unit:"g",calories:g*9,status:"good"},{name:"Fiber",amount:v,unit:"g",calories:0,status:"good"}]}static getMicronutrientTargets(e){const{sex:t,weight:r,lifestyle:n,medicalHistory:i}=e,o=[{name:"Iron",amount:t==="female"?18:8,unit:"mg",status:"good",category:"mineral"},{name:"Calcium",amount:Math.round(r*12.5),unit:"mg",status:"good",category:"mineral"},{name:"Vitamin C",amount:Math.round(r*1.5),unit:"mg",status:"good",category:"vitamin"},{name:"Vitamin D",amount:Math.round(r*8),unit:"IU",status:"good",category:"vitamin"},{name:"Vitamin B12",amount:2.4,unit:"mcg",status:"good",category:"vitamin"},{name:"Zinc",amount:t==="male"?11:8,unit:"mg",status:"good",category:"mineral"},{name:"Magnesium",amount:Math.round(r*5),unit:"mg",status:"good",category:"mineral"},{name:"Folate",amount:400,unit:"mcg",status:"good",category:"vitamin"},{name:"Vitamin A",amount:t==="male"?900:700,unit:"mcg",status:"good",category:"vitamin"},{name:"Vitamin E",amount:Math.round(r*.2),unit:"mg",status:"good",category:"vitamin"}];if(n==="vegan"||n==="vegetarian"){const l=o.find(c=>c.name==="Vitamin B12");l&&(l.amount=2.8);const u=o.find(c=>c.name==="Iron");u&&(u.amount*=1.8)}if(i.includes("diabetes")){const l={name:"Chromium",amount:35,unit:"mcg",status:"good",category:"mineral"};o.push(l)}if(i.includes("cardiovascular")){const l={name:"Omega-3",amount:1e3,unit:"mg",status:"good",category:"fatty_acid"};o.push(l)}return o}}class He{static calculateDailyTotals(e){const t={},r={};e.forEach(o=>{o.foodItems?.forEach(l=>{Object.entries(l.macronutrients||{}).forEach(([u,c])=>{t[u]=(t[u]||0)+c}),l.micronutrients?.forEach(u=>{r[u.name]=(r[u.name]||0)+u.amount})})});const n=Object.entries(t).map(([o,l])=>({name:this.formatNutrientName(o),amount:Math.round(l*10)/10,unit:this.getNutrientUnit(o),calories:o==="Calories"?l:0,status:"good"})),i=Object.entries(r).map(([o,l])=>({name:o,amount:Math.round(l*10)/10,unit:this.getNutrientUnit(o),status:"good",category:this.getNutrientCategory(o)}));return{macronutrients:n,micronutrients:i}}static calculateNutrientStatus(e,t,r){const n=e/t*100;return r==="Calories"||r==="Fat"?n>=90&&n<=110?"excellent":n>=80&&n<=120?"good":n>=70&&n<=130?"warning":n>=60&&n<=140?"poor":"critical":n>=100?"excellent":n>=80?"good":n>=60?"warning":n>=40?"poor":"critical"}static identifyDeficiencies(e,t){const r=[];return t.forEach(n=>{const i=e.find(o=>o.name===n.name);if(i){const o=this.calculateNutrientStatus(i.amount,n.amount,n.name);(o==="poor"||o==="critical")&&r.push(n.name)}else r.push(n.name)}),r}static calculateMolecularBalanceScore(e,t,r){const n=[...e,...t],i=[...r.macronutrients,...r.micronutrients];if(n.length===0)return 0;const o=n.map(l=>{const u=i.find(m=>m.name===l.name);if(!u)return 0;const c=l.amount/u.amount*100;return c>=100?100:c>=80?80+(c-80)*1:c>=60?60+(c-60)*1:c>=40?40+(c-40)*1:Math.max(0,c*1)});return Math.round(o.reduce((l,u)=>l+u,0)/o.length)}static formatNutrientName(e){return{protein:"Protein",carbohydrates:"Carbohydrates",fat:"Fat",fiber:"Fiber",calories:"Calories"}[e]||e}static getNutrientUnit(e){return{protein:"g",carbohydrates:"g",fat:"g",fiber:"g",calories:"kcal",Iron:"mg",Calcium:"mg","Vitamin C":"mg","Vitamin D":"IU","Vitamin B12":"mcg",Zinc:"mg",Magnesium:"mg",Folate:"mcg","Vitamin A":"mcg","Vitamin E":"mg",Chromium:"mcg","Omega-3":"mg"}[e]||"g"}static getNutrientCategory(e){const t=["Vitamin C","Vitamin D","Vitamin B12","Folate","Vitamin A","Vitamin E"],r=["Iron","Calcium","Zinc","Magnesium","Chromium"],n=["Omega-3"];return t.includes(e)?"vitamin":r.includes(e)?"mineral":n.includes(e)?"fatty_acid":"mineral"}}class Gu{static analyzeTrends(e){if(e.length<2)return{overallTrend:"stable",keyInsights:["Insufficient data for trend analysis"],recommendations:["Continue logging meals to get better insights"]};const t=e.slice(-7).map(c=>c.molecularBalanceScore),r=e.slice(-14,-7).map(c=>c.molecularBalanceScore),n=t.reduce((c,m)=>c+m,0)/t.length,i=r.length>0?r.reduce((c,m)=>c+m,0)/r.length:n,o=n>i+5?"improving":n<i-5?"declining":"stable",l=[],u=[];return o==="improving"?(l.push("Your molecular balance score is improving!"),u.push("Keep up the great work with your current nutrition plan")):o==="declining"?(l.push("Your molecular balance score has decreased recently"),u.push("Consider reviewing your meal choices and increasing nutrient-dense foods")):(l.push("Your nutrition balance has been stable"),u.push("Try adding more variety to optimize your nutrient intake")),{overallTrend:o,keyInsights:l,recommendations:u}}}const Ua="-",Wu=a=>{const e=Ku(a),{conflictingClassGroups:t,conflictingClassGroupModifiers:r}=a;return{getClassGroupId:o=>{const l=o.split(Ua);return l[0]===""&&l.length!==1&&l.shift(),Yo(l,e)||Ju(o)},getConflictingClassGroupIds:(o,l)=>{const u=t[o]||[];return l&&r[o]?[...u,...r[o]]:u}}},Yo=(a,e)=>{if(a.length===0)return e.classGroupId;const t=a[0],r=e.nextPart.get(t),n=r?Yo(a.slice(1),r):void 0;if(n)return n;if(e.validators.length===0)return;const i=a.join(Ua);return e.validators.find(({validator:o})=>o(i))?.classGroupId},Dn=/^\[(.+)\]$/,Ju=a=>{if(Dn.test(a)){const e=Dn.exec(a)[1],t=e?.substring(0,e.indexOf(":"));if(t)return"arbitrary.."+t}},Ku=a=>{const{theme:e,prefix:t}=a,r={nextPart:new Map,validators:[]};return Xu(Object.entries(a.classGroups),t).forEach(([i,o])=>{Jr(o,r,i,e)}),r},Jr=(a,e,t,r)=>{a.forEach(n=>{if(typeof n=="string"){const i=n===""?e:Fn(e,n);i.classGroupId=t;return}if(typeof n=="function"){if(Yu(n)){Jr(n(r),e,t,r);return}e.validators.push({validator:n,classGroupId:t});return}Object.entries(n).forEach(([i,o])=>{Jr(o,Fn(e,i),t,r)})})},Fn=(a,e)=>{let t=a;return e.split(Ua).forEach(r=>{t.nextPart.has(r)||t.nextPart.set(r,{nextPart:new Map,validators:[]}),t=t.nextPart.get(r)}),t},Yu=a=>a.isThemeGetter,Xu=(a,e)=>e?a.map(([t,r])=>{const n=r.map(i=>typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([o,l])=>[e+o,l])):i);return[t,n]}):a,Qu=a=>{if(a<1)return{get:()=>{},set:()=>{}};let e=0,t=new Map,r=new Map;const n=(i,o)=>{t.set(i,o),e++,e>a&&(e=0,r=t,t=new Map)};return{get(i){let o=t.get(i);if(o!==void 0)return o;if((o=r.get(i))!==void 0)return n(i,o),o},set(i,o){t.has(i)?t.set(i,o):n(i,o)}}},Xo="!",Zu=a=>{const{separator:e,experimentalParseClassName:t}=a,r=e.length===1,n=e[0],i=e.length,o=l=>{const u=[];let c=0,m=0,h;for(let v=0;v<l.length;v++){let x=l[v];if(c===0){if(x===n&&(r||l.slice(v,v+i)===e)){u.push(l.slice(m,v)),m=v+i;continue}if(x==="/"){h=v;continue}}x==="["?c++:x==="]"&&c--}const N=u.length===0?l:l.substring(m),b=N.startsWith(Xo),f=b?N.substring(1):N,g=h&&h>m?h-m:void 0;return{modifiers:u,hasImportantModifier:b,baseClassName:f,maybePostfixModifierPosition:g}};return t?l=>t({className:l,parseClassName:o}):o},em=a=>{if(a.length<=1)return a;const e=[];let t=[];return a.forEach(r=>{r[0]==="["?(e.push(...t.sort(),r),t=[]):t.push(r)}),e.push(...t.sort()),e},tm=a=>({cache:Qu(a.cacheSize),parseClassName:Zu(a),...Wu(a)}),sm=/\s+/,rm=(a,e)=>{const{parseClassName:t,getClassGroupId:r,getConflictingClassGroupIds:n}=e,i=[],o=a.trim().split(sm);let l="";for(let u=o.length-1;u>=0;u-=1){const c=o[u],{modifiers:m,hasImportantModifier:h,baseClassName:N,maybePostfixModifierPosition:b}=t(c);let f=!!b,g=r(f?N.substring(0,b):N);if(!g){if(!f){l=c+(l.length>0?" "+l:l);continue}if(g=r(N),!g){l=c+(l.length>0?" "+l:l);continue}f=!1}const v=em(m).join(":"),x=h?v+Xo:v,y=x+g;if(i.includes(y))continue;i.push(y);const d=n(g,f);for(let w=0;w<d.length;++w){const _=d[w];i.push(x+_)}l=c+(l.length>0?" "+l:l)}return l};function am(){let a=0,e,t,r="";for(;a<arguments.length;)(e=arguments[a++])&&(t=Qo(e))&&(r&&(r+=" "),r+=t);return r}const Qo=a=>{if(typeof a=="string")return a;let e,t="";for(let r=0;r<a.length;r++)a[r]&&(e=Qo(a[r]))&&(t&&(t+=" "),t+=e);return t};function nm(a,...e){let t,r,n,i=o;function o(u){const c=e.reduce((m,h)=>h(m),a());return t=tm(c),r=t.cache.get,n=t.cache.set,i=l,l(u)}function l(u){const c=r(u);if(c)return c;const m=rm(u,t);return n(u,m),m}return function(){return i(am.apply(null,arguments))}}const q=a=>{const e=t=>t[a]||[];return e.isThemeGetter=!0,e},Zo=/^\[(?:([a-z-]+):)?(.+)\]$/i,im=/^\d+\/\d+$/,om=new Set(["px","full","screen"]),lm=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,cm=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,dm=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,um=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,mm=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Me=a=>wt(a)||om.has(a)||im.test(a),Le=a=>Et(a,"length",wm),wt=a=>!!a&&!Number.isNaN(Number(a)),Nr=a=>Et(a,"number",wt),Tt=a=>!!a&&Number.isInteger(Number(a)),hm=a=>a.endsWith("%")&&wt(a.slice(0,-1)),$=a=>Zo.test(a),Ue=a=>lm.test(a),gm=new Set(["length","size","percentage"]),pm=a=>Et(a,gm,el),fm=a=>Et(a,"position",el),xm=new Set(["image","url"]),ym=a=>Et(a,xm,Nm),bm=a=>Et(a,"",vm),Mt=()=>!0,Et=(a,e,t)=>{const r=Zo.exec(a);return r?r[1]?typeof e=="string"?r[1]===e:e.has(r[1]):t(r[2]):!1},wm=a=>cm.test(a)&&!dm.test(a),el=()=>!1,vm=a=>um.test(a),Nm=a=>mm.test(a),jm=()=>{const a=q("colors"),e=q("spacing"),t=q("blur"),r=q("brightness"),n=q("borderColor"),i=q("borderRadius"),o=q("borderSpacing"),l=q("borderWidth"),u=q("contrast"),c=q("grayscale"),m=q("hueRotate"),h=q("invert"),N=q("gap"),b=q("gradientColorStops"),f=q("gradientColorStopPositions"),g=q("inset"),v=q("margin"),x=q("opacity"),y=q("padding"),d=q("saturate"),w=q("scale"),_=q("sepia"),M=q("skew"),p=q("space"),C=q("translate"),E=()=>["auto","contain","none"],A=()=>["auto","hidden","clip","visible","scroll"],R=()=>["auto",$,e],P=()=>[$,e],H=()=>["",Me,Le],U=()=>["auto",wt,$],K=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],Y=()=>["solid","dashed","dotted","double","none"],G=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],z=()=>["start","end","center","between","around","evenly","stretch"],L=()=>["","0",$],Je=()=>["auto","avoid","all","avoid-page","page","left","right","column"],te=()=>[wt,$];return{cacheSize:500,separator:":",theme:{colors:[Mt],spacing:[Me,Le],blur:["none","",Ue,$],brightness:te(),borderColor:[a],borderRadius:["none","","full",Ue,$],borderSpacing:P(),borderWidth:H(),contrast:te(),grayscale:L(),hueRotate:te(),invert:L(),gap:P(),gradientColorStops:[a],gradientColorStopPositions:[hm,Le],inset:R(),margin:R(),opacity:te(),padding:P(),saturate:te(),scale:te(),sepia:L(),skew:te(),space:P(),translate:P()},classGroups:{aspect:[{aspect:["auto","square","video",$]}],container:["container"],columns:[{columns:[Ue]}],"break-after":[{"break-after":Je()}],"break-before":[{"break-before":Je()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...K(),$]}],overflow:[{overflow:A()}],"overflow-x":[{"overflow-x":A()}],"overflow-y":[{"overflow-y":A()}],overscroll:[{overscroll:E()}],"overscroll-x":[{"overscroll-x":E()}],"overscroll-y":[{"overscroll-y":E()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[g]}],"inset-x":[{"inset-x":[g]}],"inset-y":[{"inset-y":[g]}],start:[{start:[g]}],end:[{end:[g]}],top:[{top:[g]}],right:[{right:[g]}],bottom:[{bottom:[g]}],left:[{left:[g]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Tt,$]}],basis:[{basis:R()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",$]}],grow:[{grow:L()}],shrink:[{shrink:L()}],order:[{order:["first","last","none",Tt,$]}],"grid-cols":[{"grid-cols":[Mt]}],"col-start-end":[{col:["auto",{span:["full",Tt,$]},$]}],"col-start":[{"col-start":U()}],"col-end":[{"col-end":U()}],"grid-rows":[{"grid-rows":[Mt]}],"row-start-end":[{row:["auto",{span:[Tt,$]},$]}],"row-start":[{"row-start":U()}],"row-end":[{"row-end":U()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",$]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",$]}],gap:[{gap:[N]}],"gap-x":[{"gap-x":[N]}],"gap-y":[{"gap-y":[N]}],"justify-content":[{justify:["normal",...z()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...z(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...z(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[y]}],px:[{px:[y]}],py:[{py:[y]}],ps:[{ps:[y]}],pe:[{pe:[y]}],pt:[{pt:[y]}],pr:[{pr:[y]}],pb:[{pb:[y]}],pl:[{pl:[y]}],m:[{m:[v]}],mx:[{mx:[v]}],my:[{my:[v]}],ms:[{ms:[v]}],me:[{me:[v]}],mt:[{mt:[v]}],mr:[{mr:[v]}],mb:[{mb:[v]}],ml:[{ml:[v]}],"space-x":[{"space-x":[p]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[p]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",$,e]}],"min-w":[{"min-w":[$,e,"min","max","fit"]}],"max-w":[{"max-w":[$,e,"none","full","min","max","fit","prose",{screen:[Ue]},Ue]}],h:[{h:[$,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[$,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[$,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[$,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Ue,Le]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Nr]}],"font-family":[{font:[Mt]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",$]}],"line-clamp":[{"line-clamp":["none",wt,Nr]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Me,$]}],"list-image":[{"list-image":["none",$]}],"list-style-type":[{list:["none","disc","decimal",$]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[a]}],"placeholder-opacity":[{"placeholder-opacity":[x]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[a]}],"text-opacity":[{"text-opacity":[x]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Y(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Me,Le]}],"underline-offset":[{"underline-offset":["auto",Me,$]}],"text-decoration-color":[{decoration:[a]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:P()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",$]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",$]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[x]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...K(),fm]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",pm]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},ym]}],"bg-color":[{bg:[a]}],"gradient-from-pos":[{from:[f]}],"gradient-via-pos":[{via:[f]}],"gradient-to-pos":[{to:[f]}],"gradient-from":[{from:[b]}],"gradient-via":[{via:[b]}],"gradient-to":[{to:[b]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[x]}],"border-style":[{border:[...Y(),"hidden"]}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[x]}],"divide-style":[{divide:Y()}],"border-color":[{border:[n]}],"border-color-x":[{"border-x":[n]}],"border-color-y":[{"border-y":[n]}],"border-color-s":[{"border-s":[n]}],"border-color-e":[{"border-e":[n]}],"border-color-t":[{"border-t":[n]}],"border-color-r":[{"border-r":[n]}],"border-color-b":[{"border-b":[n]}],"border-color-l":[{"border-l":[n]}],"divide-color":[{divide:[n]}],"outline-style":[{outline:["",...Y()]}],"outline-offset":[{"outline-offset":[Me,$]}],"outline-w":[{outline:[Me,Le]}],"outline-color":[{outline:[a]}],"ring-w":[{ring:H()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[a]}],"ring-opacity":[{"ring-opacity":[x]}],"ring-offset-w":[{"ring-offset":[Me,Le]}],"ring-offset-color":[{"ring-offset":[a]}],shadow:[{shadow:["","inner","none",Ue,bm]}],"shadow-color":[{shadow:[Mt]}],opacity:[{opacity:[x]}],"mix-blend":[{"mix-blend":[...G(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":G()}],filter:[{filter:["","none"]}],blur:[{blur:[t]}],brightness:[{brightness:[r]}],contrast:[{contrast:[u]}],"drop-shadow":[{"drop-shadow":["","none",Ue,$]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[m]}],invert:[{invert:[h]}],saturate:[{saturate:[d]}],sepia:[{sepia:[_]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[t]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[u]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[m]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[x]}],"backdrop-saturate":[{"backdrop-saturate":[d]}],"backdrop-sepia":[{"backdrop-sepia":[_]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",$]}],duration:[{duration:te()}],ease:[{ease:["linear","in","out","in-out",$]}],delay:[{delay:te()}],animate:[{animate:["none","spin","ping","pulse","bounce",$]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[w]}],"scale-x":[{"scale-x":[w]}],"scale-y":[{"scale-y":[w]}],rotate:[{rotate:[Tt,$]}],"translate-x":[{"translate-x":[C]}],"translate-y":[{"translate-y":[C]}],"skew-x":[{"skew-x":[M]}],"skew-y":[{"skew-y":[M]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",$]}],accent:[{accent:["auto",a]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",$]}],"caret-color":[{caret:[a]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":P()}],"scroll-mx":[{"scroll-mx":P()}],"scroll-my":[{"scroll-my":P()}],"scroll-ms":[{"scroll-ms":P()}],"scroll-me":[{"scroll-me":P()}],"scroll-mt":[{"scroll-mt":P()}],"scroll-mr":[{"scroll-mr":P()}],"scroll-mb":[{"scroll-mb":P()}],"scroll-ml":[{"scroll-ml":P()}],"scroll-p":[{"scroll-p":P()}],"scroll-px":[{"scroll-px":P()}],"scroll-py":[{"scroll-py":P()}],"scroll-ps":[{"scroll-ps":P()}],"scroll-pe":[{"scroll-pe":P()}],"scroll-pt":[{"scroll-pt":P()}],"scroll-pr":[{"scroll-pr":P()}],"scroll-pb":[{"scroll-pb":P()}],"scroll-pl":[{"scroll-pl":P()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",$]}],fill:[{fill:[a,"none"]}],"stroke-w":[{stroke:[Me,Le,Nr]}],stroke:[{stroke:[a,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},km=nm(jm);function T(...a){return km(Pl(a))}function _m(a){return new Date(a).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})}function Bn(){return new Date().toISOString().split("T")[0]}function $n(a,e){const t=a/e*100;return t>=100?"excellent":t>=80?"good":t>=60?"warning":t>=40?"poor":"critical"}function Sm(a){switch(a){case"excellent":return"text-green-600 dark:text-green-400";case"good":return"text-blue-600 dark:text-blue-400";case"warning":return"text-yellow-600 dark:text-yellow-400";case"poor":return"text-orange-600 dark:text-orange-400";case"critical":return"text-red-600 dark:text-red-400";default:return"text-gray-600 dark:text-gray-400"}}function Ln(a){switch(a){case"excellent":return"bg-green-100 dark:bg-green-900";case"good":return"bg-blue-100 dark:bg-blue-900";case"warning":return"bg-yellow-100 dark:bg-yellow-900";case"poor":return"bg-orange-100 dark:bg-orange-900";case"critical":return"bg-red-100 dark:bg-red-900";default:return"bg-gray-100 dark:bg-gray-900"}}function Cm(){return Math.random().toString(36).substr(2,9)}function Un(a,e=1){return a.toFixed(e)}function Am(a){const e=new Date().toISOString().split("T")[0],t=[];a.lifestyle==="vegan"?t.push({id:"sample-1",name:"Vegan Breakfast Bowl",description:"Oatmeal with berries, chia seeds, and almond milk",timestamp:new Date,foodItems:[{id:"food-1",name:"Oatmeal",description:"1 cup cooked oatmeal",quantity:1,unit:"cup",macronutrients:{protein:6,carbohydrates:27,fat:3,fiber:4,calories:154},micronutrients:[{name:"Iron",amount:2.1,unit:"mg",category:"mineral",status:"good"},{name:"Magnesium",amount:61,unit:"mg",category:"mineral",status:"good"},{name:"Zinc",amount:1.3,unit:"mg",category:"mineral",status:"good"}],timestamp:new Date},{id:"food-2",name:"Mixed Berries",description:"1/2 cup mixed berries",quantity:.5,unit:"cup",macronutrients:{protein:1,carbohydrates:12,fat:.5,fiber:4,calories:42},micronutrients:[{name:"Vitamin C",amount:24,unit:"mg",category:"vitamin",status:"good"},{name:"Folate",amount:12,unit:"mcg",category:"vitamin",status:"good"}],timestamp:new Date}],totalNutrients:{macronutrients:[{name:"Calories",amount:196,unit:"kcal",calories:196,status:"good"},{name:"Protein",amount:7,unit:"g",calories:28,status:"good"},{name:"Carbohydrates",amount:39,unit:"g",calories:156,status:"good"},{name:"Fat",amount:3.5,unit:"g",calories:31.5,status:"good"},{name:"Fiber",amount:8,unit:"g",calories:0,status:"excellent"}],micronutrients:[{name:"Iron",amount:2.1,unit:"mg",category:"mineral",status:"good"},{name:"Vitamin C",amount:24,unit:"mg",category:"vitamin",status:"good"},{name:"Magnesium",amount:61,unit:"mg",category:"mineral",status:"good"},{name:"Zinc",amount:1.3,unit:"mg",category:"mineral",status:"good"},{name:"Folate",amount:12,unit:"mcg",category:"vitamin",status:"good"}]}},{id:"sample-2",name:"Quinoa Buddha Bowl",description:"Quinoa with roasted vegetables, chickpeas, and tahini dressing",timestamp:new Date,foodItems:[{id:"food-3",name:"Quinoa",description:"1 cup cooked quinoa",quantity:1,unit:"cup",macronutrients:{protein:8,carbohydrates:39,fat:3.5,fiber:5,calories:222},micronutrients:[{name:"Iron",amount:2.8,unit:"mg",category:"mineral",status:"good"},{name:"Magnesium",amount:118,unit:"mg",category:"mineral",status:"excellent"},{name:"Phosphorus",amount:281,unit:"mg",category:"mineral",status:"excellent"}],timestamp:new Date},{id:"food-4",name:"Chickpeas",description:"1/2 cup cooked chickpeas",quantity:.5,unit:"cup",macronutrients:{protein:7.5,carbohydrates:22.5,fat:2,fiber:6.2,calories:134},micronutrients:[{name:"Iron",amount:2.4,unit:"mg",category:"mineral",status:"good"},{name:"Folate",amount:141,unit:"mcg",category:"vitamin",status:"excellent"},{name:"Manganese",amount:1.2,unit:"mg",category:"mineral",status:"excellent"}],timestamp:new Date}],totalNutrients:{macronutrients:[{name:"Calories",amount:356,unit:"kcal",calories:356,status:"good"},{name:"Protein",amount:15.5,unit:"g",calories:62,status:"excellent"},{name:"Carbohydrates",amount:61.5,unit:"g",calories:246,status:"good"},{name:"Fat",amount:5.5,unit:"g",calories:49.5,status:"good"},{name:"Fiber",amount:11.2,unit:"g",calories:0,status:"excellent"}],micronutrients:[{name:"Iron",amount:5.2,unit:"mg",category:"mineral",status:"excellent"},{name:"Magnesium",amount:118,unit:"mg",category:"mineral",status:"excellent"},{name:"Phosphorus",amount:281,unit:"mg",category:"mineral",status:"excellent"},{name:"Folate",amount:141,unit:"mcg",category:"vitamin",status:"excellent"},{name:"Manganese",amount:1.2,unit:"mg",category:"mineral",status:"excellent"}]}}):t.push({id:"sample-1",name:"Protein Smoothie",description:"Banana, Greek yogurt, and protein powder",timestamp:new Date,foodItems:[{id:"food-1",name:"Greek Yogurt",description:"1 cup Greek yogurt",quantity:1,unit:"cup",macronutrients:{protein:20,carbohydrates:9,fat:0,fiber:0,calories:130},micronutrients:[{name:"Calcium",amount:200,unit:"mg",category:"mineral",status:"good"},{name:"Vitamin B12",amount:1.4,unit:"mcg",category:"vitamin",status:"excellent"}],timestamp:new Date}],totalNutrients:{macronutrients:[{name:"Calories",amount:130,unit:"kcal",calories:130,status:"good"},{name:"Protein",amount:20,unit:"g",calories:80,status:"excellent"},{name:"Carbohydrates",amount:9,unit:"g",calories:36,status:"good"},{name:"Fat",amount:0,unit:"g",calories:0,status:"good"},{name:"Fiber",amount:0,unit:"g",calories:0,status:"warning"}],micronutrients:[{name:"Calcium",amount:200,unit:"mg",category:"mineral",status:"good"},{name:"Vitamin B12",amount:1.4,unit:"mcg",category:"vitamin",status:"excellent"}]}});const r={macronutrients:[{name:"Calories",amount:552,unit:"kcal",calories:552,status:"good"},{name:"Protein",amount:22.5,unit:"g",calories:90,status:"good"},{name:"Carbohydrates",amount:100.5,unit:"g",calories:402,status:"good"},{name:"Fat",amount:9,unit:"g",calories:81,status:"good"},{name:"Fiber",amount:19.2,unit:"g",calories:0,status:"excellent"}],micronutrients:[{name:"Iron",amount:7.3,unit:"mg",category:"mineral",status:"excellent"},{name:"Vitamin C",amount:24,unit:"mg",category:"vitamin",status:"good"},{name:"Magnesium",amount:179,unit:"mg",category:"mineral",status:"excellent"},{name:"Zinc",amount:3.7,unit:"mg",category:"mineral",status:"good"},{name:"Folate",amount:153,unit:"mcg",category:"vitamin",status:"excellent"}]},n=He.calculateMolecularBalanceScore(r.macronutrients,r.micronutrients,{macronutrients:[],micronutrients:[]});return{date:e,meals:t,totalNutrients:r,molecularBalanceScore:Math.max(75,n)}}function Em(){const[a,e]=S.useState(null),[t,r]=S.useState(null),[n,i]=S.useState([]),[o,l]=S.useState([]),[u]=S.useState(!1),[c,m]=S.useState(null);S.useEffect(()=>{(()=>{try{const y=Te.loadUserProfile();y&&e(y);const d=Bn(),w=Te.loadDailyIntake(d);if(w&&w.totalNutrients&&w.totalNutrients.macronutrients.length>0&&w.totalNutrients.micronutrients.length>0)r(w),console.log("Loaded existing daily intake with nutrition data");else if(y){const M=Am(y);Te.saveDailyIntake(d,M),r(M),console.log("Created/updated sample nutrition data:",M.totalNutrients)}const _=Te.loadRecommendations();i(_),console.log("=== INITIAL DATA LOADED ===")}catch(y){console.error("Error loading initial data:",y),m("Failed to load application data")}})()},[]);const h=S.useCallback(x=>{try{console.log("useAppState: Saving profile to localStorage:",x),Te.saveUserProfile(x),console.log("useAppState: Profile saved to localStorage"),e(x),console.log("useAppState: Profile state updated"),m(null)}catch(y){console.error("Error saving user profile:",y),m("Failed to save user profile")}},[]),N=S.useCallback(x=>{try{const y=Bn();let d=t;(!d||d.date!==y)&&(d={date:y,meals:[],totalNutrients:{macronutrients:[],micronutrients:[]},molecularBalanceScore:0});const w=[...d.meals,x],_=He.calculateDailyTotals(w),M=He.calculateMolecularBalanceScore(_.macronutrients,_.micronutrients,{macronutrients:[],micronutrients:[]}),p={...d,meals:w,totalNutrients:_,molecularBalanceScore:M};Te.saveDailyIntake(y,p),r(p),m(null)}catch(y){console.error("Error adding meal:",y),m("Failed to add meal")}},[t]),b=S.useCallback((x,y)=>{try{if(!t)return;const d=t.meals.map(p=>p.id===x?y:p),w=He.calculateDailyTotals(d),_=He.calculateMolecularBalanceScore(w.macronutrients,w.micronutrients,{macronutrients:[],micronutrients:[]}),M={...t,meals:d,totalNutrients:w,molecularBalanceScore:_};Te.saveDailyIntake(t.date,M),r(M),m(null)}catch(d){console.error("Error updating meal:",d),m("Failed to update meal")}},[t]),f=S.useCallback(x=>{try{if(!t)return;const y=t.meals.filter(M=>M.id!==x),d=He.calculateDailyTotals(y),w=He.calculateMolecularBalanceScore(d.macronutrients,d.micronutrients,{macronutrients:[],micronutrients:[]}),_={...t,meals:y,totalNutrients:d,molecularBalanceScore:w};Te.saveDailyIntake(t.date,_),r(_),m(null)}catch(y){console.error("Error deleting meal:",y),m("Failed to delete meal")}},[t]),g=S.useCallback(x=>{try{Te.saveRecommendations(x),i(x),m(null)}catch(y){console.error("Error updating recommendations:",y),m("Failed to update recommendations")}},[]),v=S.useCallback(()=>{m(null)},[]);return{userProfile:a,dailyIntake:t,recommendations:n,progressData:o,isLoading:u,error:c,saveUserProfile:h,addMeal:N,updateMeal:b,deleteMeal:f,updateRecommendations:g,clearError:v,setUserProfile:e,setDailyIntake:r,setRecommendations:i,setProgressData:l}}function Rm({userProfile:a,onLogout:e,onUpdateProfile:t}){const[r,n]=S.useState(!1),[i,o]=S.useState(!1),[l,u]=S.useState(a),c=S.useRef(null);S.useEffect(()=>{function f(g){c.current&&!c.current.contains(g.target)&&n(!1)}return document.addEventListener("mousedown",f),()=>{document.removeEventListener("mousedown",f)}},[]);const m=()=>{t(l),o(!1)},h=()=>{u(a),o(!1)},N=f=>f.charAt(0).toUpperCase()+f.slice(1),b=f=>f?.sex&&f?.age?`${f.sex.charAt(0).toUpperCase()}${f.age}`:"U";return s.jsxs("div",{className:"relative",ref:c,children:[s.jsxs(k.button,{onClick:()=>n(!r),className:"flex items-center space-x-2 px-3 py-2 rounded-lg bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors duration-200",whileHover:{scale:1.02},whileTap:{scale:.98},children:[s.jsx("div",{className:"w-8 h-8 bg-primary-500 rounded-full flex items-center justify-center text-white text-sm font-semibold",children:b(a)}),s.jsxs("div",{className:"hidden sm:block text-left",children:[s.jsxs("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:[a?.sex==="male"?"Mr.":a?.sex==="female"?"Ms.":""," (",a?.age,"y)"]}),s.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:N(a?.lifestyle||"User")})]}),s.jsx(rl,{className:`h-4 w-4 text-gray-500 transition-transform duration-200 ${r?"rotate-180":""}`})]}),s.jsx(le,{children:r&&s.jsx(k.div,{initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.2},className:"absolute right-0 mt-2 w-80 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 z-50",children:s.jsxs("div",{className:"p-4",children:[s.jsxs("div",{className:"flex items-center space-x-3 mb-4 pb-4 border-b border-gray-200 dark:border-gray-700",children:[s.jsx("div",{className:"w-12 h-12 bg-primary-500 rounded-full flex items-center justify-center text-white text-lg font-semibold",children:b(a)}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Profile Details"}),s.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[a?.sex==="male"?"Mr.":a?.sex==="female"?"Ms.":""," ",a?.age," years old"]})]}),!i&&s.jsx(k.button,{onClick:()=>o(!0),className:"p-2 text-gray-500 hover:text-primary-600 dark:hover:text-primary-400 transition-colors",whileHover:{scale:1.1},whileTap:{scale:.9},children:s.jsx(al,{className:"h-4 w-4"})})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Age"}),i?s.jsx("input",{type:"number",value:l?.age||"",onChange:f=>u({...l,age:parseInt(f.target.value)}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 text-sm",min:"1",max:"120"}):s.jsxs("div",{className:"text-sm text-gray-900 dark:text-gray-100",children:[a?.age," years old"]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Sex"}),i?s.jsxs("select",{value:l?.sex||"",onChange:f=>u({...l,sex:f.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 text-sm",children:[s.jsx("option",{value:"male",children:"Male"}),s.jsx("option",{value:"female",children:"Female"}),s.jsx("option",{value:"other",children:"Other"})]}):s.jsx("div",{className:"text-sm text-gray-900 dark:text-gray-100",children:a?.sex?.charAt(0).toUpperCase()+a?.sex?.slice(1)})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Lifestyle"}),i?s.jsxs("select",{value:l?.lifestyle||"",onChange:f=>u({...l,lifestyle:f.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 text-sm",children:[s.jsx("option",{value:"vegan",children:"Vegan"}),s.jsx("option",{value:"vegetarian",children:"Vegetarian"}),s.jsx("option",{value:"omnivore",children:"Omnivore"}),s.jsx("option",{value:"pescatarian",children:"Pescatarian"}),s.jsx("option",{value:"keto",children:"Keto"}),s.jsx("option",{value:"paleo",children:"Paleo"})]}):s.jsx("div",{className:"text-sm text-gray-900 dark:text-gray-100",children:N(a?.lifestyle||"Unknown")})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Health Goals"}),s.jsxs("div",{className:"text-sm text-gray-900 dark:text-gray-100",children:[a?.healthGoals?.length||0," goals selected"]})]})]}),s.jsx("div",{className:"flex space-x-2 mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:i?s.jsxs(s.Fragment,{children:[s.jsx(k.button,{onClick:m,className:"flex-1 bg-primary-600 hover:bg-primary-700 text-white text-sm py-2 px-3 rounded-md transition-colors",whileHover:{scale:1.02},whileTap:{scale:.98},children:"Save"}),s.jsx(k.button,{onClick:h,className:"flex-1 bg-gray-500 hover:bg-gray-600 text-white text-sm py-2 px-3 rounded-md transition-colors",whileHover:{scale:1.02},whileTap:{scale:.98},children:"Cancel"})]}):s.jsxs(k.button,{onClick:e,className:"w-full bg-red-500 hover:bg-red-600 text-white text-sm py-2 px-3 rounded-md transition-colors flex items-center justify-center space-x-2",whileHover:{scale:1.02},whileTap:{scale:.98},children:[s.jsx(nl,{className:"h-4 w-4"}),s.jsx("span",{children:"Logout"})]})})]})})})]})}const Tm=S.memo(function({userProfile:e,dailyIntake:t,notifications:r=[],onNotificationRead:n,onNotificationDismiss:i}){const[o,l]=S.useState(!1),[u,c]=S.useState(!1),[m,h]=S.useState("unread"),[N,b]=S.useState("all");S.useState([]);const f=S.useMemo(()=>{const p=[],C=new Date;if(!e||!t)return p;const E=t.totalNutrients?.macronutrients?.find(L=>L.name==="Water")?.amount||0;E<2e3&&p.push({id:"water-reminder-1",type:"reminder",priority:"medium",title:"Hydration Reminder",message:"You've had less than 2L of water today. Stay hydrated for optimal molecular function!",action:"Log Water Intake",timestamp:new Date(C.getTime()-30*6e4),isRead:!1,isDismissed:!1,category:"wellness",data:{targetAmount:2500,currentAmount:E}});const A=t.meals?.length||0,R=C.getHours();A<2&&R>=14&&p.push({id:"meal-reminder-1",type:"reminder",priority:"medium",title:"Meal Logging Reminder",message:"You've only logged "+A+" meal(s) today. Don't forget to track your nutrition!",action:"Log Meal",timestamp:new Date(C.getTime()-15*6e4),isRead:!1,isDismissed:!1,category:"nutrition"});const P=t.totalNutrients?.macronutrients?.find(L=>L.name==="Protein")?.amount||0,H=e.sex==="male"?150:120;P<H*.8&&p.push({id:"protein-insight-1",type:"insight",priority:"medium",title:"Protein Intake Insight",message:`Your protein intake (${P}g) is below optimal levels. Consider adding protein-rich foods.`,action:"View Recommendations",timestamp:new Date(C.getTime()-45*6e4),isRead:!1,isDismissed:!1,category:"nutrition",data:{current:P,target:H}});const U=C.getHours();U>=21&&U<=23&&p.push({id:"sleep-tip-1",type:"tip",priority:"low",title:"Sleep Optimization Tip",message:"Optimal sleep timing for molecular repair is 10 PM - 6 AM. Consider winding down soon.",action:"View Sleep Tips",timestamp:new Date(C.getTime()-10*6e4),isRead:!1,isDismissed:!1,category:"wellness"});const K=t.molecularBalanceScore||0;K>=90&&p.push({id:"achievement-1",type:"achievement",priority:"high",title:"Molecular Excellence!",message:`Amazing! Your molecular balance score is ${K}. You're optimizing your cellular health!`,action:"Share Achievement",timestamp:new Date(C.getTime()-5*6e4),isRead:!1,isDismissed:!1,category:"health",data:{score:K}});const G=(t.totalNutrients?.micronutrients||[]).filter(L=>L.amount/(L.amount||1)*100<60);return G.length>0&&p.push({id:"deficiency-warning-1",type:"warning",priority:"high",title:"Nutrient Deficiency Alert",message:`Low levels detected: ${G.slice(0,3).map(L=>L.name).join(", ")}. Consider supplementation.`,action:"View Supplements",timestamp:new Date(C.getTime()-20*6e4),isRead:!1,isDismissed:!1,category:"health",data:{deficiencies:G.map(L=>L.name)}}),C.getDay()===0&&R>=10&&p.push({id:"weekly-milestone-1",type:"milestone",priority:"medium",title:"Weekly Progress Review",message:"Great week! Review your molecular nutrition progress and plan for the week ahead.",action:"View Weekly Report",timestamp:new Date(C.getTime()-60*6e4),isRead:!1,isDismissed:!1,category:"health"}),p.sort((L,Je)=>Je.timestamp.getTime()-L.timestamp.getTime())},[e,t]),g=S.useMemo(()=>[...r,...f].sort((p,C)=>C.timestamp.getTime()-p.timestamp.getTime()),[r,f]),v=S.useMemo(()=>g.filter(p=>{const C=m==="all"||m==="unread"&&!p.isRead||m==="read"&&p.isRead,E=N==="all"||p.category===N;return C&&E&&!p.isDismissed}),[g,m,N]),x=S.useMemo(()=>g.filter(p=>!p.isRead&&!p.isDismissed).length,[g]),y=(p,C)=>{const E=C==="urgent"?"text-red-600":C==="high"?"text-orange-600":C==="medium"?"text-blue-600":"text-gray-600";switch(p){case"reminder":return s.jsx(Ee,{className:`h-5 w-5 ${E}`});case"achievement":return s.jsx(at,{className:`h-5 w-5 ${E}`});case"insight":return s.jsx(de,{className:`h-5 w-5 ${E}`});case"warning":return s.jsx(jt,{className:`h-5 w-5 ${E}`});case"tip":return s.jsx(Os,{className:`h-5 w-5 ${E}`});case"milestone":return s.jsx(oe,{className:`h-5 w-5 ${E}`});default:return s.jsx(rr,{className:`h-5 w-5 ${E}`})}},d=p=>{switch(p){case"urgent":return"border-red-500 bg-red-50 dark:bg-red-900/20";case"high":return"border-orange-500 bg-orange-50 dark:bg-orange-900/20";case"medium":return"border-blue-500 bg-blue-50 dark:bg-blue-900/20";case"low":return"border-gray-500 bg-gray-50 dark:bg-gray-900/20";default:return"border-gray-500 bg-gray-50 dark:bg-gray-900/20"}},w=p=>{switch(n&&n(p.id),p.action){}},_=p=>{i&&i(p)},M=()=>{g.forEach(p=>{!p.isRead&&!p.isDismissed&&n&&n(p.id)})};return s.jsxs("div",{className:"relative",children:[s.jsxs(k.button,{onClick:()=>l(!o),className:"relative p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",whileHover:{scale:1.05},whileTap:{scale:.95},children:[x>0?s.jsx(il,{className:"h-6 w-6 text-primary-600"}):s.jsx(rr,{className:"h-6 w-6 text-gray-600 dark:text-gray-400"}),x>0&&s.jsx(k.div,{initial:{scale:0},animate:{scale:1},className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center font-medium",children:x>9?"9+":x})]}),s.jsx(le,{children:o&&s.jsxs(k.div,{initial:{opacity:0,y:-20,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-20,scale:.95},className:"absolute right-0 top-12 w-96 bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 z-50",children:[s.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Smart Notifications"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(k.button,{onClick:()=>c(!u),className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700",whileHover:{scale:1.05},whileTap:{scale:.95},children:s.jsx(Wn,{className:"h-4 w-4 text-gray-600 dark:text-gray-400"})}),s.jsx(k.button,{onClick:()=>l(!1),className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700",whileHover:{scale:1.05},whileTap:{scale:.95},children:s.jsx(nt,{className:"h-4 w-4 text-gray-600 dark:text-gray-400"})})]})]}),s.jsxs("div",{className:"flex gap-2 mb-3",children:[s.jsxs("select",{value:m,onChange:p=>h(p.target.value),className:"px-3 py-1 text-sm border border-gray-200 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",children:[s.jsx("option",{value:"unread",children:"Unread"}),s.jsx("option",{value:"all",children:"All"}),s.jsx("option",{value:"read",children:"Read"})]}),s.jsxs("select",{value:N,onChange:p=>b(p.target.value),className:"px-3 py-1 text-sm border border-gray-200 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",children:[s.jsx("option",{value:"all",children:"All Categories"}),s.jsx("option",{value:"nutrition",children:"Nutrition"}),s.jsx("option",{value:"fitness",children:"Fitness"}),s.jsx("option",{value:"wellness",children:"Wellness"}),s.jsx("option",{value:"health",children:"Health"})]})]}),x>0&&s.jsx("div",{className:"flex gap-2",children:s.jsxs("button",{onClick:M,className:"px-3 py-1 text-sm bg-primary-600 text-white rounded-lg hover:bg-primary-700 flex items-center gap-1",children:[s.jsx(me,{className:"h-3 w-3"}),"Mark All Read"]})})]}),s.jsx("div",{className:"max-h-96 overflow-y-auto",children:v.length===0?s.jsxs("div",{className:"p-6 text-center",children:[s.jsx(rr,{className:"h-12 w-12 text-gray-400 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:m==="unread"?"No unread notifications":"No notifications"})]}):s.jsx("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:v.map((p,C)=>s.jsx(k.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:C*.05},className:T("p-4 hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer transition-colors",!p.isRead&&"bg-blue-50 dark:bg-blue-900/10",d(p.priority)),onClick:()=>w(p),children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"mt-0.5",children:y(p.type,p.priority)}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h4",{className:T("text-sm font-medium",p.isRead?"text-gray-700 dark:text-gray-300":"text-gray-900 dark:text-gray-100"),children:p.title}),s.jsx("button",{onClick:E=>{E.stopPropagation(),_(p.id)},className:"p-1 rounded hover:bg-gray-200 dark:hover:bg-gray-600",children:s.jsx(nt,{className:"h-3 w-3 text-gray-400"})})]}),s.jsx("p",{className:T("text-sm mt-1",p.isRead?"text-gray-500 dark:text-gray-400":"text-gray-700 dark:text-gray-300"),children:p.message}),s.jsxs("div",{className:"flex items-center justify-between mt-2",children:[s.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:p.timestamp.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})}),p.action&&s.jsx("span",{className:"text-xs text-primary-600 font-medium",children:p.action})]})]})]})},p.id))})}),s.jsx("div",{className:"p-3 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-700/50",children:s.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 dark:text-gray-400",children:[s.jsxs("span",{children:[v.length," notification(s)"]}),s.jsx("span",{children:"Smart notifications enabled"})]})})]})})]})});function Mm({onMenuToggle:a,isMenuOpen:e,userProfile:t,onNavigate:r,currentPage:n,onLogout:i,onUpdateProfile:o,dailyIntake:l}){const{theme:u,toggleTheme:c}=Kl();return s.jsx(k.header,{initial:{y:-100},animate:{y:0},className:"sticky top-0 z-50 w-full border-b border-gray-200 dark:border-gray-700 bg-white/80 dark:bg-gray-900/80 backdrop-blur-md",children:s.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"flex h-16 items-center justify-between",children:[s.jsxs(k.div,{className:"flex items-center space-x-3",whileHover:{scale:1.05},transition:{type:"spring",stiffness:400,damping:10},children:[s.jsxs("div",{className:"relative",children:[s.jsx(Jn,{className:"h-8 w-8 text-primary-600 dark:text-primary-400 animate-molecular-float"}),s.jsx("div",{className:"absolute -top-1 -right-1 h-3 w-3 bg-secondary-500 rounded-full animate-pulse"})]}),s.jsxs("div",{className:"hidden sm:block",children:[s.jsx("h1",{className:"text-xl font-bold gradient-text",children:"Molecular Nutrition AI"}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:t?`Welcome, ${t.sex==="male"?"Mr.":t.sex==="female"?"Ms.":""} (${t.age}y)`:"Personalized nutrition at the molecular level"})]})]}),s.jsxs("nav",{className:"hidden md:flex items-center space-x-8",children:[s.jsx(k.button,{onClick:()=>r?.("dashboard"),className:T("text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors duration-200",n==="dashboard"&&"text-primary-600 dark:text-primary-400 font-semibold"),whileHover:{scale:1.05},whileTap:{scale:.95},children:"Dashboard"}),s.jsx(k.button,{onClick:()=>r?.("food-log"),className:T("text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors duration-200",n==="food-log"&&"text-primary-600 dark:text-primary-400 font-semibold"),whileHover:{scale:1.05},whileTap:{scale:.95},children:"Food Log"}),s.jsx(k.button,{onClick:()=>r?.("ai-insights"),className:T("text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors duration-200",n==="ai-insights"&&"text-primary-600 dark:text-primary-400 font-semibold"),whileHover:{scale:1.05},whileTap:{scale:.95},children:"AI Insights"}),s.jsx(k.button,{onClick:()=>r?.("progress"),className:T("text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors duration-200",n==="progress"&&"text-primary-600 dark:text-primary-400 font-semibold"),whileHover:{scale:1.05},whileTap:{scale:.95},children:"Progress"}),s.jsx(k.button,{onClick:()=>r?.("meal-planning"),className:T("text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors duration-200",n==="meal-planning"&&"text-primary-600 dark:text-primary-400 font-semibold"),whileHover:{scale:1.05},whileTap:{scale:.95},children:"Meal Plans"}),s.jsx(k.button,{onClick:()=>r?.("supplements"),className:T("text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors duration-200",n==="supplements"&&"text-primary-600 dark:text-primary-400 font-semibold"),whileHover:{scale:1.05},whileTap:{scale:.95},children:"Supplements"}),s.jsx(k.button,{onClick:()=>r?.("education"),className:T("text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors duration-200",n==="education"&&"text-primary-600 dark:text-primary-400 font-semibold"),whileHover:{scale:1.05},whileTap:{scale:.95},children:"Learn"}),s.jsx(k.button,{onClick:()=>r?.("analytics"),className:T("text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors duration-200",n==="analytics"&&"text-primary-600 dark:text-primary-400 font-semibold"),whileHover:{scale:1.05},whileTap:{scale:.95},children:"Analytics"}),s.jsx(k.button,{onClick:()=>r?.("community"),className:T("text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 transition-colors duration-200",n==="community"&&"text-primary-600 dark:text-primary-400 font-semibold"),whileHover:{scale:1.05},whileTap:{scale:.95},children:"Community"})]}),s.jsxs("div",{className:"flex items-center space-x-4",children:[t&&s.jsx(Tm,{userProfile:t,dailyIntake:l}),t&&s.jsx(Rm,{userProfile:t,onLogout:i||(()=>{}),onUpdateProfile:o||(()=>{})}),s.jsx(k.button,{onClick:c,className:T("p-2 rounded-lg transition-all duration-200","hover:bg-gray-100 dark:hover:bg-gray-700","focus:outline-none focus:ring-2 focus:ring-primary-500"),whileHover:{scale:1.1},whileTap:{scale:.95},"aria-label":"Toggle theme",children:u==="light"?s.jsx(ol,{className:"h-5 w-5 text-gray-700 dark:text-gray-300"}):s.jsx(ll,{className:"h-5 w-5 text-gray-700 dark:text-gray-300"})}),s.jsx(k.button,{onClick:a,className:T("md:hidden p-2 rounded-lg transition-all duration-200","hover:bg-gray-100 dark:hover:bg-gray-700","focus:outline-none focus:ring-2 focus:ring-primary-500"),whileHover:{scale:1.1},whileTap:{scale:.95},"aria-label":"Toggle menu",children:e?s.jsx(nt,{className:"h-5 w-5 text-gray-700 dark:text-gray-300"}):s.jsx(cl,{className:"h-5 w-5 text-gray-700 dark:text-gray-300"})})]})]})})})}const Im=[{id:"dashboard",label:"Dashboard",icon:dl},{id:"food-log",label:"Food Log",icon:As},{id:"nutrients",label:"Nutrients",icon:Vt},{id:"ai-insights",label:"AI Insights",icon:de},{id:"progress",label:"Progress",icon:be},{id:"meal-planning",label:"Meal Plans",icon:Pe},{id:"supplements",label:"Supplements",icon:fs},{id:"education",label:"Learn",icon:kr},{id:"analytics",label:"Analytics",icon:ul},{id:"community",label:"Community",icon:_r},{id:"profile",label:"Profile",icon:Lt},{id:"settings",label:"Settings",icon:Wn}];function Pm({isOpen:a,onClose:e,currentPage:t,onPageChange:r}){return s.jsxs(s.Fragment,{children:[s.jsx(le,{children:a&&s.jsx(k.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-40 bg-black/50 md:hidden",onClick:e})}),s.jsx(le,{children:a&&s.jsx(k.aside,{initial:{x:-300},animate:{x:0},exit:{x:-300},transition:{type:"spring",damping:25,stiffness:200},className:T("fixed left-0 top-0 z-50 h-full w-64 bg-white dark:bg-gray-900 border-r border-gray-200 dark:border-gray-700","md:relative md:translate-x-0 md:border-r"),children:s.jsxs("div",{className:"flex h-full flex-col",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Navigation"}),s.jsx("button",{onClick:e,className:"md:hidden p-1 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:s.jsx(nt,{className:"h-5 w-5 text-gray-500"})})]}),s.jsx("nav",{className:"flex-1 p-4 space-y-2",children:Im.map(n=>{const i=n.icon,o=t===n.id;return s.jsxs(k.button,{onClick:()=>{r(n.id),e()},className:T("w-full flex items-center space-x-3 px-3 py-2 rounded-lg text-left transition-all duration-200",o?"bg-primary-100 dark:bg-primary-900 text-primary-700 dark:text-primary-300":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"),whileHover:{scale:1.02},whileTap:{scale:.98},children:[s.jsx(i,{className:T("h-5 w-5",o?"text-primary-600 dark:text-primary-400":"text-gray-500 dark:text-gray-400")}),s.jsx("span",{className:"font-medium",children:n.label})]},n.id)})}),s.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700",children:s.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 text-center",children:[s.jsx("p",{children:"Molecular Nutrition AI"}),s.jsx("p",{children:"v1.0.0"})]})})]})})})]})}function Om(){const a=new Date().getFullYear();return s.jsx(k.footer,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{duration:.5},className:"bg-gray-50 dark:bg-gray-900 border-t border-gray-200 dark:border-gray-700",children:s.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-8",children:[s.jsxs("div",{className:"col-span-1 md:col-span-2",children:[s.jsxs(k.div,{className:"flex items-center space-x-3 mb-4",whileHover:{scale:1.05},transition:{type:"spring",stiffness:400,damping:10},children:[s.jsx(Jn,{className:"h-8 w-8 text-primary-600 dark:text-primary-400"}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:"Molecular Nutrition AI"}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Personalized nutrition at the molecular level"})]})]}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4 max-w-md",children:"Harnessing the power of AI and molecular biology to provide personalized nutrition recommendations that optimize your health at the cellular level."}),s.jsxs("div",{className:"flex space-x-4",children:[s.jsx(k.a,{href:"#",className:"text-gray-400 hover:text-primary-600 dark:hover:text-primary-400 transition-colors",whileHover:{scale:1.2},whileTap:{scale:.9},children:s.jsx(ml,{className:"h-5 w-5"})}),s.jsx(k.a,{href:"#",className:"text-gray-400 hover:text-primary-600 dark:hover:text-primary-400 transition-colors",whileHover:{scale:1.2},whileTap:{scale:.9},children:s.jsx(hl,{className:"h-5 w-5"})}),s.jsx(k.a,{href:"#",className:"text-gray-400 hover:text-primary-600 dark:hover:text-primary-400 transition-colors",whileHover:{scale:1.2},whileTap:{scale:.9},children:s.jsx(gl,{className:"h-5 w-5"})})]})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Quick Links"}),s.jsx("ul",{className:"space-y-2",children:["Dashboard","Food Logging","AI Recommendations","Progress Tracking","User Profile"].map(e=>s.jsx("li",{children:s.jsx("a",{href:"#",className:"text-gray-600 dark:text-gray-400 hover:text-primary-600 dark:hover:text-primary-400 transition-colors duration-200",children:e})},e))})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Support"}),s.jsx("ul",{className:"space-y-2",children:["Help Center","Documentation","API Reference","Contact Us","Privacy Policy"].map(e=>s.jsx("li",{children:s.jsx("a",{href:"#",className:"text-gray-600 dark:text-gray-400 hover:text-primary-600 dark:hover:text-primary-400 transition-colors duration-200",children:e})},e))})]})]}),s.jsx("div",{className:"mt-8 pt-8 border-t border-gray-200 dark:border-gray-700",children:s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center",children:[s.jsxs("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:["Â© ",a," Molecular Nutrition AI. All rights reserved."]}),s.jsxs(k.div,{className:"flex items-center space-x-1 text-sm text-gray-600 dark:text-gray-400 mt-4 md:mt-0",whileHover:{scale:1.05},children:[s.jsx("span",{children:"Made with"}),s.jsx(Oe,{className:"h-4 w-4 text-red-500"}),s.jsx("span",{children:"for better health"})]})]})})]})})}var Dm=function(a,e){for(var t={};a.length;){var r=a[0],n=r.code,i=r.message,o=r.path.join(".");if(!t[o])if("unionErrors"in r){var l=r.unionErrors[0].errors[0];t[o]={message:l.message,type:l.code}}else t[o]={message:i,type:n};if("unionErrors"in r&&r.unionErrors.forEach(function(m){return m.errors.forEach(function(h){return a.push(h)})}),e){var u=t[o].types,c=u&&u[r.code];t[o]=Ll(o,e,t,n,c?[].concat(c,r.message):r.message)}a.shift()}return t},tl=function(a,e,t){return t===void 0&&(t={}),function(r,n,i){try{return Promise.resolve(function(o,l){try{var u=Promise.resolve(a[t.mode==="sync"?"parse":"parseAsync"](r,e)).then(function(c){return i.shouldUseNativeValidation&&Bl({},i),{errors:{},values:t.raw?r:c}})}catch(c){return l(c)}return u&&u.then?u.then(void 0,l):u}(0,function(o){if(function(l){return Array.isArray(l?.errors)}(o))return{values:{},errors:$l(Dm(o.errors,!i.shouldUseNativeValidation&&i.criteriaMode==="all"),i)};throw o}))}catch(o){return Promise.reject(o)}}};const Fm=ri({name:ht().min(2,"Name must be at least 2 characters").max(50,"Name must be less than 50 characters"),age:nr().min(1,"Age must be at least 1").max(120,"Age must be less than 120"),sex:Ar(["male","female","other"]),height:nr().min(100,"Height must be at least 100cm").max(250,"Height must be less than 250cm"),weight:nr().min(30,"Weight must be at least 30kg").max(300,"Weight must be less than 300kg"),ethnicity:ht().min(1,"Ethnicity is required"),region:ht().min(1,"Region is required"),medicalHistory:qa(ht()),lifestyle:Ar(["vegan","vegetarian","omnivore","pescatarian","keto","paleo"]),healthGoals:qa(ht()).min(1,"Select at least one health goal")}).refine(a=>a.name&&a.age&&a.sex&&a.height&&a.weight&&a.ethnicity&&a.region&&a.lifestyle,{message:"All fields are required",path:["name"]}),Bm=["Caucasian","African American","Hispanic/Latino","Asian","Native American","Pacific Islander","Mixed Race","Other"],$m=["North America","South America","Europe","Asia","Africa","Oceania","Middle East","Other"],Lm=["diabetes","cardiovascular","hypertension","allergies","digestive_issues","autoimmune","mental_health","none"],Um=[{value:"muscle_gain",label:"Muscle Gain",icon:"ðŸ’ª"},{value:"weight_loss",label:"Weight Loss",icon:"âš–ï¸"},{value:"energy_boost",label:"Energy Boost",icon:"âš¡"},{value:"longevity",label:"Longevity",icon:"ðŸŒ±"},{value:"disease_prevention",label:"Disease Prevention",icon:"ðŸ›¡ï¸"},{value:"athletic_performance",label:"Athletic Performance",icon:"ðŸƒ"},{value:"mental_clarity",label:"Mental Clarity",icon:"ðŸ§ "},{value:"immune_support",label:"Immune Support",icon:"ðŸ¦ "}];function Hn({onComplete:a,initialData:e}){const[t,r]=S.useState(1),[n,i]=S.useState(e?.healthGoals||[]),[o,l]=S.useState(e?.medicalHistory||[]),{register:u,handleSubmit:c,formState:{errors:m},watch:h,setValue:N}=ai({resolver:tl(Fm),defaultValues:{name:e?.name||"",age:e?.age||25,sex:e?.sex||"other",height:e?.height||0,weight:e?.weight||0,ethnicity:e?.ethnicity||"",region:e?.region||"",medicalHistory:e?.medicalHistory||[],lifestyle:e?.lifestyle||"omnivore",healthGoals:e?.healthGoals||[]}}),b=d=>{if(console.log("=== FORM SUBMISSION STARTED ==="),console.log("Form data:",d),console.log("Selected goals:",n),console.log("Selected medical:",o),console.log("Current step:",t),!d.name||!d.age||!d.sex||!d.height||!d.weight||!d.ethnicity||!d.region||!d.lifestyle){console.error("Missing required fields:",{name:d.name,age:d.age,sex:d.sex,height:d.height,weight:d.weight,ethnicity:d.ethnicity,region:d.region,lifestyle:d.lifestyle}),alert("Please fill in all required fields");return}if(n.length===0){console.error("No health goals selected"),alert("Please select at least one health goal");return}const w={...d,healthGoals:n,medicalHistory:o};console.log("Final profile data:",w),console.log("Calling onComplete..."),console.log("onComplete function:",a);try{a(w),console.log("onComplete called successfully")}catch(_){console.error("Error calling onComplete:",_)}console.log("=== FORM SUBMISSION COMPLETED ===")},f=d=>{i(w=>w.includes(d)?w.filter(_=>_!==d):[...w,d])},g=d=>{l(w=>w.includes(d)?w.filter(_=>_!==d):[...w,d])},v=()=>{t<3&&r(t+1)},x=()=>{t>1&&r(t-1)},y=[{number:1,title:"Basic Info",icon:Lt},{number:2,title:"Health & Lifestyle",icon:Oe},{number:3,title:"Goals & Preferences",icon:oe}];return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 to-secondary-50 dark:from-gray-900 dark:to-gray-800 molecular-bg",children:s.jsx("div",{className:"container mx-auto px-4 py-8",children:s.jsxs(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"max-w-4xl mx-auto",children:[s.jsxs("div",{className:"text-center mb-8",children:[s.jsx(k.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",stiffness:200},className:"inline-flex items-center justify-center w-16 h-16 bg-primary-100 dark:bg-primary-900 rounded-full mb-4",children:s.jsx(Lt,{className:"h-8 w-8 text-primary-600 dark:text-primary-400"})}),s.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100 mb-2",children:"Welcome to Molecular Nutrition AI"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Let's create your personalized nutrition profile"})]}),s.jsx("div",{className:"flex justify-center mb-8",children:s.jsx("div",{className:"flex items-center space-x-4",children:y.map((d,w)=>{const _=d.icon,M=t===d.number,p=t>d.number;return s.jsxs(Gn.Fragment,{children:[s.jsxs(k.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.3+w*.1},className:T("flex items-center space-x-2 px-4 py-2 rounded-full transition-all duration-200",M?"bg-primary-600 text-white":p?"bg-green-500 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-400"),children:[p?s.jsx(me,{className:"h-5 w-5"}):s.jsx(_,{className:"h-5 w-5"}),s.jsx("span",{className:"font-medium",children:d.title})]}),w<y.length-1&&s.jsx("div",{className:"w-8 h-0.5 bg-gray-300 dark:bg-gray-600"})]},d.number)})})}),s.jsx(k.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"card p-8",children:s.jsxs("form",{onSubmit:c(b),children:[t===1&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsx(Lt,{className:"h-12 w-12 text-primary-600 dark:text-primary-400 mx-auto mb-3"}),s.jsx("h2",{className:"text-2xl font-semibold text-gray-900 dark:text-gray-100",children:"Basic Information"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Tell us about yourself to personalize your experience"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Full Name"}),s.jsx("input",{id:"name",type:"text",autoComplete:"name",...u("name"),className:T("input",m.name&&"input-error"),placeholder:"Enter your full name"}),m.name&&s.jsxs("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400 flex items-center",children:[s.jsx(Ce,{className:"h-4 w-4 mr-1"}),String(m.name.message)]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"age",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Age"}),s.jsx("input",{id:"age",type:"number",autoComplete:"bday-year",...u("age",{valueAsNumber:!0}),className:T("input",m.age&&"input-error"),placeholder:"Enter your age"}),m.age&&s.jsxs("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400 flex items-center",children:[s.jsx(Ce,{className:"h-4 w-4 mr-1"}),String(m.age.message)]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"sex",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Sex"}),s.jsxs("select",{id:"sex",autoComplete:"sex",...u("sex"),className:T("input",m.sex&&"input-error"),children:[s.jsx("option",{value:"",children:"Select sex"}),s.jsx("option",{value:"male",children:"Male"}),s.jsx("option",{value:"female",children:"Female"}),s.jsx("option",{value:"other",children:"Other"})]}),m.sex&&s.jsxs("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400 flex items-center",children:[s.jsx(Ce,{className:"h-4 w-4 mr-1"}),String(m.sex.message)]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"height",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Height (cm)"}),s.jsx("input",{id:"height",type:"number",autoComplete:"off",...u("height",{valueAsNumber:!0}),className:T("input",m.height&&"input-error"),placeholder:"e.g., 170",min:"100",max:"250"}),m.height&&s.jsxs("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400 flex items-center",children:[s.jsx(Ce,{className:"h-4 w-4 mr-1"}),String(m.height.message)]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"weight",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Weight (kg)"}),s.jsx("input",{id:"weight",type:"number",autoComplete:"off",...u("weight",{valueAsNumber:!0}),className:T("input",m.weight&&"input-error"),placeholder:"e.g., 70",min:"30",max:"300",step:"0.1"}),m.weight&&s.jsxs("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400 flex items-center",children:[s.jsx(Ce,{className:"h-4 w-4 mr-1"}),String(m.weight.message)]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"ethnicity",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Ethnicity"}),s.jsxs("select",{id:"ethnicity",autoComplete:"off",...u("ethnicity"),className:T("input",m.ethnicity&&"input-error"),children:[s.jsx("option",{value:"",children:"Select ethnicity"}),Bm.map(d=>s.jsx("option",{value:d,children:d},d))]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"region",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Region"}),s.jsxs("select",{id:"region",autoComplete:"country",...u("region"),className:T("input",m.region&&"input-error"),children:[s.jsx("option",{value:"",children:"Select region"}),$m.map(d=>s.jsx("option",{value:d,children:d},d))]})]})]})]}),t===2&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsx(Oe,{className:"h-12 w-12 text-primary-600 dark:text-primary-400 mx-auto mb-3"}),s.jsx("h2",{className:"text-2xl font-semibold text-gray-900 dark:text-gray-100",children:"Health & Lifestyle"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Help us understand your health background and dietary preferences"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Dietary Lifestyle"}),s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:["vegan","vegetarian","omnivore","pescatarian","keto","paleo"].map(d=>s.jsx(k.button,{type:"button",onClick:()=>N("lifestyle",d),className:T("p-3 rounded-lg border-2 transition-all duration-200 text-center",h("lifestyle")===d?"border-primary-500 bg-primary-50 dark:bg-primary-900 text-primary-700 dark:text-primary-300":"border-gray-200 dark:border-gray-600 hover:border-primary-300 dark:hover:border-primary-500"),whileHover:{scale:1.02},whileTap:{scale:.98},children:s.jsx("span",{className:"font-medium capitalize",children:d})},d))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Medical History (Select all that apply)"}),s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:Lm.map(d=>s.jsx(k.button,{type:"button",onClick:()=>g(d),className:T("p-3 rounded-lg border-2 transition-all duration-200 text-center",o.includes(d)?"border-red-500 bg-red-50 dark:bg-red-900 text-red-700 dark:text-red-300":"border-gray-200 dark:border-gray-600 hover:border-red-300 dark:hover:border-red-500"),whileHover:{scale:1.02},whileTap:{scale:.98},children:s.jsx("span",{className:"font-medium capitalize",children:d.replace("_"," ")})},d))})]})]}),t===3&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsx(oe,{className:"h-12 w-12 text-primary-600 dark:text-primary-400 mx-auto mb-3"}),s.jsx("h2",{className:"text-2xl font-semibold text-gray-900 dark:text-gray-100",children:"Health Goals"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"What would you like to achieve with your nutrition?"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Select your health goals (Choose at least one)"}),s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:Um.map(d=>s.jsxs(k.button,{type:"button",onClick:()=>f(d.value),className:T("p-4 rounded-lg border-2 transition-all duration-200 text-center",n.includes(d.value)?"border-primary-500 bg-primary-50 dark:bg-primary-900 text-primary-700 dark:text-primary-300":"border-gray-200 dark:border-gray-600 hover:border-primary-300 dark:hover:border-primary-500"),whileHover:{scale:1.02},whileTap:{scale:.98},children:[s.jsx("div",{className:"text-2xl mb-2",children:d.icon}),s.jsx("span",{className:"font-medium text-sm",children:d.label})]},d.value))}),n.length===0&&s.jsxs("p",{className:"mt-2 text-sm text-red-600 dark:text-red-400 flex items-center",children:[s.jsx(Ce,{className:"h-4 w-4 mr-1"}),"Please select at least one health goal"]})]})]}),s.jsxs("div",{className:"flex justify-between mt-8",children:[s.jsx(k.button,{type:"button",onClick:x,disabled:t===1,className:T("btn-secondary",t===1&&"opacity-50 cursor-not-allowed"),whileHover:{scale:t===1?1:1.05},whileTap:{scale:t===1?1:.95},children:"Previous"}),t<3?s.jsxs(k.button,{type:"button",onClick:v,className:"btn-primary flex items-center space-x-2",whileHover:{scale:1.05},whileTap:{scale:.95},children:[s.jsx("span",{children:"Next"}),s.jsx(Kn,{className:"h-4 w-4"})]}):s.jsxs(k.button,{type:"submit",disabled:n.length===0,className:T("btn-primary flex items-center space-x-2",n.length===0&&"opacity-50 cursor-not-allowed"),whileHover:{scale:n.length===0?1:1.05},whileTap:{scale:n.length===0?1:.95},onClick:d=>{d.preventDefault(),console.log("Complete Setup button clicked"),console.log("Selected goals:",n),console.log("Form data:",h());const w=h();console.log("Calling onSubmit with form data:",w),b(w)},children:[s.jsx("span",{children:"Complete Setup"}),s.jsx(me,{className:"h-4 w-4"})]})]})]})},t)]})})})}const Hm=ri({description:ht().min(1,"Please describe what you ate"),mealType:Ar(["breakfast","lunch","dinner","snack"]),timestamp:Ul()}),zn=[{value:"breakfast",label:"Breakfast",icon:"ðŸŒ…",color:"bg-orange-100 text-orange-700 dark:bg-orange-900 dark:text-orange-300"},{value:"lunch",label:"Lunch",icon:"â˜€ï¸",color:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900 dark:text-yellow-300"},{value:"dinner",label:"Dinner",icon:"ðŸŒ™",color:"bg-blue-100 text-blue-700 dark:bg-blue-900 dark:text-blue-300"},{value:"snack",label:"Snack",icon:"ðŸŽ",color:"bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300"}];function zm({onMealAdded:a,meals:e,onMealUpdate:t,onMealDelete:r}){const[n,i]=S.useState(!1),[o,l]=S.useState(!1),[u,c]=S.useState(null),[m,h]=S.useState(""),{showSuccess:N,showError:b}=tc(),{register:f,handleSubmit:g,formState:{errors:v},reset:x,setValue:y,watch:d}=ai({resolver:tl(Hm),defaultValues:{description:"",mealType:"breakfast",timestamp:new Date}}),w=d("mealType"),_=async A=>{console.log("Form submitted with data:",A),i(!0);try{console.log("Parsing food description:",A.description);const R=await Vu.parseFoodDescription(A.description);console.log("Parsed food items:",R);const P={id:Math.random().toString(36).substr(2,9),name:`${A.mealType.charAt(0).toUpperCase()+A.mealType.slice(1)}`,description:A.description,foodItems:R,timestamp:A.timestamp,totalNutrients:{macronutrients:[],micronutrients:[]}};console.log("Created meal:",P),u?(console.log("Updating meal:",u),t(u,P),c(null),N("Meal Updated","Your meal has been successfully updated!")):(console.log("Adding new meal"),a(P),N("Meal Added","Your meal has been successfully logged!")),x(),l(!1)}catch(R){console.error("Error adding meal:",R),b("Error Adding Meal","Failed to add meal. Please try again.")}finally{i(!1)}},M=A=>{y("description",A.description),y("mealType",A.name.toLowerCase()),y("timestamp",A.timestamp),c(A.id),l(!0)},p=()=>{x(),c(null),l(!1)},E=e.filter(A=>A.description.toLowerCase().includes(m.toLowerCase())||A.name.toLowerCase().includes(m.toLowerCase())).filter(A=>{const R=new Date(A.timestamp).toDateString(),P=new Date().toDateString();return R===P});return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100 flex items-center",children:[s.jsx(As,{className:"h-6 w-6 mr-2 text-primary-600 dark:text-primary-400"}),"Food Logger"]}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Track your meals and get molecular-level nutrition insights"})]}),s.jsxs(k.button,{onClick:()=>l(!o),className:"btn-primary flex items-center space-x-2",whileHover:{scale:1.05},whileTap:{scale:.95},children:[s.jsx(Yn,{className:"h-4 w-4"}),s.jsx("span",{children:"Add Meal"})]})]}),s.jsx(le,{children:o&&s.jsx(k.div,{initial:{opacity:0,height:0,y:-20},animate:{opacity:1,height:"auto",y:0},exit:{opacity:0,height:0,y:-20},transition:{duration:.3,ease:[.4,0,.2,1]},className:"card p-6",children:s.jsxs("form",{onSubmit:g(_),className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:u?"Edit Meal":"Add New Meal"}),s.jsx("button",{type:"button",onClick:p,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:"Ã—"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Meal Type"}),s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:zn.map(A=>s.jsxs(k.button,{type:"button",onClick:()=>y("mealType",A.value),className:T("p-3 rounded-lg border-2 transition-all duration-200 text-center",w===A.value?"border-primary-500 bg-primary-50 dark:bg-primary-900":"border-gray-200 dark:border-gray-600 hover:border-primary-300"),whileHover:{scale:1.02},whileTap:{scale:.98},children:[s.jsx("div",{className:"text-lg mb-1",children:A.icon}),s.jsx("span",{className:"text-sm font-medium",children:A.label})]},A.value))})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"What did you eat?"}),s.jsx("textarea",{id:"description",autoComplete:"off",...f("description"),rows:3,className:T("input",v.description&&"input-error"),placeholder:"e.g., 1 cup rice, 100g lentils, 1 apple"}),v.description&&s.jsxs("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400 flex items-center",children:[s.jsx(Ce,{className:"h-4 w-4 mr-1"}),v.description.message]}),s.jsx("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"Be specific with quantities and measurements for better accuracy"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"timestamp",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"When did you eat this?"}),s.jsx("input",{id:"timestamp",type:"datetime-local",autoComplete:"off",...f("timestamp",{valueAsDate:!0}),className:"input",defaultValue:new Date().toISOString().slice(0,16)})]}),s.jsxs("div",{className:"flex justify-end space-x-3",children:[s.jsx("button",{type:"button",onClick:p,className:"btn-secondary",children:"Cancel"}),s.jsxs(k.button,{type:"submit",disabled:n,className:"btn-primary flex items-center space-x-2",whileHover:{scale:n?1:1.05},whileTap:{scale:n?1:.95},children:[n?s.jsx(pl,{className:"h-4 w-4 animate-spin"}):s.jsx(me,{className:"h-4 w-4"}),s.jsx("span",{children:u?"Update Meal":"Add Meal"})]})]})]})})}),s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("div",{className:"relative flex-1",children:[s.jsx(Xn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),s.jsx("input",{id:"search-meals",type:"text",autoComplete:"off",placeholder:"Search meals...",value:m,onChange:A=>h(A.target.value),className:"input pl-10"})]}),s.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600 dark:text-gray-400",children:[s.jsx(Pe,{className:"h-4 w-4"}),s.jsx("span",{children:"Today"})]})]}),s.jsx("div",{className:"space-y-4",children:E.length===0?s.jsxs(k.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-12",children:[s.jsx(As,{className:"h-12 w-12 text-gray-300 dark:text-gray-600 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:"No meals logged today"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Start by adding your first meal to begin tracking your nutrition"}),s.jsx(k.button,{onClick:()=>l(!0),className:"btn-primary",whileHover:{scale:1.05},whileTap:{scale:.95},children:"Add Your First Meal"})]}):s.jsx("div",{className:"grid gap-4",children:E.map((A,R)=>{const P=zn.find(H=>H.label.toLowerCase()===A.name.toLowerCase());return s.jsx(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:R*.1},className:"card p-4 hover:shadow-md transition-shadow duration-200",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[s.jsx("span",{className:"text-lg",children:P?.icon}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-gray-900 dark:text-gray-100",children:A.name}),s.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600 dark:text-gray-400",children:[s.jsx(Ee,{className:"h-3 w-3"}),s.jsx("span",{children:_m(A.timestamp)})]})]})]}),s.jsx("p",{className:"text-gray-700 dark:text-gray-300 mb-3",children:A.description}),A.foodItems&&A.foodItems.length>0&&s.jsx("div",{className:"flex flex-wrap gap-2",children:A.foodItems.map((H,U)=>s.jsx("span",{className:"px-2 py-1 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-full text-xs",children:H.name},U))})]}),s.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[s.jsx(k.button,{onClick:()=>M(A),className:"p-2 text-gray-400 hover:text-primary-600 dark:hover:text-primary-400 transition-colors",whileHover:{scale:1.1},whileTap:{scale:.9},children:s.jsx(fl,{className:"h-4 w-4"})}),s.jsx(k.button,{onClick:()=>r(A.id),className:"p-2 text-gray-400 hover:text-red-600 dark:hover:text-red-400 transition-colors",whileHover:{scale:1.1},whileTap:{scale:.9},children:s.jsx(xs,{className:"h-4 w-4"})})]})]})},A.id)})})})]})}function Vm({userProfile:a,molecularBalanceScore:e,lastLogin:t}){const r=()=>{const l=new Date().getHours();return l<12?"Good morning":l<18?"Good afternoon":"Good evening"},n=l=>l>=90?"Outstanding! You're optimizing your molecular nutrition perfectly!":l>=80?"Excellent work! Your nutrition is on track for optimal health.":l>=70?"Good progress! A few tweaks could boost your molecular balance.":l>=60?"You're on the right path! Let's optimize your nutrition further.":"Let's work together to improve your molecular nutrition balance!",i=l=>l>=90?"text-green-600":l>=80?"text-blue-600":l>=70?"text-yellow-600":"text-orange-600",o=l=>l>=90?"bg-green-100 dark:bg-green-900/20":l>=80?"bg-blue-100 dark:bg-blue-900/20":l>=70?"bg-yellow-100 dark:bg-yellow-900/20":"bg-orange-100 dark:bg-orange-900/20";return s.jsxs(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"relative overflow-hidden bg-gradient-to-br from-primary-600 via-primary-700 to-primary-800 rounded-2xl p-8 text-white",children:[s.jsxs("div",{className:"absolute inset-0 opacity-10",children:[s.jsx("div",{className:"absolute top-4 left-4 w-20 h-20 border border-white/20 rounded-full"}),s.jsx("div",{className:"absolute top-12 right-8 w-16 h-16 border border-white/20 rounded-full"}),s.jsx("div",{className:"absolute bottom-8 left-12 w-12 h-12 border border-white/20 rounded-full"}),s.jsx("div",{className:"absolute bottom-4 right-4 w-24 h-24 border border-white/20 rounded-full"})]}),s.jsxs("div",{className:"relative z-10",children:[s.jsxs("div",{className:"flex items-start justify-between mb-6",children:[s.jsxs("div",{children:[s.jsxs(k.h1,{className:"text-3xl font-bold mb-2",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.2},children:[r(),", ",a?.name||"Molecular Explorer","!"]}),s.jsx(k.p,{className:"text-primary-100 text-lg",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.3},children:"Welcome back to your molecular nutrition journey"})]}),s.jsxs(k.div,{className:`${o(e)} rounded-xl p-4 text-center`,initial:{scale:0},animate:{scale:1},transition:{delay:.4,type:"spring",stiffness:200},children:[s.jsx("div",{className:`text-2xl font-bold ${i(e)}`,children:e}),s.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:"Balance Score"})]})]}),s.jsx(k.p,{className:"text-primary-100 mb-6 max-w-2xl",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},children:n(e)}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[s.jsxs(k.div,{className:"bg-white/10 backdrop-blur-sm rounded-lg p-4",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx(Pe,{className:"h-5 w-5 text-primary-200"}),s.jsx("span",{className:"text-sm font-medium text-primary-200",children:"Today's Focus"})]}),s.jsx("p",{className:"text-sm text-white",children:a?.healthGoals?.[0]?.replace("_"," ")||"Overall Health"})]}),s.jsxs(k.div,{className:"bg-white/10 backdrop-blur-sm rounded-lg p-4",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.7},children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx(Ee,{className:"h-5 w-5 text-primary-200"}),s.jsx("span",{className:"text-sm font-medium text-primary-200",children:"Last Activity"})]}),s.jsx("p",{className:"text-sm text-white",children:t?new Date(t).toLocaleDateString():"Today"})]}),s.jsxs(k.div,{className:"bg-white/10 backdrop-blur-sm rounded-lg p-4",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8},children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx(at,{className:"h-5 w-5 text-primary-200"}),s.jsx("span",{className:"text-sm font-medium text-primary-200",children:"Streak"})]}),s.jsx("p",{className:"text-sm text-white",children:"7 days"})]})]}),s.jsxs(k.div,{className:"flex flex-wrap gap-3",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.9},children:[s.jsxs(k.button,{className:"bg-white/20 backdrop-blur-sm hover:bg-white/30 text-white px-4 py-2 rounded-lg text-sm font-medium transition-all flex items-center gap-2",whileHover:{scale:1.05},whileTap:{scale:.95},children:[s.jsx(De,{className:"h-4 w-4"}),"Quick Log Meal"]}),s.jsxs(k.button,{className:"bg-white/20 backdrop-blur-sm hover:bg-white/30 text-white px-4 py-2 rounded-lg text-sm font-medium transition-all flex items-center gap-2",whileHover:{scale:1.05},whileTap:{scale:.95},children:[s.jsx(oe,{className:"h-4 w-4"}),"View Insights",s.jsx(Kn,{className:"h-3 w-3"})]}),s.jsxs(k.button,{className:"bg-white/20 backdrop-blur-sm hover:bg-white/30 text-white px-4 py-2 rounded-lg text-sm font-medium transition-all flex items-center gap-2",whileHover:{scale:1.05},whileTap:{scale:.95},children:[s.jsx(be,{className:"h-4 w-4"}),"Progress Report"]})]})]}),s.jsx(k.div,{className:"absolute top-8 right-8 opacity-20",animate:{y:[0,-10,0],rotate:[0,5,0]},transition:{duration:4,repeat:1/0,ease:"easeInOut"},children:s.jsx(xl,{className:"h-8 w-8 text-white"})})]})}const Vn=S.memo(function({dailyIntake:e,userProfile:t}){const[r,n]=S.useState("overview"),[i,o]=S.useState({macronutrients:[],micronutrients:[]}),l=S.useMemo(()=>{if(!t?.height||!t?.weight)return null;const x=t.height/100,y=t.weight/(x*x);let d="",w="";return y<18.5?(d="Underweight",w="text-blue-600 dark:text-blue-400"):y>=18.5&&y<25?(d="Normal",w="text-green-600 dark:text-green-400"):y>=25&&y<30?(d="Overweight",w="text-yellow-600 dark:text-yellow-400"):(d="Obese",w="text-red-600 dark:text-red-400"),{bmi:y.toFixed(1),bmiCategory:d,bmiColor:w,height:t.height,weight:t.weight}},[t]);S.useEffect(()=>{if(t){const x={macronutrients:On.getMacronutrientTargets(t),micronutrients:On.getMicronutrientTargets(t)};o(x)}},[t]);const u=S.useMemo(()=>!e?.totalNutrients?.macronutrients||!i.macronutrients?["excellent","good","warning","excellent"]:e.totalNutrients.macronutrients.map(x=>{const y=i.macronutrients.find(d=>d.name===x.name);return $n(x.amount,y?.amount||0)}),[e,i.macronutrients]),c=S.useMemo(()=>!e?.totalNutrients?.micronutrients||!i.micronutrients?["excellent","excellent","warning","excellent","warning","excellent","warning","excellent"]:e.totalNutrients.micronutrients.map(x=>{const y=i.micronutrients.find(d=>d.name===x.name);return $n(x.amount,y?.amount||0)}),[e,i.micronutrients]),m=S.useMemo(()=>{const x=e?.totalNutrients?.macronutrients||[];return[{name:"Protein",value:x.find(d=>d.name==="Protein")?.amount||0,color:"#3b82f6",icon:"ðŸ¥©"},{name:"Carbs",value:x.find(d=>d.name==="Carbohydrates")?.amount||0,color:"#10b981",icon:"ðŸž"},{name:"Fat",value:x.find(d=>d.name==="Fat")?.amount||0,color:"#f59e0b",icon:"ðŸ¥‘"},{name:"Fiber",value:x.find(d=>d.name==="Fiber")?.amount||0,color:"#8b5cf6",icon:"ðŸŒ¾"}].filter(d=>d.value>0)},[e]),h=S.useMemo(()=>c.length>0?c.map((y,d)=>{const w=e?.totalNutrients?.micronutrients?.[d],_=i.micronutrients?.[d],M=_?(w?.amount||0)/_.amount*100:0;return{name:w?.name||`Nutrient ${d+1}`,percentage:M,status:y,amount:w?.amount||0,target:_?.amount||0,color:y==="excellent"?"#10b981":y==="good"?"#3b82f6":y==="warning"?"#f59e0b":"#ef4444"}}):[{name:"Vitamin C",amount:95,target:90,status:"excellent"},{name:"Iron",amount:85,target:80,status:"excellent"},{name:"Magnesium",amount:75,target:100,status:"warning"},{name:"Zinc",amount:90,target:85,status:"excellent"},{name:"Vitamin D",amount:65,target:100,status:"warning"},{name:"B12",amount:95,target:90,status:"excellent"},{name:"Folate",amount:80,target:100,status:"warning"},{name:"Calcium",amount:88,target:85,status:"excellent"}].map(y=>({name:y.name,percentage:y.amount/y.target*100,status:y.status,amount:y.amount,target:y.target,color:y.status==="excellent"?"#10b981":y.status==="good"?"#3b82f6":y.status==="warning"?"#f59e0b":"#ef4444"})),[c,e,i.micronutrients]),N=S.useMemo(()=>[{day:"Mon",score:78,calories:1850,protein:120},{day:"Tue",score:82,calories:1920,protein:135},{day:"Wed",score:75,calories:1680,protein:110},{day:"Thu",score:88,calories:2100,protein:145},{day:"Fri",score:85,calories:1980,protein:130},{day:"Sat",score:92,calories:2200,protein:155},{day:"Sun",score:87,calories:2050,protein:140}],[]),b=S.useMemo(()=>{const x=e?.totalNutrients?.macronutrients?.find(_=>_.name==="Calories")?.amount||0,y=e?.totalNutrients?.macronutrients?.find(_=>_.name==="Protein")?.amount||0,d=e?.molecularBalanceScore||0,w=e?.meals?.length||0;return{calories:x,protein:y,score:d,meals:w,water:8,steps:8500}},[e]),f=h.filter(x=>x.status==="poor"||x.status==="critical"),g=h.filter(x=>x.status==="excellent"),v=[{id:"overview",label:"Overview",icon:oe},{id:"macros",label:"Macros",icon:Vt},{id:"micros",label:"Micros",icon:Kr},{id:"trends",label:"Trends",icon:be},{id:"insights",label:"Insights",icon:de}];return!e||!t?s.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading nutrition data..."})]})}):s.jsxs("div",{className:"space-y-6",children:[s.jsx(Vm,{userProfile:t,molecularBalanceScore:b.score,lastLogin:new Date().toISOString()}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:[s.jsx(k.div,{className:"bg-white dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700",whileHover:{scale:1.05},transition:{type:"spring",stiffness:300},children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-red-100 dark:bg-red-900/20 rounded-lg",children:s.jsx(yl,{className:"h-5 w-5 text-red-600"})}),s.jsxs("div",{children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:b.calories}),s.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Calories"})]})]})}),s.jsx(k.div,{className:"bg-white dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700",whileHover:{scale:1.05},transition:{type:"spring",stiffness:300},children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/20 rounded-lg",children:s.jsx(oe,{className:"h-5 w-5 text-blue-600"})}),s.jsxs("div",{children:[s.jsxs("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:[b.protein,"g"]}),s.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Protein"})]})]})}),l&&s.jsx(k.div,{className:"bg-white dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700",whileHover:{scale:1.05},transition:{type:"spring",stiffness:300},children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-indigo-100 dark:bg-indigo-900/20 rounded-lg",children:s.jsx(ze,{className:"h-5 w-5 text-indigo-600"})}),s.jsxs("div",{children:[s.jsx("div",{className:`text-lg font-semibold ${l.bmiColor}`,children:l.bmi}),s.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"BMI"}),s.jsx("div",{className:`text-xs ${l.bmiColor}`,children:l.bmiCategory})]})]})}),s.jsx(k.div,{className:"bg-white dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700",whileHover:{scale:1.05},transition:{type:"spring",stiffness:300},children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-900/20 rounded-lg",children:s.jsx(bl,{className:"h-5 w-5 text-green-600"})}),s.jsxs("div",{children:[s.jsxs("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:[b.water,"L"]}),s.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Water"})]})]})}),s.jsx(k.div,{className:"bg-white dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700",whileHover:{scale:1.05},transition:{type:"spring",stiffness:300},children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-purple-100 dark:bg-purple-900/20 rounded-lg",children:s.jsx(ze,{className:"h-5 w-5 text-purple-600"})}),s.jsxs("div",{children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:b.steps}),s.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Steps"})]})]})}),s.jsx(k.div,{className:"bg-white dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700",whileHover:{scale:1.05},transition:{type:"spring",stiffness:300},children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-orange-100 dark:bg-orange-900/20 rounded-lg",children:s.jsx(Ee,{className:"h-5 w-5 text-orange-600"})}),s.jsxs("div",{children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:b.meals}),s.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Meals"})]})]})}),s.jsx(k.div,{className:"bg-white dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700",whileHover:{scale:1.05},transition:{type:"spring",stiffness:300},children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-pink-100 dark:bg-pink-900/20 rounded-lg",children:s.jsx(qt,{className:"h-5 w-5 text-pink-600"})}),s.jsxs("div",{children:[s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:g.length}),s.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Optimal"})]})]})})]}),s.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700",children:s.jsx("div",{className:"flex overflow-x-auto",children:v.map(x=>{const y=x.icon;return s.jsxs("button",{onClick:()=>n(x.id),className:T("flex items-center gap-2 px-6 py-4 text-sm font-medium transition-all whitespace-nowrap",r===x.id?"text-primary-600 border-b-2 border-primary-600 bg-primary-50 dark:bg-primary-900/20":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"),children:[s.jsx(y,{className:"h-4 w-4"}),x.label]},x.id)})})}),s.jsx(le,{mode:"wait",children:s.jsxs(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:[r==="overview"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"relative inline-flex items-center justify-center",children:[s.jsxs("svg",{className:"w-32 h-32 transform -rotate-90",viewBox:"0 0 120 120",children:[s.jsx("circle",{cx:"60",cy:"60",r:"50",stroke:"currentColor",strokeWidth:"8",fill:"none",className:"text-gray-200 dark:text-gray-700"}),s.jsx("circle",{cx:"60",cy:"60",r:"50",stroke:"currentColor",strokeWidth:"8",fill:"none",strokeDasharray:`${2*Math.PI*50}`,strokeDashoffset:`${2*Math.PI*50*(1-b.score/100)}`,className:"text-primary-600",strokeLinecap:"round"})]}),s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100",children:b.score}),s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Molecular Balance"})]})})]}),s.jsx("p",{className:"mt-4 text-gray-600 dark:text-gray-400 max-w-md mx-auto",children:"Your molecular balance score reflects how well your nutrition aligns with optimal cellular function and metabolic health."})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 flex items-center gap-2",children:[s.jsx(me,{className:"h-5 w-5 text-green-600"}),"Excellent Nutrients"]}),s.jsx("div",{className:"space-y-2",children:g.slice(0,4).map((x,y)=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 dark:bg-green-900/20 rounded-lg",children:[s.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:x.name}),s.jsxs("span",{className:"text-sm text-green-600 font-semibold",children:[x.percentage.toFixed(0),"%"]})]},y))})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 flex items-center gap-2",children:[s.jsx(jt,{className:"h-5 w-5 text-orange-600"}),"Needs Attention"]}),s.jsx("div",{className:"space-y-2",children:f.slice(0,4).map((x,y)=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-orange-50 dark:bg-orange-900/20 rounded-lg",children:[s.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:x.name}),s.jsxs("span",{className:"text-sm text-orange-600 font-semibold",children:[x.percentage.toFixed(0),"%"]})]},y))})]})]})]}),r==="macros"&&s.jsx("div",{className:"space-y-6",children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Macronutrient Distribution"}),s.jsx("div",{className:"h-64",children:s.jsx(Ut,{width:"100%",height:"100%",children:s.jsxs(Ol,{children:[s.jsx(Dl,{data:m,cx:"50%",cy:"50%",innerRadius:60,outerRadius:100,paddingAngle:5,dataKey:"value",children:m.map((x,y)=>s.jsx(Fl,{fill:x.color},`cell-${y}`))}),s.jsx(Ve,{formatter:x=>[`${x}g`,"Amount"]}),s.jsx(It,{})]})})})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Macro Breakdown"}),s.jsx("div",{className:"space-y-4",children:u.map((x,y)=>{const d=e?.totalNutrients?.macronutrients?.[y],w=i.macronutrients?.[y],_=w?(d?.amount||0)/w.amount*100:0;return s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:d?.name||`Macro ${y+1}`}),s.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[d?.amount||0,"g / ",w?.amount||0,"g"]})]}),s.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:s.jsx(k.div,{className:T("h-2 rounded-full",Ln(x)),initial:{width:0},animate:{width:`${Math.min(_,100)}%`},transition:{duration:.8,delay:y*.1}})}),s.jsxs("div",{className:"flex items-center justify-between text-xs",children:[s.jsx("span",{className:T("font-medium",Sm(x)),children:x.charAt(0).toUpperCase()+x.slice(1)}),s.jsxs("span",{className:"text-gray-500 dark:text-gray-400",children:[_.toFixed(0),"%"]})]})]},y)})})]})]})}),r==="micros"&&s.jsx("div",{className:"space-y-6",children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Micronutrient Status"}),s.jsx("div",{className:"h-64",children:s.jsx(Ut,{width:"100%",height:"100%",children:s.jsxs(si,{data:h,children:[s.jsx(Ze,{strokeDasharray:"3 3"}),s.jsx(et,{dataKey:"name"}),s.jsx(tt,{}),s.jsx(Ve,{formatter:x=>[`${x}%`,"Percentage"]}),s.jsx(Sr,{dataKey:"percentage",fill:"#3b82f6"})]})})})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Micronutrient Details"}),s.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:h.map((x,y)=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:T("w-3 h-3 rounded-full",Ln(x.status))}),s.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:x.name})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("div",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100",children:[x.percentage.toFixed(0),"%"]}),s.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[x.amount," / ",x.target]})]})]},y))})]})]})}),r==="trends"&&s.jsxs("div",{className:"space-y-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"7-Day Nutrition Trends"}),s.jsx("div",{className:"h-64",children:s.jsx(Ut,{width:"100%",height:"100%",children:s.jsxs(Xr,{data:N,children:[s.jsx(Ze,{strokeDasharray:"3 3"}),s.jsx(et,{dataKey:"day"}),s.jsx(tt,{}),s.jsx(Ve,{}),s.jsx(ft,{type:"monotone",dataKey:"score",stackId:"1",stroke:"#3b82f6",fill:"#3b82f6",fillOpacity:.6})]})})})]}),r==="insights"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 flex items-center gap-2",children:[s.jsx(de,{className:"h-5 w-5 text-primary-600"}),"AI Nutrition Insights"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/20 dark:to-blue-800/20 rounded-xl p-6",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/40 rounded-lg",children:s.jsx(De,{className:"h-5 w-5 text-blue-600"})}),s.jsx("h4",{className:"font-semibold text-gray-900 dark:text-gray-100",children:"Energy Optimization"})]}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Your carbohydrate intake supports sustained energy levels. Consider timing complex carbs around workouts for optimal performance."}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-blue-600 font-medium",children:[s.jsx(Qn,{className:"h-4 w-4"}),"+12% Energy Efficiency"]})]}),s.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 dark:from-green-900/20 dark:to-green-800/20 rounded-xl p-6",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-900/40 rounded-lg",children:s.jsx(Oe,{className:"h-5 w-5 text-green-600"})}),s.jsx("h4",{className:"font-semibold text-gray-900 dark:text-gray-100",children:"Cardiovascular Health"})]}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Your omega-3 and fiber intake supports heart health. Maintain this balance for long-term cardiovascular benefits."}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-600 font-medium",children:[s.jsx(me,{className:"h-4 w-4"}),"Optimal Range"]})]}),s.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 dark:from-purple-900/20 dark:to-purple-800/20 rounded-xl p-6",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:"p-2 bg-purple-100 dark:bg-purple-900/40 rounded-lg",children:s.jsx(de,{className:"h-5 w-5 text-purple-600"})}),s.jsx("h4",{className:"font-semibold text-gray-900 dark:text-gray-100",children:"Cognitive Function"})]}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Your B-vitamin and antioxidant intake supports brain health. Consider adding more leafy greens for enhanced cognitive performance."}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-purple-600 font-medium",children:[s.jsx(be,{className:"h-4 w-4"}),"Improving"]})]}),s.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-orange-100 dark:from-orange-900/20 dark:to-orange-800/20 rounded-xl p-6",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:"p-2 bg-orange-100 dark:bg-orange-900/40 rounded-lg",children:s.jsx(oe,{className:"h-5 w-5 text-orange-600"})}),s.jsx("h4",{className:"font-semibold text-gray-900 dark:text-gray-100",children:"Muscle Health"})]}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Your protein intake is well-distributed. Consider adding more magnesium-rich foods for better muscle recovery."}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-orange-600 font-medium",children:[s.jsx(Os,{className:"h-4 w-4"}),"Monitor Progress"]})]})]})]})]},r)})]})});function Ye({className:a="",height:e="h-4",width:t="w-full"}){return s.jsx(k.div,{className:`bg-gray-200 dark:bg-gray-700 rounded ${e} ${t} ${a}`,animate:{opacity:[.5,1,.5]},transition:{duration:1.5,repeat:1/0,ease:"easeInOut"}})}function jr(){return s.jsx("div",{className:"card p-6",children:s.jsxs("div",{className:"flex items-start space-x-4",children:[s.jsx(Ye,{height:"h-12",width:"w-12",className:"rounded-full"}),s.jsxs("div",{className:"flex-1 space-y-3",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Ye,{height:"h-5",width:"w-32"}),s.jsx(Ye,{height:"h-6",width:"w-16",className:"rounded-full"})]}),s.jsx(Ye,{height:"h-4",width:"w-full"}),s.jsx(Ye,{height:"h-4",width:"w-4/5"}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx(Ye,{height:"h-6",width:"w-20",className:"rounded-full"}),s.jsx(Ye,{height:"h-6",width:"w-24",className:"rounded-full"})]})]})]})})}const qm={food_suggestion:wl,deficiency_alert:jt,optimization_tip:De,health_insight:Oe},Gm={high:"border-red-200 bg-red-50 dark:bg-red-900 dark:border-red-700",medium:"border-yellow-200 bg-yellow-50 dark:bg-yellow-900 dark:border-yellow-700",low:"border-blue-200 bg-blue-50 dark:bg-blue-900 dark:border-blue-700"},Wm={high:jt,medium:Ee,low:me},qn=S.memo(function({userProfile:e,dailyIntake:t,recommendations:r,onRecommendationsUpdate:n}){const[i,o]=S.useState(!1),[l,u]=S.useState("all"),[c,m]=S.useState("all");S.useEffect(()=>{e&&r.length===0&&h()},[e]);const h=async()=>{if(e){o(!0);try{console.log("=== GENERATING AI RECOMMENDATIONS ==="),console.log("User profile:",e),console.log("Daily intake:",t);const g=t||{date:new Date().toISOString().split("T")[0],meals:[],totalNutrients:{macronutrients:[{name:"Calories",amount:1200,unit:"kcal"},{name:"Protein",amount:45,unit:"g"},{name:"Carbohydrates",amount:150,unit:"g"},{name:"Fat",amount:35,unit:"g"}],micronutrients:[{name:"Iron",amount:8,unit:"mg"},{name:"Vitamin C",amount:60,unit:"mg"},{name:"Calcium",amount:800,unit:"mg"}]},molecularBalanceScore:75},v=t?He.identifyDeficiencies(t.totalNutrients.micronutrients,[]):["Protein","Iron","Vitamin C"];console.log("Deficiencies identified:",v);const x=await qu.generateRecommendations(e,g,v);console.log("Generated recommendations:",x),n(x)}catch(g){console.error("Error generating recommendations:",g);const v=[{id:Math.random().toString(36).substr(2,9),type:"food_suggestion",priority:"high",title:"Boost Your Protein Intake",description:`As a ${e.lifestyle} with goals of ${e.healthGoals.join(", ")}, consider adding more plant-based proteins like quinoa, lentils, and hemp seeds to support your nutrition goals.`,reasoning:"Based on your vegan lifestyle and health goals, increasing protein variety will support muscle maintenance and overall health.",suggestedFoods:["Quinoa","Lentils","Hemp seeds","Chia seeds","Tempeh"],targetNutrients:["Protein","Iron","Zinc"],createdAt:new Date,isRead:!1},{id:Math.random().toString(36).substr(2,9),type:"optimization_tip",priority:"medium",title:"Optimize Nutrient Absorption",description:"Pair iron-rich foods with vitamin C sources to enhance absorption. For example, add bell peppers to your spinach salad.",reasoning:"Vitamin C increases iron absorption by up to 6x, which is especially important for plant-based diets.",suggestedFoods:["Bell peppers","Citrus fruits","Strawberries","Broccoli"],targetNutrients:["Iron","Vitamin C"],createdAt:new Date,isRead:!1},{id:Math.random().toString(36).substr(2,9),type:"health_insight",priority:"low",title:"Molecular Nutrition Insight",description:"Your body needs 9 essential amino acids that it cannot produce. As a vegan, focus on complementary proteins like rice and beans.",reasoning:"Complete proteins provide all essential amino acids needed for optimal cellular function and muscle synthesis.",suggestedFoods:["Brown rice","Black beans","Quinoa","Buckwheat"],targetNutrients:["Complete proteins","Essential amino acids"],createdAt:new Date,isRead:!1}];console.log("Using fallback recommendations:",v),n(v)}finally{o(!1)}}},N=g=>{const v=r.map(x=>x.id===g?{...x,isRead:!0}:x);n(v)},b=r.filter(g=>{if(!g||typeof g!="object")return!1;const v=l==="all"||g.priority===l,x=c==="all"||g.type===c;return v&&x}).map(g=>({...g,suggestedFoods:Array.isArray(g.suggestedFoods)?g.suggestedFoods:[],targetNutrients:Array.isArray(g.targetNutrients)?g.targetNutrients:[],id:g.id||Math.random().toString(36).substr(2,9),title:g.title||"Nutrition Recommendation",description:g.description||"General nutrition advice",reasoning:g.reasoning||"Based on your nutrition profile",type:g.type||"optimization_tip",priority:g.priority||"medium",isRead:g.isRead||!1,createdAt:g.createdAt||new Date})),f=r.filter(g=>!g.isRead).length;return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100 flex items-center",children:[s.jsx(de,{className:"h-6 w-6 mr-2 text-primary-600 dark:text-primary-400"}),"AI Recommendations"]}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Personalized nutrition insights powered by molecular analysis"})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[f>0&&s.jsxs(k.div,{initial:{scale:0},animate:{scale:1},className:"bg-red-500 text-white text-xs font-bold px-2 py-1 rounded-full",children:[f," new"]}),s.jsxs(k.button,{onClick:h,disabled:i,className:"btn-primary flex items-center space-x-2",whileHover:{scale:i?1:1.05},whileTap:{scale:i?1:.95},children:[i?s.jsx(Yr,{className:"h-4 w-4 animate-spin"}):s.jsx(de,{className:"h-4 w-4"}),s.jsx("span",{children:i?"Generating...":"Refresh"})]}),s.jsxs(k.button,{onClick:()=>{console.log("=== TESTING AI WITH RANDOM DATA ==="),h()},className:"btn-secondary flex items-center space-x-2",whileHover:{scale:1.05},whileTap:{scale:.95},children:[s.jsx(de,{className:"h-4 w-4"}),s.jsx("span",{children:"ðŸ§ª Test AI"})]})]})]}),s.jsxs("div",{className:"flex flex-wrap gap-4",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Priority:"}),s.jsx("div",{className:"flex space-x-1 bg-gray-100 dark:bg-gray-800 rounded-lg p-1",children:["all","high","medium","low"].map(g=>s.jsx(k.button,{type:"button",onClick:()=>u(g),className:T("px-3 py-1 rounded-md text-sm font-medium transition-all duration-200 capitalize",l===g?"bg-white dark:bg-gray-700 text-primary-600 dark:text-primary-400 shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"),whileHover:{scale:1.02},whileTap:{scale:.98},children:g},g))})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Type:"}),s.jsx("div",{className:"flex space-x-1 bg-gray-100 dark:bg-gray-800 rounded-lg p-1",children:["all","food_suggestion","deficiency_alert","optimization_tip","health_insight"].map(g=>s.jsx(k.button,{type:"button",onClick:()=>m(g),className:T("px-3 py-1 rounded-md text-sm font-medium transition-all duration-200",c===g?"bg-white dark:bg-gray-700 text-primary-600 dark:text-primary-400 shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"),whileHover:{scale:1.02},whileTap:{scale:.98},children:g==="all"?"All":g.replace("_"," ")},g))})]})]}),s.jsx("div",{className:"space-y-4",children:i?s.jsxs("div",{className:"space-y-4",children:[s.jsx(jr,{}),s.jsx(jr,{}),s.jsx(jr,{})]}):b.length===0?s.jsxs(k.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-12",children:[s.jsx(de,{className:"h-12 w-12 text-gray-300 dark:text-gray-600 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:"No recommendations available"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Start logging meals to get AI-powered nutrition insights"}),s.jsx(k.button,{onClick:h,className:"btn-primary",whileHover:{scale:1.05},whileTap:{scale:.95},children:"Generate Recommendations"})]}):s.jsx(le,{children:b.map((g,v)=>{if(!g||typeof g!="object")return console.warn("Invalid recommendation structure:",g),null;const x=qm[g.type],y=Wm[g.priority];return s.jsx(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{delay:v*.1},className:T("card p-6 transition-all duration-200 hover:shadow-md",!g.isRead&&"ring-2 ring-primary-200 dark:ring-primary-800",Gm[g.priority]),children:s.jsxs("div",{className:"flex items-start space-x-4",children:[s.jsx("div",{className:T("flex-shrink-0 w-12 h-12 rounded-full flex items-center justify-center",g.priority==="high"&&"bg-red-100 dark:bg-red-900",g.priority==="medium"&&"bg-yellow-100 dark:bg-yellow-900",g.priority==="low"&&"bg-blue-100 dark:bg-blue-900"),children:s.jsx(x,{className:T("h-6 w-6",g.priority==="high"&&"text-red-600 dark:text-red-400",g.priority==="medium"&&"text-yellow-600 dark:text-yellow-400",g.priority==="low"&&"text-blue-600 dark:text-blue-400")})}),s.jsx("div",{className:"flex-1 min-w-0",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:g.title}),s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(y,{className:T("h-4 w-4",g.priority==="high"&&"text-red-500",g.priority==="medium"&&"text-yellow-500",g.priority==="low"&&"text-blue-500")}),s.jsx("span",{className:T("text-xs font-medium px-2 py-1 rounded-full",g.priority==="high"&&"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",g.priority==="medium"&&"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",g.priority==="low"&&"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200"),children:g.priority})]})]}),s.jsx("p",{className:"text-gray-700 dark:text-gray-300 mb-3",children:g.description}),g.suggestedFoods&&Array.isArray(g.suggestedFoods)&&g.suggestedFoods.length>0&&s.jsxs("div",{className:"mb-3",children:[s.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 mb-2",children:"Suggested Foods:"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:g.suggestedFoods.map((d,w)=>s.jsx("span",{className:"px-3 py-1 bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 rounded-full text-sm font-medium",children:d},w))})]}),g.targetNutrients&&Array.isArray(g.targetNutrients)&&g.targetNutrients.length>0&&s.jsxs("div",{className:"mb-3",children:[s.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 mb-2",children:"Target Nutrients:"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:g.targetNutrients.map((d,w)=>s.jsx("span",{className:"px-3 py-1 bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 rounded-full text-sm font-medium",children:d},w))})]}),s.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-3 mb-3",children:[s.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 mb-1",children:"Why this matters:"}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:g.reasoning})]}),s.jsxs("div",{className:"flex items-center space-x-2 text-xs text-gray-500 dark:text-gray-400",children:[s.jsx(Ee,{className:"h-3 w-3"}),s.jsxs("span",{children:[new Date(g.createdAt).toLocaleDateString()," at"," ",new Date(g.createdAt).toLocaleTimeString()]})]})]}),s.jsx("div",{className:"flex flex-col space-y-2 ml-4",children:!g.isRead&&s.jsx(k.button,{onClick:()=>N(g.id),className:"p-2 text-gray-400 hover:text-primary-600 dark:hover:text-primary-400 transition-colors",whileHover:{scale:1.1},whileTap:{scale:.9},title:"Mark as read",children:s.jsx(me,{className:"h-4 w-4"})})})]})})]})},g.id)})})})]})});function Jm({progressData:a,dailyIntake:e}){const[t,r]=S.useState("week"),[n,i]=S.useState(null);S.useEffect(()=>{if(a.length>0){const b=Gu.analyzeTrends(a);i({period:"month",data:a,...b})}},[a]);const o=()=>{const b=[],f=new Date;for(let g=29;g>=0;g--){const v=new Date(f);v.setDate(v.getDate()-g),b.push({date:v.toISOString().split("T")[0],molecularBalanceScore:Math.floor(Math.random()*30)+70,nutrientTrends:{Protein:{current:Math.floor(Math.random()*20)+40,target:60,trend:Math.random()>.5?"improving":"stable"},Iron:{current:Math.floor(Math.random()*10)+5,target:12,trend:Math.random()>.3?"improving":"declining"},"Vitamin C":{current:Math.floor(Math.random()*30)+40,target:75,trend:"stable"}},healthInsights:["Consistent protein intake supporting muscle health","Iron levels improving with dietary changes","Vitamin C intake meeting daily requirements"]})}return b},l=a.length>0?a:o(),u=b=>{switch(b){case"improving":return s.jsx(be,{className:"h-4 w-4 text-green-500"});case"declining":return s.jsx(ar,{className:"h-4 w-4 text-red-500"});default:return s.jsx(Zn,{className:"h-4 w-4 text-gray-500"})}},c=b=>{switch(b){case"improving":return"text-green-600 dark:text-green-400";case"declining":return"text-red-600 dark:text-red-400";default:return"text-gray-600 dark:text-gray-400"}},m=[{value:"week",label:"7 Days",icon:Pe},{value:"month",label:"30 Days",icon:Vt},{value:"quarter",label:"90 Days",icon:Kr}],h=e?.molecularBalanceScore||0,N=l.length>0?l.reduce((b,f)=>b+f.molecularBalanceScore,0)/l.length:0;return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100 flex items-center",children:[s.jsx(be,{className:"h-6 w-6 mr-2 text-primary-600 dark:text-primary-400"}),"Progress Insights"]}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Track your molecular nutrition journey over time"})]}),s.jsx("div",{className:"flex space-x-1 bg-gray-100 dark:bg-gray-800 rounded-lg p-1",children:m.map(b=>{const f=b.icon;return s.jsxs(k.button,{type:"button",onClick:()=>r(b.value),className:T("flex items-center space-x-2 px-3 py-2 rounded-md text-sm font-medium transition-all duration-200",t===b.value?"bg-white dark:bg-gray-700 text-primary-600 dark:text-primary-400 shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"),whileHover:{scale:1.02},whileTap:{scale:.98},children:[s.jsx(f,{className:"h-4 w-4"}),s.jsx("span",{children:b.label})]},b.value)})})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"card p-6 text-center",children:[s.jsx("div",{className:"flex items-center justify-center w-12 h-12 bg-primary-100 dark:bg-primary-900 rounded-full mx-auto mb-4",children:s.jsx(De,{className:"h-6 w-6 text-primary-600 dark:text-primary-400"})}),s.jsx("div",{className:"text-3xl font-bold text-primary-600 dark:text-primary-400 mb-2",children:h}),s.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Current Balance Score"}),s.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:s.jsx(k.div,{initial:{width:0},animate:{width:`${h}%`},transition:{duration:1,delay:.2},className:"bg-primary-500 h-2 rounded-full"})})]}),s.jsxs(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"card p-6 text-center",children:[s.jsx("div",{className:"flex items-center justify-center w-12 h-12 bg-green-100 dark:bg-green-900 rounded-full mx-auto mb-4",children:s.jsx(oe,{className:"h-6 w-6 text-green-600 dark:text-green-400"})}),s.jsx("div",{className:"text-3xl font-bold text-green-600 dark:text-green-400 mb-2",children:Un(N,0)}),s.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Average Score"}),s.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Last 30 days"})]}),s.jsxs(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"card p-6 text-center",children:[s.jsx("div",{className:"flex items-center justify-center w-12 h-12 bg-blue-100 dark:bg-blue-900 rounded-full mx-auto mb-4",children:s.jsx(ze,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),s.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[n&&u(n.overallTrend),s.jsx("span",{className:T("text-lg font-semibold",c(n?.overallTrend||"stable")),children:n?.overallTrend||"stable"})]}),s.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Overall Trend"})]})]}),s.jsxs(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"card p-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-6 flex items-center",children:[s.jsx(Cr,{className:"h-5 w-5 mr-2 text-primary-600 dark:text-primary-400"}),"Molecular Balance Score Trend"]}),s.jsx("div",{className:"h-64",children:s.jsx(Ut,{width:"100%",height:"100%",children:s.jsxs(Xr,{data:l.slice(-30),children:[s.jsx(Ze,{strokeDasharray:"3 3"}),s.jsx(et,{dataKey:"date",tickFormatter:b=>new Date(b).toLocaleDateString("en-US",{month:"short",day:"numeric"})}),s.jsx(tt,{domain:[0,100]}),s.jsx(Ve,{labelFormatter:b=>new Date(b).toLocaleDateString(),formatter:b=>[`${b}`,"Balance Score"]}),s.jsx(ft,{type:"monotone",dataKey:"molecularBalanceScore",stroke:"#3b82f6",fill:"#3b82f6",fillOpacity:.2,strokeWidth:2})]})})})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs(k.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.4},className:"card p-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-6 flex items-center",children:[s.jsx(Vt,{className:"h-5 w-5 mr-2 text-primary-600 dark:text-primary-400"}),"Key Nutrient Trends"]}),s.jsx("div",{className:"space-y-4",children:l.length>0&&Object.entries(l[l.length-1].nutrientTrends).map(([b,f])=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[u(f.trend),s.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:b})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("div",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100",children:[f.current,"/",f.target]}),s.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[Un(f.current/f.target*100,0),"% of target"]})]})]},b))})]}),s.jsxs(k.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.5},className:"card p-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-6 flex items-center",children:[s.jsx(Oe,{className:"h-5 w-5 mr-2 text-primary-600 dark:text-primary-400"}),"Health Insights"]}),s.jsxs("div",{className:"space-y-4",children:[n?.keyInsights.map((b,f)=>s.jsxs(k.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.6+f*.1},className:"flex items-start space-x-3 p-3 bg-blue-50 dark:bg-blue-900 rounded-lg",children:[s.jsx("div",{className:"flex-shrink-0 w-6 h-6 bg-blue-100 dark:bg-blue-800 rounded-full flex items-center justify-center",children:s.jsx(vt,{className:"h-3 w-3 text-blue-600 dark:text-blue-400"})}),s.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:b})]},f)),n?.recommendations.map((b,f)=>s.jsxs(k.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.7+f*.1},className:"flex items-start space-x-3 p-3 bg-green-50 dark:bg-green-900 rounded-lg",children:[s.jsx("div",{className:"flex-shrink-0 w-6 h-6 bg-green-100 dark:bg-green-800 rounded-full flex items-center justify-center",children:s.jsx(oe,{className:"h-3 w-3 text-green-600 dark:text-green-400"})}),s.jsx("p",{className:"text-sm text-green-800 dark:text-green-200",children:b})]},f))]})]})]}),s.jsxs(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8},className:"card p-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-6 flex items-center",children:[s.jsx(Ee,{className:"h-5 w-5 mr-2 text-primary-600 dark:text-primary-400"}),"Long-term Health Predictions"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsx("h4",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Positive Trends"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center space-x-2 text-green-600 dark:text-green-400",children:[s.jsx(be,{className:"h-4 w-4"}),s.jsx("span",{className:"text-sm",children:"Consistent protein intake supporting muscle health"})]}),s.jsxs("div",{className:"flex items-center space-x-2 text-green-600 dark:text-green-400",children:[s.jsx(be,{className:"h-4 w-4"}),s.jsx("span",{className:"text-sm",children:"Iron levels improving with dietary changes"})]}),s.jsxs("div",{className:"flex items-center space-x-2 text-green-600 dark:text-green-400",children:[s.jsx(be,{className:"h-4 w-4"}),s.jsx("span",{className:"text-sm",children:"Vitamin C intake meeting daily requirements"})]})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h4",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Areas for Improvement"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center space-x-2 text-yellow-600 dark:text-yellow-400",children:[s.jsx(ar,{className:"h-4 w-4"}),s.jsx("span",{className:"text-sm",children:"Consider increasing fiber intake for digestive health"})]}),s.jsxs("div",{className:"flex items-center space-x-2 text-yellow-600 dark:text-yellow-400",children:[s.jsx(ar,{className:"h-4 w-4"}),s.jsx("span",{className:"text-sm",children:"Omega-3 levels could be optimized for heart health"})]})]})]})]})]})]})}const Km=S.memo(function({userProfile:e,onMealPlanGenerated:t}){const[r,n]=S.useState(!1),[i,o]=S.useState(null),[l,u]=S.useState(new Date().toISOString().split("T")[0]),[c,m]=S.useState({mealComplexity:"medium",budgetRange:"moderate",prepTime:45,focusAreas:[]}),h=async()=>{if(e){n(!0);try{await new Promise(f=>setTimeout(f,2e3));const b={id:`mealplan_${Date.now()}`,date:l,meals:{breakfast:{id:"breakfast_1",name:"Molecular Power Bowl",description:"Quinoa base with hemp seeds, berries, and molecular nutrients",ingredients:["1 cup cooked quinoa","2 tbsp hemp seeds","1/2 cup mixed berries","1 tbsp chia seeds","1 tbsp almond butter","1/2 banana"],instructions:`1. Cook quinoa according to package directions
2. Top with hemp seeds, berries, chia seeds
3. Drizzle with almond butter
4. Add sliced banana on top`,nutrition:{calories:420,protein:18,carbs:52,fat:16,fiber:12},preparationTime:15,difficulty:"easy",cost:3.5,molecularBenefits:["Complete amino acid profile from quinoa and hemp","Antioxidants from berries support cellular health","Omega-3 fatty acids enhance brain function"],tags:["high-protein","antioxidant-rich","omega-3","fiber-rich"]},lunch:{id:"lunch_1",name:"Molecular Green Power Bowl",description:"Dark leafy greens with molecular nutrients and plant proteins",ingredients:["3 cups mixed greens (spinach, kale, arugula)","1/2 cup cooked lentils","1/4 avocado","2 tbsp pumpkin seeds","1 tbsp nutritional yeast","1/2 cup roasted sweet potato","2 tbsp tahini dressing"],instructions:`1. Massage greens with lemon
2. Top with warm lentils
3. Add avocado, seeds, and sweet potato
4. Sprinkle nutritional yeast
5. Drizzle with tahini dressing`,nutrition:{calories:380,protein:22,carbs:35,fat:18,fiber:16},preparationTime:20,difficulty:"medium",cost:4.25,molecularBenefits:["Iron and folate from dark greens support oxygen transport","Complete protein from lentils and seeds","Healthy fats enhance nutrient absorption"],tags:["iron-rich","folate-rich","plant-protein","vitamin-k"]},dinner:{id:"dinner_1",name:"Molecular Mediterranean Feast",description:"Mediterranean-inspired molecular nutrition powerhouse",ingredients:["4 oz wild salmon or tempeh","1 cup roasted vegetables (zucchini, bell peppers)","1/2 cup quinoa pilaf","2 tbsp olive oil","1 tbsp fresh herbs","1/4 cup olives","1 tbsp capers"],instructions:`1. Season and roast salmon/tempeh
2. Roast vegetables until tender
3. Prepare quinoa pilaf with herbs
4. Arrange on plate with olives and capers
5. Drizzle with olive oil`,nutrition:{calories:520,protein:32,carbs:38,fat:28,fiber:8},preparationTime:30,difficulty:"medium",cost:6.75,molecularBenefits:["Omega-3 fatty acids support heart and brain health","Antioxidants from vegetables reduce inflammation","Complete amino acid profile for muscle synthesis"],tags:["omega-3","antioxidants","complete-protein","mediterranean"]},snacks:[{id:"snack_1",name:"Molecular Energy Balls",description:"Nutrient-dense energy balls with molecular benefits",ingredients:["8 dates","1/2 cup almonds","2 tbsp cacao powder","1 tbsp hemp seeds"],instructions:`1. Process dates and almonds in food processor
2. Add cacao and hemp seeds
3. Form into balls
4. Refrigerate for 30 minutes`,nutrition:{calories:180,protein:6,carbs:24,fat:8,fiber:6},preparationTime:10,difficulty:"easy",cost:1.25,molecularBenefits:["Natural energy from dates","Protein and healthy fats from nuts","Antioxidants from cacao"],tags:["energy-boost","antioxidants","healthy-fats","no-bake"]}]},totalNutrition:{calories:1500,protein:78,carbs:149,fat:70,fiber:42},molecularBalanceScore:87,costEstimate:15.75,preparationTime:75};o(b),t(b)}catch(b){console.error("Error generating meal plan:",b)}finally{n(!1)}}},N=["muscle_building","weight_loss","energy_boost","brain_health","immune_support","heart_health","digestive_health","anti_aging"];return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100 flex items-center gap-2",children:[s.jsx(As,{className:"h-6 w-6 text-primary-600"}),"AI Meal Plan Generator"]}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Personalized molecular nutrition meal plans powered by AI"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Pe,{className:"h-5 w-5 text-gray-400"}),s.jsx("input",{type:"date",value:l,onChange:b=>u(b.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100"})]})]}),s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Meal Plan Preferences"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Meal Complexity"}),s.jsxs("select",{value:c.mealComplexity,onChange:b=>m(f=>({...f,mealComplexity:b.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100",children:[s.jsx("option",{value:"easy",children:"Easy (15-30 min)"}),s.jsx("option",{value:"medium",children:"Medium (30-45 min)"}),s.jsx("option",{value:"hard",children:"Advanced (45+ min)"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Budget Range"}),s.jsxs("select",{value:c.budgetRange,onChange:b=>m(f=>({...f,budgetRange:b.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100",children:[s.jsx("option",{value:"budget",children:"Budget ($10-15/day)"}),s.jsx("option",{value:"moderate",children:"Moderate ($15-25/day)"}),s.jsx("option",{value:"premium",children:"Premium ($25+/day)"})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Max Prep Time: ",c.prepTime," min"]}),s.jsx("input",{type:"range",min:"15",max:"120",value:c.prepTime,onChange:b=>m(f=>({...f,prepTime:parseInt(b.target.value)})),className:"w-full"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Focus Areas"}),s.jsx("div",{className:"flex flex-wrap gap-1",children:N.map(b=>s.jsx("button",{onClick:()=>{m(f=>({...f,focusAreas:f.focusAreas.includes(b)?f.focusAreas.filter(g=>g!==b):[...f.focusAreas,b]}))},className:`px-2 py-1 text-xs rounded-full transition-colors ${c.focusAreas.includes(b)?"bg-primary-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300"}`,children:b.replace("_"," ")},b))})]})]}),s.jsx("div",{className:"mt-6 flex justify-center",children:s.jsx(k.button,{onClick:h,disabled:r||!e,className:"px-8 py-3 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",whileHover:{scale:1.02},whileTap:{scale:.98},children:r?s.jsxs(s.Fragment,{children:[s.jsx(Yr,{className:"h-4 w-4 animate-spin"}),"Generating..."]}):s.jsxs(s.Fragment,{children:[s.jsx(De,{className:"h-4 w-4"}),"Generate Meal Plan"]})})})]}),s.jsx(le,{children:i&&s.jsxs(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:"Your Molecular Nutrition Meal Plan"}),s.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:[new Date(l).toLocaleDateString()," â€¢ Balance Score: ",i.molecularBalanceScore,"/100"]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(k.button,{whileHover:{scale:1.05},whileTap:{scale:.95},className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center gap-2",children:[s.jsx(vl,{className:"h-4 w-4"}),"Save Plan"]}),s.jsxs(k.button,{whileHover:{scale:1.05},whileTap:{scale:.95},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[s.jsx(ei,{className:"h-4 w-4"}),"Export"]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[s.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(oe,{className:"h-4 w-4 text-primary-600"}),s.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Nutrition"})]}),s.jsxs("div",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:[i.totalNutrition.calories," cal"]}),s.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[i.totalNutrition.protein,"g protein â€¢ ",i.totalNutrition.carbs,"g carbs"]})]}),s.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Ee,{className:"h-4 w-4 text-primary-600"}),s.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Prep Time"})]}),s.jsxs("div",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:[i.preparationTime," min"]}),s.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total cooking time"})]}),s.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(be,{className:"h-4 w-4 text-primary-600"}),s.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Cost"})]}),s.jsxs("div",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:["$",i.costEstimate]}),s.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Per day estimate"})]})]}),s.jsx("div",{className:"space-y-4",children:Object.entries(i.meals).map(([b,f])=>(Array.isArray(f)?f:[f]).map((v,x)=>s.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("h4",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 capitalize",children:[b," ",Array.isArray(f)?`#${x+1}`:""]}),s.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 dark:text-gray-400",children:[s.jsxs("span",{children:[v.nutrition.calories," cal"]}),s.jsxs("span",{children:[v.preparationTime," min"]}),s.jsxs("span",{children:["$",v.cost]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("h5",{className:"font-medium text-gray-900 dark:text-gray-100 mb-2",children:v.name}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm mb-3",children:v.description}),s.jsxs("div",{className:"mb-3",children:[s.jsx("h6",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Ingredients:"}),s.jsx("ul",{className:"text-sm text-gray-600 dark:text-gray-400",children:v.ingredients.map((y,d)=>s.jsxs("li",{children:["â€¢ ",y]},d))})]})]}),s.jsxs("div",{children:[s.jsx("h6",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Molecular Benefits:"}),s.jsx("ul",{className:"text-sm text-gray-600 dark:text-gray-400 space-y-1",children:v.molecularBenefits.map((y,d)=>s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx(at,{className:"h-3 w-3 text-yellow-500 mt-0.5 flex-shrink-0"}),y]},d))}),s.jsx("div",{className:"mt-3 flex flex-wrap gap-1",children:v.tags.map((y,d)=>s.jsx("span",{className:"px-2 py-1 bg-primary-100 dark:bg-primary-900 text-primary-800 dark:text-primary-200 text-xs rounded-full",children:y},d))})]})]})]},`${b}-${x}`)))})]})})]})}),Ym=S.memo(function({onQuizComplete:e}){const[t,r]=S.useState(0),[n,i]=S.useState(null),[o,l]=S.useState(!1),[u,c]=S.useState(!1),[m,h]=S.useState(!1),[N,b]=S.useState({}),[f,g]=S.useState(0),[v,x]=S.useState(null),y=[{id:"1",question:"Which nutrient enhances iron absorption by up to 6-fold when consumed together?",options:["Vitamin D","Vitamin C","Vitamin B12","Vitamin E"],correctAnswer:1,explanation:"Vitamin C significantly enhances non-heme iron absorption by reducing ferric iron to ferrous iron, making it more bioavailable.",molecularInsight:"Vitamin C acts as a reducing agent, converting FeÂ³âº to FeÂ²âº, which is the form required for intestinal absorption via DMT1 transporter.",difficulty:"intermediate",category:"Nutrient Interactions"},{id:"2",question:"What is the optimal omega-6 to omega-3 ratio for reducing inflammation?",options:["10:1","4:1","20:1","1:1"],correctAnswer:1,explanation:"A 4:1 or lower ratio of omega-6 to omega-3 fatty acids is optimal for reducing chronic inflammation and supporting cardiovascular health.",molecularInsight:"Omega-6 and omega-3 fatty acids compete for the same desaturase enzymes. Lower ratios favor anti-inflammatory EPA/DHA production.",difficulty:"advanced",category:"Fatty Acids"},{id:"3",question:"Which form of magnesium has the highest bioavailability?",options:["Magnesium Oxide","Magnesium Glycinate","Magnesium Sulfate","Magnesium Carbonate"],correctAnswer:1,explanation:"Magnesium glycinate has the highest bioavailability (80%) due to its chelated form, which enhances absorption and reduces gastrointestinal side effects.",molecularInsight:"Chelated magnesium (bound to amino acids) bypasses the limited solubility issues of inorganic forms and utilizes amino acid transporters.",difficulty:"advanced",category:"Supplements"},{id:"4",question:"What is the primary function of the MTHFR gene in nutrition?",options:["Protein synthesis","Folate metabolism","Iron absorption","Vitamin D activation"],correctAnswer:1,explanation:"MTHFR (Methylenetetrahydrofolate reductase) is crucial for folate metabolism and methylation processes, affecting B12 utilization and DNA synthesis.",molecularInsight:"MTHFR converts 5,10-methylenetetrahydrofolate to 5-methyltetrahydrofolate, the active form needed for homocysteine remethylation.",difficulty:"advanced",category:"Genetics"},{id:"5",question:"Which nutrient is most critical for neurotransmitter synthesis?",options:["Vitamin C","Vitamin B6","Iron","Calcium"],correctAnswer:1,explanation:"Vitamin B6 is essential as a cofactor for neurotransmitter synthesis, including serotonin, dopamine, and GABA production.",molecularInsight:"B6-dependent enzymes (AADC, GAD) are rate-limiting steps in neurotransmitter synthesis pathways.",difficulty:"intermediate",category:"Brain Health"},{id:"6",question:"What is the molecular mechanism by which curcumin exerts anti-inflammatory effects?",options:["Direct antioxidant scavenging","NF-ÎºB pathway inhibition","COX enzyme activation","Histamine release"],correctAnswer:1,explanation:"Curcumin primarily works by inhibiting the NF-ÎºB pathway, reducing the production of pro-inflammatory cytokines like TNF-Î± and IL-6.",molecularInsight:"Curcumin blocks IÎºB kinase, preventing NF-ÎºB nuclear translocation and subsequent inflammatory gene expression.",difficulty:"advanced",category:"Phytonutrients"},{id:"7",question:"Which amino acid is most critical for muscle protein synthesis?",options:["Tryptophan","Leucine","Glycine","Proline"],correctAnswer:1,explanation:"Leucine is the key amino acid that triggers mTOR pathway activation, initiating muscle protein synthesis.",molecularInsight:"Leucine acts as a molecular switch, activating mTORC1 which phosphorylates S6K1 and 4E-BP1 to initiate translation.",difficulty:"intermediate",category:"Protein"},{id:"8",question:"What is the primary mechanism of circadian nutrition timing?",options:["Digestive enzyme activity","Hormone secretion patterns","Blood glucose regulation","All of the above"],correctAnswer:3,explanation:"Circadian nutrition timing optimizes metabolic processes by aligning food intake with natural hormone rhythms, digestive capacity, and glucose sensitivity.",molecularInsight:"Circadian clocks in peripheral tissues regulate glucose transporters, digestive enzymes, and metabolic gene expression in time-dependent patterns.",difficulty:"advanced",category:"Chronobiology"},{id:"9",question:"Which probiotic strain has the strongest evidence for mood support?",options:["Lactobacillus acidophilus","Bifidobacterium longum","Lactobacillus helveticus","Saccharomyces boulardii"],correctAnswer:2,explanation:"Lactobacillus helveticus has the strongest clinical evidence for reducing anxiety and improving mood through the gut-brain axis.",molecularInsight:"L. helveticus produces GABA and modulates tryptophan metabolism, affecting serotonin synthesis and neuroinflammation.",difficulty:"advanced",category:"Microbiome"},{id:"10",question:"What is the molecular basis for vitamin D's immune-modulating effects?",options:["Direct antimicrobial action","VDR gene regulation","Antioxidant properties","Hormone synthesis"],correctAnswer:1,explanation:"Vitamin D regulates over 200 genes through the vitamin D receptor (VDR), including immune system genes that control inflammation and pathogen defense.",molecularInsight:"VDR binding to vitamin D response elements (VDREs) regulates transcription of antimicrobial peptides like cathelicidin and defensins.",difficulty:"advanced",category:"Immune Function"}],d=()=>{c(!0),g(Date.now()),r(0),b({})},w=A=>{i(A)},_=()=>{if(n!==null){const A=y[t];b(R=>({...R,[A.id]:n})),t<y.length-1?(r(R=>R+1),i(null),l(!1)):M()}else l(!0)},M=()=>{const A=Date.now(),R=Math.round((A-f)/1e3);let P=0,H={};y.forEach(K=>{const G=N[K.id]===K.correctAnswer;G&&P++,H[K.category]||(H[K.category]=0),G&&H[K.category]++});const U={score:P,totalQuestions:y.length,percentage:Math.round(P/y.length*100),correctAnswers:P,incorrectAnswers:y.length-P,timeSpent:R,categoryScores:H};x(U),h(!0),e(U)},p=()=>{c(!1),h(!1),r(0),i(null),l(!1),b({}),x(null)},C=y[t],E=n===C?.correctAnswer;if(!u)return s.jsx("div",{className:"max-w-2xl mx-auto text-center",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-8 border border-gray-200 dark:border-gray-700",children:[s.jsx(de,{className:"h-16 w-16 text-primary-600 mx-auto mb-4"}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100 mb-4",children:"Molecular Nutrition Quiz"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"Test your knowledge of molecular nutrition, nutrient interactions, and advanced nutrition science."}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[s.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:[s.jsx(kr,{className:"h-6 w-6 text-primary-600 mx-auto mb-2"}),s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:y.length}),s.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Questions"})]}),s.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:[s.jsx(oe,{className:"h-6 w-6 text-primary-600 mx-auto mb-2"}),s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Advanced"}),s.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Level"})]}),s.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:[s.jsx(De,{className:"h-6 w-6 text-primary-600 mx-auto mb-2"}),s.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"15 min"}),s.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Estimated"})]})]}),s.jsxs(k.button,{onClick:d,className:"px-8 py-3 bg-primary-600 text-white rounded-lg hover:bg-primary-700 flex items-center gap-2 mx-auto",whileHover:{scale:1.02},whileTap:{scale:.98},children:[s.jsx(de,{className:"h-5 w-5"}),"Start Quiz"]})]})});if(m&&v){const R=(H=>H>=90?{message:"Outstanding! You're a molecular nutrition expert!",color:"text-green-600",icon:jl}:H>=80?{message:"Excellent! Great understanding of nutrition science!",color:"text-blue-600",icon:vt}:H>=70?{message:"Good job! Solid nutrition knowledge!",color:"text-yellow-600",icon:oe}:{message:"Keep learning! Nutrition science is complex.",color:"text-orange-600",icon:kr})(v.percentage),P=R.icon;return s.jsx("div",{className:"max-w-2xl mx-auto",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-8 border border-gray-200 dark:border-gray-700 text-center",children:[s.jsx(P,{className:`h-16 w-16 ${R.color} mx-auto mb-4`}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100 mb-2",children:"Quiz Complete!"}),s.jsx("p",{className:`text-lg font-semibold ${R.color} mb-4`,children:R.message}),s.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-6 mb-6",children:[s.jsxs("div",{className:"text-4xl font-bold text-gray-900 dark:text-gray-100 mb-2",children:[v.percentage,"%"]}),s.jsxs("div",{className:"text-gray-600 dark:text-gray-400",children:[v.correctAnswers," out of ",v.totalQuestions," correct"]}),s.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400 mt-2",children:["Time: ",Math.floor(v.timeSpent/60),"m ",v.timeSpent%60,"s"]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[s.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-4",children:[s.jsx(me,{className:"h-6 w-6 text-green-600 mx-auto mb-2"}),s.jsx("div",{className:"text-lg font-semibold text-green-700 dark:text-green-300",children:v.correctAnswers}),s.jsx("div",{className:"text-sm text-green-600 dark:text-green-400",children:"Correct"})]}),s.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 rounded-lg p-4",children:[s.jsx(za,{className:"h-6 w-6 text-red-600 mx-auto mb-2"}),s.jsx("div",{className:"text-lg font-semibold text-red-700 dark:text-red-300",children:v.incorrectAnswers}),s.jsx("div",{className:"text-sm text-red-600 dark:text-red-400",children:"Incorrect"})]})]}),s.jsxs(k.button,{onClick:p,className:"px-6 py-3 bg-primary-600 text-white rounded-lg hover:bg-primary-700 flex items-center gap-2 mx-auto",whileHover:{scale:1.02},whileTap:{scale:.98},children:[s.jsx(Nl,{className:"h-4 w-4"}),"Retake Quiz"]})]})})}return s.jsx("div",{className:"max-w-3xl mx-auto",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:[s.jsxs("div",{className:"mb-6",children:[s.jsxs("div",{className:"flex justify-between items-center mb-2",children:[s.jsxs("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["Question ",t+1," of ",y.length]}),s.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:[Math.round((t+1)/y.length*100),"%"]})]}),s.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:s.jsx(k.div,{className:"bg-primary-600 h-2 rounded-full",initial:{width:0},animate:{width:`${(t+1)/y.length*100}%`},transition:{duration:.3}})})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${C.difficulty==="beginner"?"bg-green-100 text-green-800":C.difficulty==="intermediate"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:C.difficulty}),s.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:C.category})]}),s.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100 mb-6",children:C.question}),s.jsx("div",{className:"space-y-3",children:C.options.map((A,R)=>s.jsx(k.button,{onClick:()=>w(R),className:`w-full text-left p-4 rounded-lg border-2 transition-all ${n===R?"border-primary-600 bg-primary-50 dark:bg-primary-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,whileHover:{scale:1.01},whileTap:{scale:.99},children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`w-4 h-4 rounded-full border-2 ${n===R?"border-primary-600 bg-primary-600":"border-gray-300 dark:border-gray-600"}`,children:n===R&&s.jsx("div",{className:"w-2 h-2 bg-white rounded-full m-0.5"})}),s.jsx("span",{className:"text-gray-900 dark:text-gray-100",children:A})]})},R))})]}),o&&s.jsx(k.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 mb-6",children:s.jsxs("div",{className:"flex items-start gap-3",children:[E?s.jsx(me,{className:"h-5 w-5 text-green-600 mt-0.5"}):s.jsx(za,{className:"h-5 w-5 text-red-600 mt-0.5"}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-900 dark:text-gray-100 mb-2",children:E?"Correct!":"Incorrect"}),s.jsx("p",{className:"text-gray-700 dark:text-gray-300 mb-2",children:C.explanation}),s.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded p-3",children:[s.jsx("h5",{className:"text-sm font-medium text-blue-900 dark:text-blue-300 mb-1",children:"Molecular Insight:"}),s.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:C.molecularInsight})]})]})]})}),s.jsxs("div",{className:"flex justify-between",children:[s.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Time: ",Math.floor((Date.now()-f)/1e3),"s"]}),s.jsx(k.button,{onClick:_,className:"px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",whileHover:{scale:1.02},whileTap:{scale:.98},children:t===y.length-1?"Finish Quiz":"Next Question"})]})]})})}),Xm=S.memo(function({userProfile:e,onSupplementsSelected:t}){const[r,n]=S.useState([]),[i,o]=S.useState("all"),[l,u]=S.useState(null),[c,m]=S.useState("all"),h=[{id:"vitamin_d3",name:"Vitamin D3 (Cholecalciferol)",category:"vitamin",priority:"essential",dosage:{amount:"2000-4000 IU",frequency:"Daily",timing:"With fat-containing meal",form:"Softgel or liquid"},benefits:["Immune system support","Bone health optimization","Mood regulation","Muscle function improvement","Cardiovascular protection"],molecularMechanisms:["VDR activation regulates 200+ genes","Enhances calcium absorption via TRPV6","Modulates immune cell function","Supports neurotransmitter synthesis"],clinicalEvidence:[{studyType:"Meta-analysis",strength:"Strong",conclusion:"Reduces respiratory infections by 12-70%"},{studyType:"RCT",strength:"Moderate",conclusion:"May improve mood and cognitive function"}],contraindications:["Hypercalcemia","Sarcoidosis","Kidney stones"],interactions:["Warfarin","Calcium supplements","Magnesium"],cost:{daily:.15,monthly:4.5,quality:"standard"},brandRecommendations:[{name:"Thorne Vitamin D/K2",price:32.95,rating:4.8,notes:"High potency with K2"},{name:"Pure Encapsulations D3",price:28.5,rating:4.7,notes:"Professional grade"}],geneticConsiderations:["VDR FokI variant affects receptor function","CYP2R1 variants influence synthesis"],lifestyleFactors:["Limited sun exposure","Darker skin pigmentation","Age >50","Indoor lifestyle"]},{id:"omega3_epa_dha",name:"Omega-3 EPA/DHA",category:"omega3",priority:"recommended",dosage:{amount:"1000-2000mg EPA+DHA",frequency:"Daily",timing:"With meals",form:"Fish oil or algae oil"},benefits:["Anti-inflammatory effects","Brain health support","Heart health protection","Joint mobility improvement","Cognitive function enhancement"],molecularMechanisms:["Inhibits NF-ÎºB pathway","Competes with omega-6 for COX enzymes","Supports cell membrane fluidity","Modulates gene expression"],clinicalEvidence:[{studyType:"Meta-analysis",strength:"Strong",conclusion:"Reduces cardiovascular mortality by 8%"},{studyType:"RCT",strength:"Moderate",conclusion:"May improve depression symptoms"}],contraindications:["Bleeding disorders","Anticoagulant therapy"],interactions:["Blood thinners","High-dose vitamin E"],cost:{daily:.35,monthly:10.5,quality:"premium"},brandRecommendations:[{name:"Nordic Naturals Ultimate Omega",price:39.95,rating:4.9,notes:"High concentration, no fishy taste"},{name:"Viva Naturals Triple Strength",price:24.99,rating:4.6,notes:"Good value, high potency"}],geneticConsiderations:["FADS1/2 variants affect conversion efficiency","COX2 variants influence response"],lifestyleFactors:["Low fish intake","Plant-based diet","Inflammatory conditions","Cardiovascular risk"]},{id:"magnesium_glycinate",name:"Magnesium Glycinate",category:"mineral",priority:"recommended",dosage:{amount:"200-400mg elemental",frequency:"Daily",timing:"Evening with food",form:"Chelated glycinate"},benefits:["Muscle relaxation","Sleep quality improvement","Stress reduction","Energy production support","Bone health maintenance"],molecularMechanisms:["Cofactor for 300+ enzymes","Regulates calcium channels","Supports ATP production","Modulates GABA receptors"],clinicalEvidence:[{studyType:"RCT",strength:"Strong",conclusion:"Improves sleep quality and duration"},{studyType:"Meta-analysis",strength:"Moderate",conclusion:"May reduce blood pressure"}],contraindications:["Kidney disease","Severe heart block"],interactions:["Calcium","Zinc","Antibiotics"],cost:{daily:.25,monthly:7.5,quality:"standard"},brandRecommendations:[{name:"Thorne Magnesium Bisglycinate",price:29.95,rating:4.8,notes:"Highly bioavailable form"},{name:"Pure Encapsulations Magnesium",price:24.5,rating:4.7,notes:"Professional grade"}],geneticConsiderations:["TRPM6 variants affect absorption","SLC41A1 variants influence transport"],lifestyleFactors:["High stress levels","Exercise intensity","Poor sleep","Alcohol consumption"]},{id:"probiotics_lactobacillus",name:"Lactobacillus Probiotics",category:"probiotic",priority:"recommended",dosage:{amount:"10-50 billion CFU",frequency:"Daily",timing:"Empty stomach or with food",form:"Capsules or powder"},benefits:["Digestive health support","Immune function enhancement","Mood regulation","Nutrient absorption improvement","Antibiotic-associated diarrhea prevention"],molecularMechanisms:["Modulates gut microbiota composition","Enhances gut barrier integrity","Produces beneficial metabolites","Regulates immune responses"],clinicalEvidence:[{studyType:"Meta-analysis",strength:"Strong",conclusion:"Reduces antibiotic-associated diarrhea by 42%"},{studyType:"RCT",strength:"Moderate",conclusion:"May improve mood and anxiety"}],contraindications:["Immunocompromised individuals","Central line access"],interactions:["Antibiotics","Immunosuppressants"],cost:{daily:.45,monthly:13.5,quality:"premium"},brandRecommendations:[{name:"Garden of Life Dr. Formulated",price:34.99,rating:4.8,notes:"Multi-strain, high potency"},{name:"Renew Life Ultimate Flora",price:28.95,rating:4.6,notes:"Stable shelf life"}],geneticConsiderations:["TLR2 variants affect recognition","NOD2 variants influence response"],lifestyleFactors:["Antibiotic use","Poor diet","High stress","Digestive issues"]},{id:"curcumin",name:"Curcumin (Turmeric Extract)",category:"herbal",priority:"optional",dosage:{amount:"500-1000mg",frequency:"Daily",timing:"With fat-containing meal",form:"Standardized extract with piperine"},benefits:["Anti-inflammatory effects","Joint health support","Cognitive function enhancement","Cardiovascular protection","Antioxidant activity"],molecularMechanisms:["Inhibits NF-ÎºB pathway","Modulates COX-2 expression","Enhances antioxidant enzymes","Supports neuroprotection"],clinicalEvidence:[{studyType:"Meta-analysis",strength:"Strong",conclusion:"Reduces inflammation markers by 25-40%"},{studyType:"RCT",strength:"Moderate",conclusion:"May improve cognitive function in elderly"}],contraindications:["Gallbladder disease","Bleeding disorders"],interactions:["Blood thinners","Diabetes medications"],cost:{daily:.3,monthly:9,quality:"premium"},brandRecommendations:[{name:"Thorne Meriva-SF",price:39.95,rating:4.9,notes:"Enhanced bioavailability"},{name:"Life Extension Curcumin Elite",price:29.99,rating:4.7,notes:"High potency with piperine"}],geneticConsiderations:["COX2 variants affect response","IL1B variants influence inflammation"],lifestyleFactors:["Inflammatory conditions","Joint pain","Cognitive concerns","Cardiovascular risk"]}],N=()=>{let x=h;return i!=="all"&&(x=x.filter(y=>y.category===i)),c!=="all"&&(x=x.filter(y=>y.priority===c)),e&&(x=x.filter(y=>{const d=y.lifestyleFactors.some(_=>{switch(_){case"Limited sun exposure":return e.region==="Northern";case"Plant-based diet":return e.lifestyle==="vegan"||e.lifestyle==="vegetarian";case"High stress levels":return e.healthGoals.includes("energy_boost")||e.healthGoals.includes("mental_clarity");case"Exercise intensity":return e.healthGoals.includes("muscle_gain");default:return!0}}),w=y.benefits.some(_=>!!(e.healthGoals.includes("muscle_gain")&&_.includes("muscle")||e.healthGoals.includes("weight_loss")&&_.includes("metabolism")||e.healthGoals.includes("mental_clarity")&&_.includes("cognitive")||e.healthGoals.includes("immune_support")&&_.includes("immune")));return d||w||y.priority==="essential"})),x},b=x=>{n(y=>y.find(w=>w.id===x.id)?y.filter(w=>w.id!==x.id):[...y,x])},f=[{id:"all",name:"All",icon:fs},{id:"vitamin",name:"Vitamins",icon:qt},{id:"mineral",name:"Minerals",icon:De},{id:"probiotic",name:"Probiotics",icon:de},{id:"herbal",name:"Herbal",icon:at},{id:"omega3",name:"Omega-3",icon:Oe}],g=[{id:"all",name:"All Priorities"},{id:"essential",name:"Essential"},{id:"recommended",name:"Recommended"},{id:"optional",name:"Optional"}],v=N();return S.useEffect(()=>{t(r)},[r,t]),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100 flex items-center gap-2",children:[s.jsx(fs,{className:"h-6 w-6 text-primary-600"}),"Personalized Supplement Recommendations"]}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"AI-powered supplement recommendations based on your profile and nutrition analysis"})]}),s.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:s.jsxs("div",{className:"flex flex-wrap gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Category"}),s.jsx("div",{className:"flex gap-2",children:f.map(x=>{const y=x.icon;return s.jsxs("button",{onClick:()=>o(x.id),className:`px-3 py-2 rounded-lg flex items-center gap-2 text-sm transition-colors ${i===x.id?"bg-primary-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:[s.jsx(y,{className:"h-4 w-4"}),x.name]},x.id)})})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Priority"}),s.jsx("select",{value:c,onChange:x=>m(x.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100",children:g.map(x=>s.jsx("option",{value:x.id,children:x.name},x.id))})]})]})}),r.length>0&&s.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-xl p-4 border border-green-200 dark:border-green-800",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"font-semibold text-green-900 dark:text-green-300",children:[r.length," Supplement",r.length>1?"s":""," Selected"]}),s.jsxs("p",{className:"text-sm text-green-700 dark:text-green-400",children:["Estimated monthly cost: $",r.reduce((x,y)=>x+y.cost.monthly,0).toFixed(2)]})]}),s.jsx(me,{className:"h-6 w-6 text-green-600"})]})}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:v.map(x=>{const y=r.find(w=>w.id===x.id),d={essential:"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-300",recommended:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-300",optional:"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-300"};return s.jsxs(k.div,{className:`bg-white dark:bg-gray-800 rounded-xl border-2 transition-all ${y?"border-primary-600 bg-primary-50 dark:bg-primary-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,whileHover:{scale:1.02},whileTap:{scale:.98},children:[s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-semibold text-gray-900 dark:text-gray-100 mb-1",children:x.name}),s.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${d[x.priority]}`,children:x.priority})]}),s.jsx("button",{onClick:()=>b(x),className:`w-6 h-6 rounded-full border-2 flex items-center justify-center ${y?"border-primary-600 bg-primary-600":"border-gray-300 dark:border-gray-600"}`,children:y&&s.jsx(me,{className:"h-4 w-4 text-white"})})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Dosage"}),s.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[x.dosage.amount," â€¢ ",x.dosage.frequency]}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:x.dosage.timing})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Key Benefits"}),s.jsx("ul",{className:"text-sm text-gray-600 dark:text-gray-400 space-y-1",children:x.benefits.slice(0,3).map((w,_)=>s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx(at,{className:"h-3 w-3 text-yellow-500 mt-0.5 flex-shrink-0"}),w]},_))})]}),s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Monthly cost:"}),s.jsxs("span",{className:"ml-2 font-semibold text-gray-900 dark:text-gray-100",children:["$",x.cost.monthly]})]}),s.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${x.cost.quality==="premium"?"bg-blue-100 text-blue-800":x.cost.quality==="standard"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:x.cost.quality})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("button",{onClick:()=>u(l===x.id?null:x.id),className:"flex-1 px-3 py-2 text-sm bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:[s.jsx(Os,{className:"h-4 w-4 inline mr-1"}),"Details"]}),s.jsx("button",{onClick:()=>window.open("https://examine.com","_blank"),className:"px-3 py-2 text-sm bg-primary-100 dark:bg-primary-900 text-primary-700 dark:text-primary-300 rounded-lg hover:bg-primary-200 dark:hover:bg-primary-800 transition-colors",children:s.jsx(kl,{className:"h-4 w-4"})})]})]}),s.jsx(le,{children:l===x.id&&s.jsx(k.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"border-t border-gray-200 dark:border-gray-700 p-6",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("h5",{className:"font-medium text-gray-900 dark:text-gray-100 mb-2",children:"Molecular Mechanisms"}),s.jsx("ul",{className:"text-sm text-gray-600 dark:text-gray-400 space-y-1",children:x.molecularMechanisms.map((w,_)=>s.jsxs("li",{children:["â€¢ ",w]},_))})]}),s.jsxs("div",{children:[s.jsx("h5",{className:"font-medium text-gray-900 dark:text-gray-100 mb-2",children:"Clinical Evidence"}),s.jsx("div",{className:"space-y-2",children:x.clinicalEvidence.map((w,_)=>s.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded p-2",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("span",{className:"text-xs font-medium text-blue-900 dark:text-blue-300",children:w.studyType}),s.jsx("span",{className:`px-1 py-0.5 text-xs rounded ${w.strength==="Strong"?"bg-green-100 text-green-800":w.strength==="Moderate"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:w.strength})]}),s.jsx("p",{className:"text-xs text-blue-800 dark:text-blue-200",children:w.conclusion})]},_))})]}),x.contraindications.length>0&&s.jsxs("div",{children:[s.jsxs("h5",{className:"font-medium text-gray-900 dark:text-gray-100 mb-2 flex items-center gap-2",children:[s.jsx(jt,{className:"h-4 w-4 text-orange-500"}),"Contraindications"]}),s.jsx("ul",{className:"text-sm text-orange-700 dark:text-orange-300 space-y-1",children:x.contraindications.map((w,_)=>s.jsxs("li",{children:["â€¢ ",w]},_))})]}),s.jsxs("div",{children:[s.jsx("h5",{className:"font-medium text-gray-900 dark:text-gray-100 mb-2",children:"Recommended Brands"}),s.jsx("div",{className:"space-y-2",children:x.brandRecommendations.map((w,_)=>s.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded p-2",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:w.name}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(at,{className:"h-3 w-3 text-yellow-500"}),s.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:w.rating})]})]}),s.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:["$",w.price," â€¢ ",w.notes]})]},_))})]})]})})})]},x.id)})}),v.length===0&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx(fs,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:"No supplements found"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Try adjusting your filters to see more options."})]})]})}),Qm=S.memo(function({userProfile:e,dailyIntake:t,historicalData:r=[]}){const[n,i]=S.useState("30d"),[o,l]=S.useState("overview"),[u,c]=S.useState(!0),m=S.useMemo(()=>{if(r.length>0)return r;const d=[],w=new Date;for(let _=29;_>=0;_--){const M=new Date(w);M.setDate(M.getDate()-_);const p=75+Math.sin(_*.2)*15+Math.random()*10,C=1800+Math.sin(_*.1)*200+Math.random()*100,E=120+Math.sin(_*.15)*20+Math.random()*15;d.push({date:M.toISOString().split("T")[0],molecularBalanceScore:Math.max(60,Math.min(95,p)),calories:Math.round(C),protein:Math.round(E),carbs:Math.round(C*.45/4),fat:Math.round(C*.25/9),fiber:Math.round(25+Math.random()*10),water:Math.round(6+Math.random()*2),steps:Math.round(8e3+Math.sin(_*.3)*2e3+Math.random()*1e3),sleep:Math.round(7.5+Math.sin(_*.2)*1+Math.random()*.5),stress:Math.round(3+Math.sin(_*.25)*2+Math.random()*1),energy:Math.round(7+Math.sin(_*.18)*2+Math.random()*1),mood:Math.round(7.5+Math.sin(_*.22)*1.5+Math.random()*1),weight:e?70+Math.sin(_*.05)*2+Math.random()*1:void 0,bodyFat:e?15+Math.sin(_*.08)*3+Math.random()*1:void 0,muscleMass:e?25+Math.sin(_*.1)*2+Math.random()*1:void 0,deficiencies:_%7===0?["Iron","Vitamin D"]:_%5===0?["Magnesium"]:[],achievements:_%10===0?["Perfect Week","Hydration Master"]:_%15===0?["Consistency King"]:[]})}return d},[r,e]),h=S.useMemo(()=>{const d=n==="7d"?7:n==="30d"?30:n==="90d"?90:365;return m.slice(-d)},[m,n]),N=S.useMemo(()=>{if(h.length<2)return[];const d=[],w=h.slice(-7),_=h.slice(-14,-7),M=w.reduce((z,L)=>z+L.molecularBalanceScore,0)/w.length,p=_.length>0?_.reduce((z,L)=>z+L.molecularBalanceScore,0)/_.length:M,C=(M-p)/p*100;d.push({metric:"Molecular Balance",trend:C>2?"up":C<-2?"down":"stable",percentage:Math.abs(C),significance:Math.abs(C)>10?"high":Math.abs(C)>5?"medium":"low",insight:C>2?"Your molecular nutrition is improving!":C<-2?"Your molecular balance needs attention":"Your molecular balance is stable",recommendation:C<-2?"Focus on nutrient-dense foods and hydration":C>2?"Great progress! Keep maintaining this balance":"Continue current nutrition habits",icon:qt,color:C>2?"#10b981":C<-2?"#ef4444":"#3b82f6"});const E=w.reduce((z,L)=>z+L.protein,0)/w.length,A=_.length>0?_.reduce((z,L)=>z+L.protein,0)/_.length:E,R=(E-A)/A*100;d.push({metric:"Protein Intake",trend:R>5?"up":R<-5?"down":"stable",percentage:Math.abs(R),significance:Math.abs(R)>15?"high":Math.abs(R)>8?"medium":"low",insight:R>5?"Your protein intake has increased significantly":R<-5?"Your protein intake has decreased":"Your protein intake is consistent",recommendation:R<-5?"Consider adding more protein-rich foods":R>15?"Excellent protein intake! Monitor for balance":"Maintain current protein levels",icon:oe,color:R>5?"#10b981":R<-5?"#f59e0b":"#3b82f6"});const P=w.reduce((z,L)=>z+L.steps,0)/w.length,H=_.length>0?_.reduce((z,L)=>z+L.steps,0)/_.length:P,U=(P-H)/H*100;d.push({metric:"Daily Steps",trend:U>5?"up":U<-5?"down":"stable",percentage:Math.abs(U),significance:Math.abs(U)>20?"high":Math.abs(U)>10?"medium":"low",insight:U>5?"You've been more active recently!":U<-5?"Your activity level has decreased":"Your activity level is consistent",recommendation:U<-5?"Try to incorporate more walking into your daily routine":U>20?"Great job staying active!":"Keep up the good work",icon:ze,color:U>5?"#10b981":U<-5?"#f59e0b":"#3b82f6"});const K=w.reduce((z,L)=>z+L.sleep,0)/w.length,Y=_.length>0?_.reduce((z,L)=>z+L.sleep,0)/_.length:K,G=(K-Y)/Y*100;return d.push({metric:"Sleep Quality",trend:G>3?"up":G<-3?"down":"stable",percentage:Math.abs(G),significance:Math.abs(G)>10?"high":Math.abs(G)>5?"medium":"low",insight:G>3?"Your sleep quality has improved":G<-3?"Your sleep quality needs attention":"Your sleep quality is stable",recommendation:G<-3?"Focus on sleep hygiene and stress management":G>10?"Excellent sleep habits!":"Continue current sleep routine",icon:Ee,color:G>3?"#10b981":G<-3?"#ef4444":"#3b82f6"}),d},[h]),b=S.useMemo(()=>{const d=[];let w=0;for(let p=h.length-1;p>=0;p--)h[p].molecularBalanceScore>=80?w++:w=0;return w>=7&&d.push({id:"streak-7",title:"Perfect Week",description:"Maintained excellent molecular balance for 7 days",icon:at,date:new Date().toISOString(),category:"streak",rarity:"rare"}),w>=30&&d.push({id:"streak-30",title:"Consistency King",description:"Maintained excellent molecular balance for 30 days",icon:vt,date:new Date().toISOString(),category:"streak",rarity:"epic"}),h.reduce((p,C)=>p+C.protein,0)/h.length>=120&&d.push({id:"protein-master",title:"Protein Power",description:"Consistently high protein intake",icon:oe,date:new Date().toISOString(),category:"nutrition",rarity:"common"}),h.reduce((p,C)=>p+C.steps,0)/h.length>=1e4&&d.push({id:"step-master",title:"Step Champion",description:"Averaged 10,000+ steps daily",icon:ze,date:new Date().toISOString(),category:"fitness",rarity:"rare"}),d},[h]),f=S.useMemo(()=>h.map(d=>({date:new Date(d.date).toLocaleDateString("en-US",{month:"short",day:"numeric"}),fullDate:d.date,molecularBalance:d.molecularBalanceScore,calories:d.calories,protein:d.protein,carbs:d.carbs,fat:d.fat,fiber:d.fiber,water:d.water,steps:d.steps,sleep:d.sleep,stress:d.stress,energy:d.energy,mood:d.mood,weight:d.weight,bodyFat:d.bodyFat,muscleMass:d.muscleMass})),[h,o]),g=[{id:"7d",label:"7 Days",icon:Pe},{id:"30d",label:"30 Days",icon:Pe},{id:"90d",label:"90 Days",icon:Pe},{id:"1y",label:"1 Year",icon:Pe}],v=[{id:"overview",label:"Overview",icon:Vt},{id:"nutrition",label:"Nutrition",icon:Kr},{id:"fitness",label:"Fitness",icon:ze},{id:"wellness",label:"Wellness",icon:Oe}],x=d=>{switch(d){case"up":return s.jsx(Qn,{className:"h-4 w-4 text-green-600"});case"down":return s.jsx(_l,{className:"h-4 w-4 text-red-600"});default:return s.jsx(Zn,{className:"h-4 w-4 text-gray-600"})}},y=d=>{switch(d){case"common":return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200";case"rare":return"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-300";case"epic":return"bg-purple-100 text-purple-800 dark:bg-purple-900/20 dark:text-purple-300";case"legendary":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200"}};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100 flex items-center gap-2",children:[s.jsx(be,{className:"h-6 w-6 text-primary-600"}),"Health Trend Analysis"]}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Comprehensive analysis of your health and nutrition trends"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(k.button,{whileHover:{scale:1.05},whileTap:{scale:.95},className:"px-4 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 flex items-center gap-2",children:[s.jsx(ei,{className:"h-4 w-4"}),"Export"]}),s.jsxs(k.button,{whileHover:{scale:1.05},whileTap:{scale:.95},className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 flex items-center gap-2",children:[s.jsx(ti,{className:"h-4 w-4"}),"Share"]})]})]}),s.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:s.jsxs("div",{className:"flex flex-wrap gap-4 items-center justify-between",children:[s.jsx("div",{className:"flex gap-2",children:g.map(d=>{const w=d.icon;return s.jsxs("button",{onClick:()=>i(d.id),className:T("px-4 py-2 rounded-lg text-sm font-medium transition-all flex items-center gap-2",n===d.id?"bg-primary-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"),children:[s.jsx(w,{className:"h-4 w-4"}),d.label]},d.id)})}),s.jsx("div",{className:"flex gap-2",children:v.map(d=>{const w=d.icon;return s.jsxs("button",{onClick:()=>l(d.id),className:T("px-4 py-2 rounded-lg text-sm font-medium transition-all flex items-center gap-2",o===d.id?"bg-primary-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"),children:[s.jsx(w,{className:"h-4 w-4"}),d.label]},d.id)})}),s.jsxs("button",{onClick:()=>c(!u),className:T("px-4 py-2 rounded-lg text-sm font-medium transition-all flex items-center gap-2",u?"bg-green-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"),children:[s.jsx(De,{className:"h-4 w-4"}),"AI Insights"]})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[s.jsx(k.div,{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",whileHover:{scale:1.02},children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Avg Balance Score"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:Math.round(h.reduce((d,w)=>d+w.molecularBalanceScore,0)/h.length)})]}),s.jsx("div",{className:"p-3 bg-primary-100 dark:bg-primary-900/20 rounded-lg",children:s.jsx(qt,{className:"h-6 w-6 text-primary-600"})})]})}),s.jsx(k.div,{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",whileHover:{scale:1.02},children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Avg Calories"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:Math.round(h.reduce((d,w)=>d+w.calories,0)/h.length)})]}),s.jsx("div",{className:"p-3 bg-red-100 dark:bg-red-900/20 rounded-lg",children:s.jsx(De,{className:"h-6 w-6 text-red-600"})})]})}),s.jsx(k.div,{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",whileHover:{scale:1.02},children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Avg Steps"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:Math.round(h.reduce((d,w)=>d+w.steps,0)/h.length).toLocaleString()})]}),s.jsx("div",{className:"p-3 bg-green-100 dark:bg-green-900/20 rounded-lg",children:s.jsx(ze,{className:"h-6 w-6 text-green-600"})})]})}),s.jsx(k.div,{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",whileHover:{scale:1.02},children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Avg Sleep"}),s.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:[h.reduce((d,w)=>d+w.sleep,0)/h.length|0,"h"]})]}),s.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/20 rounded-lg",children:s.jsx(Ee,{className:"h-6 w-6 text-blue-600"})})]})})]}),s.jsx(le,{children:u&&s.jsxs(k.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 rounded-xl p-6 border border-blue-200 dark:border-blue-800",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[s.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/40 rounded-lg",children:s.jsx(de,{className:"h-5 w-5 text-blue-600"})}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"AI Trend Insights"})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:N.map((d,w)=>{const _=d.icon;return s.jsx(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:w*.1},className:"bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"p-2 bg-gray-100 dark:bg-gray-700 rounded-lg",children:s.jsx(_,{className:"h-4 w-4",style:{color:d.color}})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:d.metric}),x(d.trend),s.jsxs("span",{className:"text-sm font-semibold",style:{color:d.color},children:[d.percentage.toFixed(1),"%"]})]}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:d.insight}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:d.recommendation})]})]})},w)})})]})}),b.length>0&&s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:"p-2 bg-yellow-100 dark:bg-yellow-900/20 rounded-lg",children:s.jsx(vt,{className:"h-5 w-5 text-yellow-600"})}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Recent Achievements"})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:b.map((d,w)=>{const _=d.icon;return s.jsx(k.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:w*.1},className:T("rounded-lg p-4 border-2",y(d.rarity)),children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(_,{className:"h-5 w-5 mt-0.5"}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-sm",children:d.title}),s.jsx("p",{className:"text-xs opacity-80 mt-1",children:d.description}),s.jsx("p",{className:"text-xs opacity-60 mt-2",children:new Date(d.date).toLocaleDateString()})]})]})},d.id)})})]}),s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-6",children:o==="overview"?"Molecular Balance Trend":o==="nutrition"?"Nutrition Trends":o==="fitness"?"Fitness Trends":"Wellness Trends"}),s.jsx("div",{className:"h-80",children:s.jsx(Ut,{width:"100%",height:"100%",children:o==="overview"?s.jsxs(Cr,{data:f,children:[s.jsx(Ze,{strokeDasharray:"3 3"}),s.jsx(et,{dataKey:"date"}),s.jsx(tt,{}),s.jsx(Ve,{}),s.jsx(It,{}),s.jsx(ns,{type:"monotone",dataKey:"molecularBalance",stroke:"#3b82f6",strokeWidth:3,name:"Molecular Balance"})]}):o==="nutrition"?s.jsxs(Xr,{data:f,children:[s.jsx(Ze,{strokeDasharray:"3 3"}),s.jsx(et,{dataKey:"date"}),s.jsx(tt,{}),s.jsx(Ve,{}),s.jsx(It,{}),s.jsx(ft,{type:"monotone",dataKey:"calories",stackId:"1",stroke:"#ef4444",fill:"#ef4444",fillOpacity:.6,name:"Calories"}),s.jsx(ft,{type:"monotone",dataKey:"protein",stackId:"2",stroke:"#10b981",fill:"#10b981",fillOpacity:.6,name:"Protein"}),s.jsx(ft,{type:"monotone",dataKey:"carbs",stackId:"3",stroke:"#f59e0b",fill:"#f59e0b",fillOpacity:.6,name:"Carbs"}),s.jsx(ft,{type:"monotone",dataKey:"fat",stackId:"4",stroke:"#8b5cf6",fill:"#8b5cf6",fillOpacity:.6,name:"Fat"})]}):o==="fitness"?s.jsxs(si,{data:f,children:[s.jsx(Ze,{strokeDasharray:"3 3"}),s.jsx(et,{dataKey:"date"}),s.jsx(tt,{}),s.jsx(Ve,{}),s.jsx(It,{}),s.jsx(Sr,{dataKey:"steps",fill:"#10b981",name:"Steps"}),s.jsx(Sr,{dataKey:"energy",fill:"#3b82f6",name:"Energy Level"})]}):s.jsxs(Cr,{data:f,children:[s.jsx(Ze,{strokeDasharray:"3 3"}),s.jsx(et,{dataKey:"date"}),s.jsx(tt,{}),s.jsx(Ve,{}),s.jsx(It,{}),s.jsx(ns,{type:"monotone",dataKey:"sleep",stroke:"#3b82f6",strokeWidth:2,name:"Sleep (hours)"}),s.jsx(ns,{type:"monotone",dataKey:"stress",stroke:"#ef4444",strokeWidth:2,name:"Stress Level"}),s.jsx(ns,{type:"monotone",dataKey:"mood",stroke:"#10b981",strokeWidth:2,name:"Mood"})]})})})]})]})}),Zm=S.memo(function({userProfile:e,onJoinCommunity:t,onLeaveCommunity:r}){const[n,i]=S.useState("feed"),[o,l]=S.useState(null),[,u]=S.useState(!1),[c,m]=S.useState(""),[h,N]=S.useState("all"),b=S.useMemo(()=>[{id:"molecular-nutrition",name:"Molecular Nutrition Enthusiasts",description:"Discuss the science behind molecular nutrition, share research, and learn from experts.",memberCount:12450,category:"science",isJoined:!0,isPrivate:!1,tags:["nutrition","science","research","molecular"],createdBy:"Dr. Sarah Chen",createdAt:new Date("2023-01-15"),lastActivity:new Date,rules:["Be respectful","Share evidence-based content","No spam"],moderators:["Dr. Sarah Chen","Prof. Michael Rodriguez"]},{id:"vegan-molecular",name:"Vegan Molecular Nutrition",description:"Plant-based molecular nutrition for optimal health and performance.",memberCount:8920,category:"nutrition",isJoined:!0,isPrivate:!1,tags:["vegan","plant-based","nutrition","molecular"],createdBy:"Alex Thompson",createdAt:new Date("2023-03-10"),lastActivity:new Date,rules:["Plant-based only","Be supportive","Share recipes"],moderators:["Alex Thompson","Dr. Lisa Park"]},{id:"fitness-nutrition",name:"Fitness & Molecular Nutrition",description:"Optimizing nutrition for athletic performance and muscle building.",memberCount:15680,category:"fitness",isJoined:!1,isPrivate:!1,tags:["fitness","athletics","muscle-building","performance"],createdBy:"Coach Marcus",createdAt:new Date("2023-02-20"),lastActivity:new Date,rules:["Stay on topic","Share experiences","Be encouraging"],moderators:["Coach Marcus","Dr. Jennifer Liu"]},{id:"wellness-journey",name:"Wellness Journey",description:"Holistic approach to health, wellness, and molecular nutrition.",memberCount:9870,category:"wellness",isJoined:!1,isPrivate:!1,tags:["wellness","holistic","health","mindfulness"],createdBy:"Emma Wilson",createdAt:new Date("2023-04-05"),lastActivity:new Date,rules:["Be kind","Share tips","Support others"],moderators:["Emma Wilson","Dr. Robert Kim"]}],[]),f=S.useMemo(()=>[{id:"post-1",author:{id:"user-1",name:"Dr. Sarah Chen",avatar:"https://images.unsplash.com/photo-1494790108755-2616b612b786?w=150&h=150&fit=crop&crop=face",level:"expert",badges:["PhD","Researcher","Moderator"],isVerified:!0},community:"molecular-nutrition",title:"New Research: Omega-3 and Cellular Membrane Fluidity",content:"Exciting new research shows how omega-3 fatty acids affect cellular membrane fluidity and molecular signaling pathways. This has significant implications for our understanding of inflammation and metabolic health...",images:["https://images.unsplash.com/photo-1559757148-5c350d0d3c56?w=400&h=200&fit=crop"],tags:["research","omega-3","cellular-health"],likes:245,dislikes:3,comments:32,shares:18,views:1250,isLiked:!1,isBookmarked:!0,createdAt:new Date(Date.now()-2*60*60*1e3),updatedAt:new Date(Date.now()-2*60*60*1e3),type:"post"},{id:"post-2",author:{id:"user-2",name:"Alex Thompson",avatar:"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=150&h=150&fit=crop&crop=face",level:"advanced",badges:["Nutritionist","Chef"],isVerified:!1},community:"vegan-molecular",title:"Plant-Based Protein Optimization Guide",content:"Here's my comprehensive guide to optimizing plant-based protein intake for molecular nutrition. Includes timing, combinations, and cooking methods that enhance bioavailability...",tags:["vegan","protein","guide","plant-based"],likes:189,dislikes:1,comments:28,shares:42,views:890,isLiked:!0,isBookmarked:!1,createdAt:new Date(Date.now()-4*60*60*1e3),updatedAt:new Date(Date.now()-4*60*60*1e3),type:"tip"},{id:"post-3",author:{id:"user-3",name:"Coach Marcus",avatar:"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=150&h=150&fit=crop&crop=face",level:"expert",badges:["Certified Trainer","Sports Nutritionist"],isVerified:!0},community:"fitness-nutrition",title:"Pre-Workout Molecular Nutrition Protocol",content:"My research-backed pre-workout nutrition protocol that optimizes molecular signaling for muscle protein synthesis and energy metabolism...",images:["https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?w=400&h=200&fit=crop"],tags:["pre-workout","muscle-building","protocol"],likes:312,dislikes:5,comments:45,shares:67,views:2100,isLiked:!1,isBookmarked:!0,createdAt:new Date(Date.now()-6*60*60*1e3),updatedAt:new Date(Date.now()-6*60*60*1e3),type:"post"}],[]),g=S.useMemo(()=>[{id:"challenge-1",title:"30-Day Molecular Nutrition Challenge",description:"Complete 30 days of optimal molecular nutrition tracking and see your health metrics improve!",category:"nutrition",duration:30,participants:2840,startDate:new Date("2024-01-01"),endDate:new Date("2024-01-31"),isActive:!0,isJoined:!0,rewards:["Achievement Badge","Expert Consultation","Premium Features"],requirements:["Daily logging","80% completion rate","Share progress"],progress:75},{id:"challenge-2",title:"Hydration Master Challenge",description:"Master your hydration game with molecular-level water tracking and optimization.",category:"wellness",duration:14,participants:1920,startDate:new Date("2024-01-15"),endDate:new Date("2024-01-29"),isActive:!0,isJoined:!1,rewards:["Hydration Badge","Water Bottle"],requirements:["Daily water tracking","Meet daily goals","Share tips"]}],[]),v=S.useMemo(()=>[{id:"user-1",name:"Dr. Sarah Chen",avatar:"https://images.unsplash.com/photo-1494790108755-2616b612b786?w=150&h=150&fit=crop&crop=face",level:"Expert",score:9850,rank:1,achievements:["PhD","Researcher","Moderator"],isCurrentUser:!1},{id:"user-2",name:"Alex Thompson",avatar:"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=150&h=150&fit=crop&crop=face",level:"Advanced",score:8920,rank:2,achievements:["Nutritionist","Chef"],isCurrentUser:!1},{id:"user-3",name:e?.id||"You",avatar:void 0,level:"Intermediate",score:7450,rank:3,achievements:["Consistent Logger","Community Helper"],isCurrentUser:!0}],[e]),x=S.useMemo(()=>f.filter(p=>{const C=c===""||p.title.toLowerCase().includes(c.toLowerCase())||p.content.toLowerCase().includes(c.toLowerCase())||p.tags.some(R=>R.toLowerCase().includes(c.toLowerCase())),E=h==="all"||p.tags.includes(h)||b.find(R=>R.id===p.community)?.category===h,A=!o||p.community===o;return C&&E&&A}),[f,c,h,o,b]),y=[{id:"feed",label:"Feed",icon:Tl},{id:"communities",label:"Communities",icon:_r},{id:"challenges",label:"Challenges",icon:oe},{id:"leaderboard",label:"Leaderboard",icon:vt}],d=[{id:"all",label:"All",icon:Ml},{id:"nutrition",label:"Nutrition",icon:qt},{id:"fitness",label:"Fitness",icon:ze},{id:"wellness",label:"Wellness",icon:Oe},{id:"science",label:"Science",icon:de}],w=p=>{switch(p){case"expert":return"text-purple-600 bg-purple-100 dark:bg-purple-900/20";case"advanced":return"text-blue-600 bg-blue-100 dark:bg-blue-900/20";case"intermediate":return"text-green-600 bg-green-100 dark:bg-green-900/20";case"beginner":return"text-gray-600 bg-gray-100 dark:bg-gray-900/20";default:return"text-gray-600 bg-gray-100 dark:bg-gray-900/20"}},_=p=>{switch(p){case"nutrition":return"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-300";case"fitness":return"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-300";case"wellness":return"bg-purple-100 text-purple-800 dark:bg-purple-900/20 dark:text-purple-300";case"science":return"bg-orange-100 text-orange-800 dark:bg-orange-900/20 dark:text-orange-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-300"}},M=p=>{const E=Math.floor((new Date().getTime()-p.getTime())/(1e3*60));return E<60?`${E}m ago`:E<1440?`${Math.floor(E/60)}h ago`:`${Math.floor(E/1440)}d ago`};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100 flex items-center gap-2",children:[s.jsx(_r,{className:"h-6 w-6 text-primary-600"}),"Community Hub"]}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Connect with like-minded individuals passionate about molecular nutrition"})]}),s.jsxs(k.button,{onClick:()=>u(!0),className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 flex items-center gap-2",whileHover:{scale:1.05},whileTap:{scale:.95},children:[s.jsx(Yn,{className:"h-4 w-4"}),"Create Post"]})]}),s.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700",children:s.jsx("div",{className:"flex overflow-x-auto",children:y.map(p=>{const C=p.icon;return s.jsxs("button",{onClick:()=>i(p.id),className:T("flex items-center gap-2 px-6 py-4 text-sm font-medium transition-all whitespace-nowrap",n===p.id?"text-primary-600 border-b-2 border-primary-600 bg-primary-50 dark:bg-primary-900/20":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"),children:[s.jsx(C,{className:"h-4 w-4"}),p.label]},p.id)})})}),s.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700",children:s.jsxs("div",{className:"flex flex-wrap gap-4 items-center",children:[s.jsx("div",{className:"flex-1 min-w-64",children:s.jsxs("div",{className:"relative",children:[s.jsx(Xn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Search posts, communities, or topics...",value:c,onChange:p=>m(p.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-200 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})}),s.jsx("div",{className:"flex gap-2",children:d.map(p=>{const C=p.icon;return s.jsxs("button",{onClick:()=>N(p.id),className:T("px-3 py-2 rounded-lg text-sm font-medium transition-all flex items-center gap-2",h===p.id?"bg-primary-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"),children:[s.jsx(C,{className:"h-4 w-4"}),p.label]},p.id)})}),n==="feed"&&s.jsxs("select",{value:o||"",onChange:p=>l(p.target.value||null),className:"px-3 py-2 border border-gray-200 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",children:[s.jsx("option",{value:"",children:"All Communities"}),b.map(p=>s.jsx("option",{value:p.id,children:p.name},p.id))]})]})}),s.jsx(le,{mode:"wait",children:s.jsxs(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:[n==="feed"&&s.jsx("div",{className:"space-y-4",children:x.map((p,C)=>s.jsxs(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:C*.1},className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:[s.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[s.jsx("img",{src:p.author.avatar||`https://ui-avatars.com/api/?name=${p.author.name}&background=random`,alt:p.author.name,className:"w-12 h-12 rounded-full object-cover"}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("h3",{className:"font-semibold text-gray-900 dark:text-gray-100",children:p.author.name}),p.author.isVerified&&s.jsx(me,{className:"h-4 w-4 text-blue-600"}),s.jsx("span",{className:T("px-2 py-1 text-xs font-medium rounded-full",w(p.author.level)),children:p.author.level})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400",children:[s.jsx("span",{children:b.find(E=>E.id===p.community)?.name}),s.jsx("span",{children:"â€¢"}),s.jsx("span",{children:M(p.createdAt)})]})]}),s.jsx("button",{className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700",children:s.jsx(Sl,{className:"h-4 w-4 text-gray-400"})})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-2",children:p.title}),s.jsx("p",{className:"text-gray-700 dark:text-gray-300 leading-relaxed",children:p.content}),p.images&&p.images.length>0&&s.jsx("div",{className:"mt-3",children:s.jsx("img",{src:p.images[0],alt:"Post content",className:"w-full h-48 object-cover rounded-lg"})})]}),s.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:p.tags.map((E,A)=>s.jsxs("span",{className:"px-2 py-1 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 text-xs rounded-full",children:["#",E]},A))}),s.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200 dark:border-gray-700",children:[s.jsxs("div",{className:"flex items-center gap-6",children:[s.jsxs("button",{className:T("flex items-center gap-2 px-3 py-2 rounded-lg transition-colors",p.isLiked?"bg-red-100 text-red-600 dark:bg-red-900/20 dark:text-red-400":"hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-400"),children:[s.jsx(Cl,{className:"h-4 w-4"}),p.likes]}),s.jsxs("button",{className:"flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-400",children:[s.jsx(Al,{className:"h-4 w-4"}),p.comments]}),s.jsxs("button",{className:"flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-400",children:[s.jsx(ti,{className:"h-4 w-4"}),p.shares]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{className:T("p-2 rounded-lg transition-colors",p.isBookmarked?"bg-yellow-100 text-yellow-600 dark:bg-yellow-900/20 dark:text-yellow-400":"hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-400"),children:s.jsx(El,{className:"h-4 w-4"})}),s.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-500 dark:text-gray-400",children:[s.jsx(Rl,{className:"h-4 w-4"}),p.views]})]})]})]},p.id))}),n==="communities"&&s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:b.map((p,C)=>s.jsxs(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:C*.1},className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:[s.jsx("div",{className:"flex items-start justify-between mb-4",children:s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-2",children:p.name}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm mb-3",children:p.description}),s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.jsx("span",{className:T("px-2 py-1 text-xs font-medium rounded-full",_(p.category)),children:p.category}),s.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[p.memberCount.toLocaleString()," members"]})]})]})}),s.jsx("div",{className:"flex flex-wrap gap-1 mb-4",children:p.tags.slice(0,3).map((E,A)=>s.jsxs("span",{className:"px-2 py-1 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 text-xs rounded-full",children:["#",E]},A))}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Created by ",p.createdBy]}),s.jsx("button",{onClick:()=>{p.isJoined?r?.(p.id):t?.(p.id)},className:T("px-4 py-2 rounded-lg text-sm font-medium transition-colors",p.isJoined?"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600":"bg-primary-600 text-white hover:bg-primary-700"),children:p.isJoined?"Leave":"Join"})]})]},p.id))}),n==="challenges"&&s.jsx("div",{className:"space-y-4",children:g.map((p,C)=>s.jsxs(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:C*.1},className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:[s.jsx("div",{className:"flex items-start justify-between mb-4",children:s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:p.title}),s.jsx("span",{className:T("px-2 py-1 text-xs font-medium rounded-full",_(p.category)),children:p.category})]}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-3",children:p.description}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Duration:"}),s.jsxs("p",{className:"font-medium",children:[p.duration," days"]})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Participants:"}),s.jsx("p",{className:"font-medium",children:p.participants.toLocaleString()})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Ends:"}),s.jsx("p",{className:"font-medium",children:p.endDate.toLocaleDateString()})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Status:"}),s.jsx("p",{className:T("font-medium",p.isActive?"text-green-600":"text-gray-500"),children:p.isActive?"Active":"Ended"})]})]})]})}),p.progress!==void 0&&s.jsxs("div",{className:"mb-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Progress"}),s.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:[p.progress,"%"]})]}),s.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:s.jsx("div",{className:"bg-primary-600 h-2 rounded-full transition-all duration-300",style:{width:`${p.progress}%`}})})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Rewards:"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:p.rewards.map((E,A)=>s.jsx("span",{className:"px-2 py-1 bg-yellow-100 dark:bg-yellow-900/20 text-yellow-800 dark:text-yellow-300 text-xs rounded-full",children:E},A))})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[p.requirements.length," requirements"]}),s.jsx("button",{className:T("px-4 py-2 rounded-lg text-sm font-medium transition-colors",p.isJoined?"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600":"bg-primary-600 text-white hover:bg-primary-700"),children:p.isJoined?"Leave Challenge":"Join Challenge"})]})]},p.id))}),n==="leaderboard"&&s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700",children:[s.jsxs("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 flex items-center gap-2",children:[s.jsx(vt,{className:"h-5 w-5 text-primary-600"}),"Community Leaderboard"]}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm mt-1",children:"Top contributors to the molecular nutrition community"})]}),s.jsx("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:v.map((p,C)=>s.jsxs(k.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:C*.1},className:T("p-4 flex items-center gap-4",p.isCurrentUser&&"bg-primary-50 dark:bg-primary-900/10"),children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-primary-100 dark:bg-primary-900/20 text-primary-600 font-bold text-sm",children:p.rank}),s.jsx("img",{src:p.avatar||`https://ui-avatars.com/api/?name=${p.name}&background=random`,alt:p.name,className:"w-12 h-12 rounded-full object-cover"})]}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("h4",{className:T("font-semibold",p.isCurrentUser?"text-primary-700 dark:text-primary-300":"text-gray-900 dark:text-gray-100"),children:p.name}),p.isCurrentUser&&s.jsx("span",{className:"text-xs bg-primary-100 dark:bg-primary-900/20 text-primary-600 px-2 py-1 rounded-full",children:"You"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:T("px-2 py-1 text-xs font-medium rounded-full",w(p.level.toLowerCase())),children:p.level}),s.jsx("div",{className:"flex gap-1",children:p.achievements.slice(0,3).map((E,A)=>s.jsx("span",{className:"px-2 py-1 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 text-xs rounded-full",children:E},A))})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-lg font-bold text-gray-900 dark:text-gray-100",children:p.score.toLocaleString()}),s.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"points"})]})]},p.id))})]})]},n)})]})});function eh({userProfile:a,dailyIntake:e,recommendations:t}){const[r,n]=S.useState(!1),i=()=>{localStorage.clear(),window.location.reload()},o=()=>{localStorage.removeItem("molecular-nutrition-user"),window.location.reload()},l=()=>{window.confirm("Clear daily intake data? This will force recreation of sample nutrition data.")&&(localStorage.removeItem("molecular-nutrition-daily-intake"),window.location.reload())};return s.jsxs(s.Fragment,{children:[s.jsx(k.button,{onClick:()=>n(!r),className:"fixed bottom-4 right-4 z-50 bg-red-500 hover:bg-red-600 text-white p-3 rounded-full shadow-lg",whileHover:{scale:1.1},whileTap:{scale:.9},title:"Debug Panel",children:s.jsx(Va,{className:"h-5 w-5"})}),s.jsx(le,{children:r&&s.jsxs(k.div,{initial:{opacity:0,x:300},animate:{opacity:1,x:0},exit:{opacity:0,x:300},className:"fixed top-4 right-4 z-50 w-80 max-h-96 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-xl overflow-hidden",children:[s.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 flex items-center",children:[s.jsx(Va,{className:"h-5 w-5 mr-2 text-red-500"}),"Debug Panel"]}),s.jsx("button",{onClick:()=>n(!1),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:s.jsx(nt,{className:"h-5 w-5"})})]})}),s.jsxs("div",{className:"p-4 space-y-4 max-h-80 overflow-y-auto",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs("h4",{className:"font-medium text-gray-900 dark:text-gray-100 flex items-center",children:[s.jsx(Lt,{className:"h-4 w-4 mr-2"}),"User Profile"]}),s.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:a?s.jsxs("div",{className:"space-y-1",children:[s.jsx("p",{children:"âœ… Profile loaded"}),s.jsxs("p",{children:["ID: ",a.id]}),s.jsxs("p",{children:["Age: ",a.age]}),s.jsxs("p",{children:["Sex: ",a.sex]}),s.jsxs("p",{children:["Lifestyle: ",a.lifestyle]}),s.jsxs("p",{children:["Goals: ",a.healthGoals?.length||0]})]}):s.jsx("p",{children:"âŒ No profile found"})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("h4",{className:"font-medium text-gray-900 dark:text-gray-100 flex items-center",children:[s.jsx(Il,{className:"h-4 w-4 mr-2"}),"Daily Intake"]}),s.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:e?s.jsxs("div",{className:"space-y-1",children:[s.jsx("p",{children:"âœ… Intake data loaded"}),s.jsxs("p",{children:["Date: ",e.date]}),s.jsxs("p",{children:["Meals: ",e.meals?.length||0]}),s.jsxs("p",{children:["Balance Score: ",e.molecularBalanceScore]})]}):s.jsx("p",{children:"âŒ No intake data"})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("h4",{className:"font-medium text-gray-900 dark:text-gray-100",children:"AI Recommendations"}),s.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[s.jsxs("p",{children:["Count: ",t.length]}),s.jsxs("p",{children:["Unread: ",t.filter(u=>!u.isRead).length]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("h4",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Local Storage"}),s.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[s.jsxs("p",{children:["Keys: ",Object.keys(localStorage).length]}),s.jsxs("p",{children:["Size: ",JSON.stringify(localStorage).length," chars"]})]})]}),s.jsxs("div",{className:"space-y-2 pt-2 border-t border-gray-200 dark:border-gray-700",children:[s.jsxs("button",{onClick:o,className:"w-full btn-secondary text-sm flex items-center justify-center",children:[s.jsx(xs,{className:"h-4 w-4 mr-2"}),"Clear Profile"]}),s.jsxs("button",{onClick:l,className:"w-full bg-yellow-500 hover:bg-yellow-600 text-white text-sm py-2 px-3 rounded flex items-center justify-center",children:[s.jsx(xs,{className:"h-4 w-4 mr-2"}),"Clear Daily Intake"]}),s.jsxs("button",{onClick:i,className:"w-full bg-red-500 hover:bg-red-600 text-white text-sm py-2 px-3 rounded flex items-center justify-center",children:[s.jsx(xs,{className:"h-4 w-4 mr-2"}),"Clear All Data"]})]})]})]})})]})}class Xe extends S.Component{state={hasError:!1};static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("ErrorBoundary caught an error:",e,t),this.setState({error:e,errorInfo:t})}handleRetry=()=>{this.setState({hasError:!1,error:void 0,errorInfo:void 0})};render(){return this.state.hasError?this.props.fallback?this.props.fallback:s.jsx("div",{className:"min-h-[200px] flex items-center justify-center p-6",children:s.jsxs("div",{className:"text-center max-w-md",children:[s.jsx(jt,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),s.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100 mb-2",children:"Something went wrong"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"An unexpected error occurred. Please try refreshing the page."}),s.jsxs("button",{onClick:this.handleRetry,className:"inline-flex items-center px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:[s.jsx(Yr,{className:"h-4 w-4 mr-2"}),"Try Again"]}),!1]})}):this.props.children}}function th(){const[a,e]=S.useState("dashboard"),[t,r]=S.useState(!1),{userProfile:n,dailyIntake:i,recommendations:o,progressData:l,isLoading:u,error:c,saveUserProfile:m,addMeal:h,updateMeal:N,deleteMeal:b,updateRecommendations:f,clearError:g,setUserProfile:v,setDailyIntake:x,setRecommendations:y,setProgressData:d}=Em(),w=S.useCallback(C=>{console.log("=== PROFILE COMPLETION TRIGGERED ==="),console.log("Profile data received:",C);try{const E={id:Cm(),...C,createdAt:new Date,updatedAt:new Date};console.log("Profile object created:",E),console.log("Calling saveUserProfile..."),m(E),console.log("Profile saved successfully!"),setTimeout(()=>{console.log("Current userProfile state:",n)},100)}catch(E){console.error("Error in handleProfileComplete:",E)}},[m,n]),_=S.useCallback(()=>{localStorage.clear(),v(null),x(null),y([]),d([]),e("profile")},[v,x,y,d]),M=S.useCallback(C=>{try{m(C),console.log("Profile updated successfully")}catch(E){console.error("Error updating profile:",E)}},[m]),p=S.useMemo(()=>{if(!n)return s.jsx(Hn,{onComplete:w});switch(a){case"dashboard":return s.jsxs("div",{className:"space-y-8",children:[s.jsx(Vn,{dailyIntake:i,userProfile:n}),s.jsx(Xe,{children:s.jsx(qn,{userProfile:n,dailyIntake:i,recommendations:o,onRecommendationsUpdate:f})})]});case"food-log":return s.jsx(zm,{onMealAdded:h,meals:i?.meals||[],onMealUpdate:N,onMealDelete:b});case"nutrients":return s.jsx(Vn,{dailyIntake:i,userProfile:n});case"ai-insights":return s.jsx(Xe,{children:s.jsx(qn,{userProfile:n,dailyIntake:i,recommendations:o,onRecommendationsUpdate:f})});case"progress":return s.jsx(Jm,{progressData:l,dailyIntake:i});case"profile":return s.jsx(Hn,{onComplete:w,initialData:n});case"settings":return s.jsxs("div",{className:"text-center py-12",children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100 mb-4",children:"Settings"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Settings panel coming soon..."})]});case"meal-planning":return s.jsx(Xe,{children:s.jsx(Km,{userProfile:n,dailyIntake:i,onMealPlanGenerated:C=>{console.log("Meal plan generated:",C)}})});case"education":return s.jsx(Xe,{children:s.jsx(Ym,{userProfile:n,onQuizComplete:C=>{console.log("Quiz completed:",C)}})});case"supplements":return s.jsx(Xe,{children:s.jsx(Xm,{userProfile:n,dailyIntake:i,onSupplementsSelected:C=>{console.log("Supplements selected:",C)}})});case"analytics":return s.jsx(Xe,{children:s.jsx(Qm,{userProfile:n,dailyIntake:i})});case"community":return s.jsx(Xe,{children:s.jsx(Zm,{userProfile:n,onJoinCommunity:C=>{console.log("Joined community:",C)},onLeaveCommunity:C=>{console.log("Left community:",C)}})});default:return null}},[n,a,i,o,w,h,N,b,f,l]);return s.jsx(Jl,{children:s.jsxs(ec,{children:[s.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 molecular-bg",children:[s.jsx(le,{children:c&&s.jsx(k.div,{initial:{opacity:0,y:-100},animate:{opacity:1,y:0},exit:{opacity:0,y:-100},className:"fixed top-4 right-4 z-50 max-w-sm",children:s.jsx("div",{className:"bg-red-50 dark:bg-red-900 border border-red-200 dark:border-red-700 rounded-lg p-4 shadow-lg",children:s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx(Ce,{className:"h-5 w-5 text-red-600 dark:text-red-400 mt-0.5"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm font-medium text-red-800 dark:text-red-200",children:"Error"}),s.jsx("p",{className:"text-sm text-red-700 dark:text-red-300 mt-1",children:c})]}),s.jsx("button",{onClick:g,className:"text-red-400 hover:text-red-600 dark:hover:text-red-300",children:s.jsx(nt,{className:"h-4 w-4"})})]})})})}),s.jsx(le,{children:u&&s.jsx(k.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 bg-black/50 flex items-center justify-center",children:s.jsx(k.div,{initial:{scale:.8},animate:{scale:1},exit:{scale:.8},className:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-xl",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary-600"}),s.jsx("span",{className:"text-gray-900 dark:text-gray-100",children:"Loading..."})]})})})}),s.jsx(Mm,{onMenuToggle:()=>r(!t),isMenuOpen:t,userProfile:n,onNavigate:C=>e(C),currentPage:a,onLogout:_,onUpdateProfile:M,dailyIntake:i}),s.jsxs("div",{className:"flex",children:[s.jsx(Pm,{isOpen:t,onClose:()=>r(!1),currentPage:a,onPageChange:C=>e(C)}),s.jsx("main",{className:"flex-1 min-h-screen",children:s.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-8",children:s.jsx(k.div,{initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-20,scale:.95},transition:{duration:.4,ease:[.4,0,.2,1],scale:{duration:.3}},children:p},a)})})]}),s.jsx(Om,{})]}),s.jsx(eh,{userProfile:n,dailyIntake:i,recommendations:o})]})})}Er.createRoot(document.getElementById("root")).render(s.jsx(Gn.StrictMode,{children:s.jsx(th,{})}));
